(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2744],{90244:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)([(0,i.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,i.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime")},96540:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},6103:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1"}),"AddRounded")},40075:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1"}),"ArrowForwardRounded")},38780:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block")},20320:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm3.17-6.41a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 12.59l1.41-1.41c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 14l1.41 1.41c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0L12 15.41l-1.41 1.41c-.39.39-1.02.39-1.41 0a.9959.9959 0 0 1 0-1.41L10.59 14zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"}),"DeleteForeverRounded")},40055:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done")},422:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"m18 7-1.41-1.41-6.34 6.34 1.41 1.41zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12zM.41 13.41 6 19l1.41-1.41L1.83 12z"}),"DoneAll")},10105:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M14.4 6 14 4H5v17h2v-7h5.6l.4 2h7V6z"}),"Flag")},74721:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info")},11961:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)([(0,i.jsx)("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58s1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41s-.23-1.06-.59-1.42M13 20.01 4 11V4h7v-.01l9 9z"},"0"),(0,i.jsx)("circle",{cx:"6.5",cy:"6.5",r:"1.5"},"1")],"LocalOfferOutlined")},98441:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"Loop")},81261:function(e,t,n){"use strict";var o=n(64836);t.Z=void 0;var r=o(n(64938)),i=n(85893);t.Z=(0,r.default)((0,i.jsx)("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"Storage")},97212:function(e,t,n){"use strict";n.d(t,{ZP:function(){return _}});var o=n(63366),r=n(87462),i=n(67294),a=n(63961),l=n(28442),s=n(58510),u=n(2101),d=n(90948),c=n(71657),p=n(49990),v=n(56476),f=n(58974),m=n(51705),x=n(59773),h=n(1977),g=n(8027);function b(e){return(0,g.ZP)("MuiListItem",e)}let y=(0,h.Z)("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]);var Z=n(68686);function j(e){return(0,g.ZP)("MuiListItemSecondaryAction",e)}(0,h.Z)("MuiListItemSecondaryAction",["root","disableGutters"]);var C=n(85893);let T=["className"],w=e=>{let{disableGutters:t,classes:n}=e;return(0,s.Z)({root:["root",t&&"disableGutters"]},j,n)},k=(0,d.ZP)("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver(e,t){let{ownerState:n}=e;return[t.root,n.disableGutters&&t.disableGutters]}})(({ownerState:e})=>(0,r.Z)({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},e.disableGutters&&{right:0})),S=i.forwardRef(function(e,t){let n=(0,c.Z)({props:e,name:"MuiListItemSecondaryAction"}),{className:l}=n,s=(0,o.Z)(n,T),u=i.useContext(x.Z),d=(0,r.Z)({},n,{disableGutters:u.disableGutters}),p=w(d);return(0,C.jsx)(k,(0,r.Z)({className:(0,a.Z)(p.root,l),ownerState:d,ref:t},s))});S.muiName="ListItemSecondaryAction";let q=["className"],I=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],O=(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,"flex-start"===n.alignItems&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters,!n.disablePadding&&t.padding,n.button&&t.button,n.hasSecondaryAction&&t.secondaryAction]},P=e=>{let{alignItems:t,button:n,classes:o,dense:r,disabled:i,disableGutters:a,disablePadding:l,divider:u,hasSecondaryAction:d,selected:c}=e;return(0,s.Z)({root:["root",r&&"dense",!a&&"gutters",!l&&"padding",u&&"divider",i&&"disabled",n&&"button","flex-start"===t&&"alignItemsFlexStart",d&&"secondaryAction",c&&"selected"],container:["container"]},b,o)},R=(0,d.ZP)("div",{name:"MuiListItem",slot:"Root",overridesResolver:O})(({theme:e,ownerState:t})=>(0,r.Z)({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!t.disablePadding&&(0,r.Z)({paddingTop:8,paddingBottom:8},t.dense&&{paddingTop:4,paddingBottom:4},!t.disableGutters&&{paddingLeft:16,paddingRight:16},!!t.secondaryAction&&{paddingRight:48}),!!t.secondaryAction&&{[`& > .${Z.Z.root}`]:{paddingRight:48}},{[`&.${y.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${y.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,u.Fq)(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${y.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:(0,u.Fq)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${y.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},"flex-start"===t.alignItems&&{alignItems:"flex-start"},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},t.button&&{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${y.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:(0,u.Fq)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,u.Fq)(e.palette.primary.main,e.palette.action.selectedOpacity)}}},t.hasSecondaryAction&&{paddingRight:48})),D=(0,d.ZP)("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),L=i.forwardRef(function(e,t){let n=(0,c.Z)({props:e,name:"MuiListItem"}),{alignItems:s="center",autoFocus:u=!1,button:d=!1,children:h,className:g,component:b,components:Z={},componentsProps:j={},ContainerComponent:T="li",ContainerProps:{className:w}={},dense:k=!1,disabled:O=!1,disableGutters:L=!1,disablePadding:_=!1,divider:Q=!1,focusVisibleClassName:E,secondaryAction:W,selected:A=!1,slotProps:F={},slots:M={}}=n,N=(0,o.Z)(n.ContainerProps,q),U=(0,o.Z)(n,I),V=i.useContext(x.Z),z=i.useMemo(()=>({dense:k||V.dense||!1,alignItems:s,disableGutters:L}),[s,V.dense,k,L]),H=i.useRef(null);(0,f.Z)(()=>{u&&H.current&&H.current.focus()},[u]);let $=i.Children.toArray(h),G=$.length&&(0,v.Z)($[$.length-1],["ListItemSecondaryAction"]),B=(0,r.Z)({},n,{alignItems:s,autoFocus:u,button:d,dense:z.dense,disabled:O,disableGutters:L,disablePadding:_,divider:Q,hasSecondaryAction:G,selected:A}),J=P(B),X=(0,m.Z)(H,t),Y=M.root||Z.Root||R,K=F.root||j.root||{},ee=(0,r.Z)({className:(0,a.Z)(J.root,K.className,g),disabled:O},U),et=b||"li";return(d&&(ee.component=b||"div",ee.focusVisibleClassName=(0,a.Z)(y.focusVisible,E),et=p.Z),G)?(et=ee.component||b?et:"div","li"===T&&("li"===et?et="div":"li"===ee.component&&(ee.component="div")),(0,C.jsx)(x.Z.Provider,{value:z,children:(0,C.jsxs)(D,(0,r.Z)({as:T,className:(0,a.Z)(J.container,w),ref:X,ownerState:B},N,{children:[(0,C.jsx)(Y,(0,r.Z)({},K,!(0,l.X)(Y)&&{as:et,ownerState:(0,r.Z)({},B,K.ownerState)},ee,{children:$})),$.pop()]}))})):(0,C.jsx)(x.Z.Provider,{value:z,children:(0,C.jsxs)(Y,(0,r.Z)({},K,{as:et,ref:X},!(0,l.X)(Y)&&{ownerState:(0,r.Z)({},B,K.ownerState)},ee,{children:[$,W&&(0,C.jsx)(S,{children:W})]}))})});var _=L},76312:function(e,t,n){"use strict";var o,r=n(18391),i=n(51174),a=n(67294),l=n(45697),s=n(10367),u=n(28368),d=Array(12).fill(""),c=s.ZP.div(o||(o=(0,i.Z)(["\n  display: inline-block;\n  height: ","px;\n  position: relative;\n  width: ","px;\n\n  div {\n    animation: lds-spinner 1.2s linear infinite;\n    transform-origin: ","px ","px;\n\n    ::after {\n      background: ",";\n      border-radius: ","%;\n      content: ' ';\n      display: block;\n      height: ","px;\n      left: ","px;\n      position: absolute;\n      top: ","px;\n      width: ","px;\n    }\n  }\n\n  ","\n\n  @keyframes lds-spinner {\n    0% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n"])),function(e){return e.size},function(e){return e.size},function(e){return e.size/2},function(e){return e.size/2},function(e){var t=e.context;return e.theme.COLOUR[t]},function(e){return e.size/4},function(e){return e.size/4-2},function(e){return e.size/2-3},function(e){return e.size/10-5},function(e){return e.size/10-2},function(e){var t=e.spinner,n="";return t.forEach(function(e,t){n+="\n        div:nth-child(".concat(t+1,") {\n          transform: rotate(").concat(30*t,"deg);\n          animation-delay: ").concat(-1.1+parseFloat(.1*t),"s;\n        }\n      ")}),n}),p=function(e){return a.createElement(c,(0,r.Z)({},e,{spinner:d}),d.map(function(e,t){return a.createElement("div",{key:"spin"+t})}))};p.displayName="LdsSpinner",p.propTypes={size:l.number,context:(0,l.oneOf)(Object.values(u.Z))},p.defaultProps={context:"dark",size:56},t.Z=p},18645:function(e,t,n){"use strict";var o,r=n(51174),i=n(18391),a=n(66080),l=n(67294),s=n(45697),u=n(10367),d=["children","dataCy","indicator"],c=function(e){var t=e.children,n=e.dataCy,o=e.indicator,r=(0,a.Z)(e,d);return l.createElement(p,(0,i.Z)({"data-cy":n},r),o||t)};c.displayName="PageLoading";var p=u.ZP.div(o||(o=(0,r.Z)(["\n  align-items: center;\n  background-color: ",";\n  color: #fff;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  left: 0;\n  opacity: ",";\n  position: ",";\n  right: 0;\n  top: 0;\n  width: 100%;\n  z-index: 99;\n"])),function(e){return e.backgroundColor},function(e){return e.opacity},function(e){return e.position});c.propTypes={backgroundColor:s.string,children:s.any,dataCy:s.string,indicator:s.any,opacity:s.number,position:s.string},c.defaultProps={backgroundColor:"#fff",dataCy:"loadingIndicator",opacity:1,position:"fixed"},t.Z=c},30845:function(e,t){"use strict";var n=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function o(e,t){return!!(e===t||n(e)&&n(t))}function r(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!o(e[n],t[n]))return!1;return!0}t.Z=function(e,t){void 0===t&&(t=r);var n,o,i=[],a=!1;return function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];return a&&n===this&&t(r,i)||(o=e.apply(this,r),a=!0,n=this,i=r),o}}},29325:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/workflows",function(){return n(68676)}])},52971:function(e,t,n){"use strict";n.d(t,{V:function(){return w}});var o=n(26042),r=n(69396),i=n(29815),a=n(85893),l=n(45697),s=n.n(l),u=n(93946),d=n(51233),c=n(15861),p=n(21023),v=n(96540),f=n(67294),m=n(12547),x=n(42283),h=n(79665),g=n(11057),b=n(50135),y=n(77957),Z=n(41733),j=n(74231),C=j.Ry({name:j.Z_().required(),url:j.Z_().url().required()}),T=function(e){var t=e.noEdit,n=e.noDelete,i=e.onDelete,l=e.id,s=e.isAdded,c=e.url,v=e.name,j=e.onSave,T=(0,f.useState)(s),w=T[0],k=T[1],S=(0,x.cI)({resolver:(0,h.S)(C)}),q=S.control,I=S.handleSubmit,O=S.errors,P=function(e){e.stopPropagation(),k(!0)},R=function(e){e.stopPropagation(),k(!1),v&&c||i()},D=function(e){j(e),k(!1)};return(0,a.jsx)("form",{children:w?(0,a.jsxs)(d.Z,{children:[(0,a.jsxs)(d.Z,{spacing:1,children:[(0,a.jsx)(x.Qr,{control:q,name:"name",defaultValue:v,render:function(e){var t;return(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({fullWidth:!0,label:"Name",variant:"standard",color:"secondary"},e),{error:O.name,helperText:null===(t=O.name)||void 0===t?void 0:t.message}))}}),(0,a.jsx)(x.Qr,{control:q,name:"url",defaultValue:c,render:function(e){var t;return(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({fullWidth:!0,label:"Link",variant:"standard",color:"secondary"},e),{error:O.url,helperText:null===(t=O.url)||void 0===t?void 0:t.message}))}})]}),(0,a.jsxs)(d.Z,{direction:"row",justifyContent:"flex-end",spacing:1,mt:2,children:[(0,a.jsx)(g.Z,{variant:"contained",color:"danger",size:"small",onClick:R,children:"Cancel"}),(0,a.jsx)(g.Z,{variant:"contained",size:"small",onClick:I(D),children:"Save"})]})]}):(0,a.jsxs)(d.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,a.jsx)(m.r,{target:"_blank",variant:"body1",color:"secondary",href:c,sx:{textDecoration:"auto",fontWeight:700},children:v}),!t&&(0,a.jsx)(p.Z,{title:"Edit",placement:"top-start",children:(0,a.jsx)(u.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:P,children:(0,a.jsx)(y.Z,{sx:{fontSize:"16px"}})})}),!n&&(0,a.jsx)(p.Z,{title:"Delete",placement:"top-start",children:(0,a.jsx)(u.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:function(){return i(l)},children:(0,a.jsx)(Z.Z,{sx:{fontSize:"16px"}})})})]})})};T.defaultProps={isAdded:!1,noEdit:!1,noDelete:!1,url:"",name:"",onSave:function(){},onCancel:function(){},onDelete:function(){}},T.propTypes={isAdded:s().bool,noEdit:s().bool,noDelete:s().bool,url:s().string,name:s().string,onSave:s().func,onCancel:s().func,onDelete:s().func};var w=function(e){var t=e.values,n=e.setValue,l=e.name,s=e.title,m=e.displayMode,x=e.noDeleteEdit,h=e.titleSx,g=(0,f.useState)([]),b=g[0],y=g[1];(0,f.useEffect)(function(){Array.isArray(t)&&y(t)},[t]);var Z=function(e){e.stopPropagation(),y(function(e){return(0,i.Z)(e).concat([{name:"",link:"",isAdded:!0}])})},j=function(e,t){var o=(0,i.Z)(b);o.splice(e,1,t),n(l,o)};return(0,a.jsxs)(d.Z,{children:[(0,a.jsxs)(d.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,a.jsxs)(c.Z,{sx:h,children:[s,":"]}),!m&&(0,a.jsx)(p.Z,{title:"Add new link",placement:"top-start",children:(0,a.jsx)(u.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:Z,children:(0,a.jsx)(v.Z,{})})})]}),(0,a.jsx)(d.Z,{pl:2,spacing:.8,children:(null==b?void 0:b.length)?b.map(function(e,i){var s;return(0,a.jsx)(T,(0,r.Z)((0,o.Z)({index:i},e),{noEdit:x||m,noDelete:x||m,onDelete:function(){var e=t.filter(function(e,t){return t!==i});n(l,e),y(e)},onSave:function(e){return j(i,e)}}))}):(0,a.jsx)(c.Z,{typography:"subtitle2",children:"No data"})})]})};w.defaultProps={values:[],setValue:function(){},title:"Related links",displayMode:!1,noDeleteEdit:!1,titleSx:{}},w.propTypes={values:s().arrayOf(s().shape({isAdded:s().bool,noEdit:s().bool,url:s().string,name:s().string})),titleSx:s().object,setValue:s().func,noDeleteEdit:s().bool}},28591:function(e,t,n){"use strict";n.d(t,{i:function(){return S}});var o=n(47568),r=n(26042),i=n(69396),a=n(828),l=n(29815),s=n(97582),u=n(85893),d=n(67294),c=n(6388),p=n(50319),v=n(38216),f=n(42283),m=n(15861),x=n(23776),h=n(50135),g=n(93946),b=n(11994),y=n(5616),Z=n(90629),j=n(22961),C=n(72450),T=n(93739),w=n(74231),k=n(2845),S=function(e){var t,n,S,I,O,P=e.control,R=e.errors,D=e.register,L=e.setValue,_=e.entity,Q=e.entityId,E=e.hasSelect,W=void 0===E||E,A=e.hasForm,F=e.hasPreview,M=void 0!==F&&F,N=e.isSubmit,U=void 0!==N&&N,V=e.linkedTo,z=e.isDisabled,H=e.showScoreAndLabels,$=e.doValidation,G=void 0!==$&&$,B=e.handleValidation,J=e.onTotalScoreAndLabelChange,X=void 0===J?function(){}:J,Y=(0,d.useState)([]),K=Y[0],ee=Y[1],et=(0,d.useState)(),en=et[0],eo=et[1],er=(0,d.useState)(!1),ei=er[0],ea=er[1],el=(0,d.useState)(!1),es=el[0],eu=el[1],ed=(0,k.x)().user,ec=(0,d.useState)({}),ep=ec[0],ev=ec[1],ef=(0,d.useState)(null),em=ef[0],ex=ef[1],eh=(0,d.useState)(null),eg=eh[0],eb=eh[1],ey=(0,d.useState)(0),eZ=ey[0],ej=ey[1],eC=(0,d.useState)(""),eT=eC[0],ew=eC[1],ek=(0,d.useState)(0)[1],eS=function(e){ej(e);var t=eP(e,eO);X(e,t)},eq=function(e){ek(e)},eI=(0,c.aM)(v.n).data,eO=(null==eI?void 0:eI.Form.map(function(e){return e.settings}).flat())||[],eP=function(e){var t=null==eO?void 0:eO.find(function(t){return e>=(null==t?void 0:t.min)&&e<=(null==t?void 0:t.max)});return t?t.label:null},eR=(0,c.aM)(v.Q2,{variables:{entity:ep.entity,entityId:ep.entityId},skip:!ep.entity||!ep.entityId}),eD=eR.data,eL=eR.refetch,e_=(0,a.Z)((0,p.D)(v.Vw),1)[0],eQ=(0,a.Z)((0,p.D)(v.FE),1)[0],eE=(0,a.Z)((0,p.D)(v._q),1)[0],eW={formId:null==en?void 0:en.value,formFields:null==en?void 0:en.formFields,submissionData:eg},eA=function(e){var t,n=null==en?void 0:null===(t=en.formFields)||void 0===t?void 0:t.reduce(function(e,t){if(t.required)switch(t.type){case"defaultText":case"text":case"input":case"longText":case"textArea":e[t.stateName]=w.Z_().trim().required("".concat(t.label," is required"));break;case"numberInput":case"currency":case"slider":e[t.stateName]=w.Rx().required("".concat(t.label," is required")).nullable();break;case"select":case"signerInitials":case"radio":e[t.stateName]=w.Z_().required("".concat(t.label," is required"));break;case"multiSelect":e[t.stateName]=w.IX().of(w.Z_().required("Select a value")).min(1,"".concat(t.label," requires at least one selection")).required("".concat(t.label," is required"));break;case"checkbox":e[t.stateName]=w.IX().min(1,"".concat(t.label," requires at least one selection")).required("".concat(t.label," is required"));break;case"datepicker":e[t.stateName]=w.hT().required("".concat(t.label," is required"));break;case"time":e[t.stateName]=w.Z_().required("".concat(t.label," is required")).matches(/^\d{2}:\d{2}$/,"Time must be in HH:MM format");break;case"timeRange":e[t.stateName]=w.Ry().shape({startTime:w.Z_().required("Start time is required").matches(/^\d{2}:\d{2}$/,"Must be in HH:MM format"),endTime:w.Z_().required("End time is required").matches(/^\d{2}:\d{2}$/,"Must be in HH:MM format")}).required("".concat(t.label," is required"));break;case"signature":e[t.stateName]=w.Z_().required("Signature is required").nullable()}return e},{});return w.Ry().shape(n).validate(e,{abortEarly:!1})},eF=(S=(0,o.Z)(function(){return(0,s.__generator)(this,function(e){switch(e.label){case 0:if(!Q||!_)return[2];return[4,e_({variables:{formId:en.value,userId:ed.id,submissionData:eg,formFields:en.formFields,entity:_,entityId:Q}})];case 1:return e.sent(),[2]}})}),function(){return S.apply(this,arguments)}),eM=(I=(0,o.Z)(function(){var e;return(0,s.__generator)(this,function(t){switch(t.label){case 0:return[4,eQ({variables:{id:null===(e=null==eD?void 0:eD.FormSubmissions[0])||void 0===e?void 0:e.id,changes:eW}})];case 1:return t.sent(),[2]}})}),function(){return I.apply(this,arguments)}),eN=(O=(0,o.Z)(function(){var e,t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:if((null===(e=null==eD?void 0:eD.FormSubmissions[0])||void 0===e?void 0:e.entityId)!==Q)return[2];return[4,eE({variables:{id:null===(t=null==eD?void 0:eD.FormSubmissions[0])||void 0===t?void 0:t.id}})];case 1:return n.sent(),[2]}})}),function(){return O.apply(this,arguments)}),eU=function(){(null==en?void 0:en.name)==="None"?eu(!0):(null==en?void 0:en.id)&&(ea(!ei),eu(!1))},eV=function(e){e&&(L("formSubmission",e),eu(!1))},ez=function(e){eb(e)};return(0,d.useEffect)(function(){(null==V?void 0:V.entity)&&(null==V?void 0:V.entityId)&&null===em&&ex(V)},[V,em]),(0,d.useEffect)(function(){eL()},[ep.entityId,ep.entity]),(0,d.useEffect)(function(){_&&null!=_&&""!==_&&Q&&null!=Q&&""!==_&&ev({entity:_,entityId:Q})},[]),(0,d.useEffect)(function(){(null==V?void 0:V.entityId)!==(null==em?void 0:em.entityId)&&(null===em&&Q||ev(V),ex(V))},[null==V?void 0:V.entityId]),(0,d.useEffect)(function(){var e;if(null==eI?void 0:null===(e=eI.Form)||void 0===e?void 0:e.length){var t,n=(0,l.Z)(eI.Form).map(function(e){return(0,i.Z)((0,r.Z)({},e),{value:e.id})}).sort(function(e,t){return e.id-t.id});if(!(null===(t=null==eD?void 0:eD.FormSubmissions[0])||void 0===t?void 0:t.id)){var o=n.find(function(e){return 1===e.id});eo((0,i.Z)((0,r.Z)({},o),{value:null==o?void 0:o.id}))}ee(n)}},[eI]),(0,d.useEffect)(function(){var e;(null===(e=null==eD?void 0:eD.FormSubmissions[0])||void 0===e?void 0:e.id)&&(eo({id:null==eD?void 0:eD.FormSubmissions[0].id,name:null==eD?void 0:eD.FormSubmissions[0].form.name,value:null==eD?void 0:eD.FormSubmissions[0].formId,formFields:null==eD?void 0:eD.FormSubmissions[0].formFields,submissionData:null==eD?void 0:eD.FormSubmissions[0].submissionData}),eb(null==eD?void 0:eD.FormSubmissions[0].submissionData))},[null===(t=null==eD?void 0:eD.FormSubmissions[0])||void 0===t?void 0:t.id]),(0,d.useEffect)(function(){if((null==K?void 0:K.length)&&!(null==eD?void 0:eD.FormSubmissions[0])){var e=K.find(function(e){return 1===e.id});eo((0,i.Z)((0,r.Z)({},e),{value:null==e?void 0:e.id}))}},[K,null==eD?void 0:eD.FormSubmissions[0]]),(0,d.useEffect)(function(){eV(en)},[en]),(0,d.useEffect)(function(){if(U&&en){if((null==en?void 0:en.id)===1)eN();else{var e,t,n;(null===(e=null==eD?void 0:eD.FormSubmissions[0])||void 0===e?void 0:e.id)&&(null===(t=null==eD?void 0:eD.FormSubmissions[0])||void 0===t?void 0:t.entityId)===Q&&(null===(n=null==eD?void 0:eD.FormSubmissions[0])||void 0===n?void 0:n.entity)===_?eM():eF()}}},[U]),(0,d.useEffect)(function(){G&&eg&&eA(eg).then(function(){B(!0),ew("")}).catch(function(e){B(!1),ew(e.inner.map(function(e){return e.message}).join(", "))})},[G,eg]),(0,u.jsxs)(u.Fragment,{children:[G&&eT&&(0,u.jsx)(m.Z,{fontSize:"14px",color:"error",children:eT}),K.length&&(0,u.jsx)(f.Qr,(0,i.Z)((0,r.Z)({},{errors:R,register:D,control:P}),{name:"formSubmission",render:function(e){return(0,u.jsxs)("div",{style:q.autocompleteWrapper,children:[(0,u.jsx)(x.Z,(0,i.Z)((0,r.Z)({},e),{disablePortal:!0,options:K,disabled:z,value:en,getOptionLabel:function(e){return e.name},sx:(0,i.Z)((0,r.Z)({},q.autocomplete),{visibility:!W&&"hidden",height:!W&&0,margin:!W&&0}),onChange:function(e,t){var n=t||(0,r.Z)({},K.find(function(e){return 1===e.id}));eo(n),eV(n)},renderInput:function(e){return(0,u.jsx)(h.Z,(0,i.Z)((0,r.Z)({},e),{label:"Select Form",variant:"outlined",inputProps:(0,r.Z)({},e.inputProps)}))}})),M&&(0,u.jsx)(g.Z,{color:(null==en?void 0:en.value)&&(null==en?void 0:en.value)!==1?"primary":"disabled",onClick:eU,sx:{marginLeft:"10px"},children:(0,u.jsx)(j.Z,{sx:{fontSize:20}})}),es&&(0,u.jsx)("div",{className:"eyeNotification",style:q.eyeNotification,children:(0,u.jsxs)(m.Z,{fontSize:"12px",color:"error",children:["No form will be created inside the job","."]})})]})}})),en&&(null==en?void 0:en.id)!==1&&void 0!==A&&A&&(0,u.jsx)(T.L,{entityId:null===(n=null==eD?void 0:eD.FormSubmissions[0])||void 0===n?void 0:n.id,refetch:eL,scheme:en.formFields,submissionData:en.submissionData,isOffCanvas:!0,liftingSubmissions:ez,calculatedTotalScore:eS,scoreLabels:eO,blockStyle:q.blockStyle,onFileCountChange:eq}),(void 0===H||H)&&eZ>0&&(0,u.jsxs)(m.Z,{variant:"h6",sx:{padding:"10px",borderTop:1,fontFamily:"Nunito-Regular",fontSize:"16px"},children:["Total Score: ",eZ,eP(eZ,eO)&&" (".concat(eP(eZ,eO),")")]}),en&&(0,u.jsx)(b.Z,{open:ei,onClose:eU,style:{zIndex:"9999"},slotProps:{backdrop:{sx:{backgroundColor:"rgba(0, 0, 0, 0.7)"}}},children:(0,u.jsx)(y.Z,{sx:q.modalContainerStyle,children:(0,u.jsxs)(Z.Z,{sx:q.modalContentStyle,children:[(0,u.jsxs)(y.Z,{sx:q.stickyHeaderStyle,marginBottom:1,children:[(0,u.jsx)(m.Z,{variant:"h6",sx:{fontFamily:"Nunito-Regular",fontSize:"16px",paddingLeft:"10px"},children:"Form preview"}),(0,u.jsx)(g.Z,{color:"secondary",onClick:eU,sx:{marginLeft:"10px"},children:(0,u.jsx)(C.Z,{sx:{fontSize:20}})})]}),(0,u.jsx)("div",{style:q.previewScheme,children:(0,u.jsx)(T.L,{scheme:null==en?void 0:en.formFields,submissionData:null==en?void 0:en.submissionData,formSchemeOnEdit:null,formSchemeOnCopy:null,formSchemeOnDelete:null,blockStyle:q.blockStyle})})]})})})]})},q={autocomplete:{marginBottom:"1rem",marginTop:"1rem",flex:1},autocompleteWrapper:{display:"flex",alignItems:"center",position:"relative",width:"100%"},iconPreview:{height:"minContent"},blockStyle:{border:"none",backgroundColor:"#FFFFFF",highlighted:""},previewScheme:{pointerEvents:"none"},modalContainerStyle:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",zIndex:"9999"},eyeNotification:{position:"absolute",bottom:"-40px",right:"0",backgroundColor:"#fff",padding:"4px",zIndex:2,border:"2px solid #f5f5f5",borderRadius:"4px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",width:"auto",maxWidth:"300px",minWidth:"250px",wordWrap:"break-word"},modalContentStyle:{width:"650px",height:"600px",padding:"10px",overflowY:"auto",borderRadius:"12px",backgroundColor:"#FFFFFF"},stickyHeaderStyle:{position:"sticky",top:0,height:"44px",backgroundColor:"#F5F5F5",borderRadius:"12px",zIndex:1,fontFamily:"Nunito-SemiBold",border:1,padding:"15px",display:"flex",alignItems:"center",justifyContent:"space-between"}}},12547:function(e,t,n){"use strict";n.d(t,{r:function(){return c}});var o=n(26042),r=n(69396),i=n(85893),a=n(45697),l=n.n(a),s=n(41664),u=n.n(s),d=n(23795),c=function(e){var t=e.children,n=e.href,a=e.noWrap,l=e.target,s=e.sx,c=void 0===s?{}:s;return a?(0,i.jsx)(i.Fragment,{children:t}):n?(0,i.jsx)(u(),{href:n,target:l,passHref:!0,children:(0,i.jsx)(d.Z,(0,r.Z)((0,o.Z)({sx:c},e),{children:t}))}):(0,i.jsx)(d.Z,(0,r.Z)((0,o.Z)({sx:c},e),{children:t}))};c.defaultProps={onClick:function(e){e.stopPropagation()}},c.propTypes={onClick:l().func,href:l().string,noWrap:l().bool,color:l().string}},93884:function(e,t,n){"use strict";n.d(t,{C:function(){return v}});var o=n(26042),r=n(69396),i=n(85893);n(67294);var a=n(45697),l=n(90948),s=n(15861),u=n(51233),d=n(11057),c=n(61730),p=(0,l.ZP)("img")({width:"300px",height:"250px"}),v=function(e){var t=e.imageSrc,n=e.sx,a=e.imageSx,l=e.title,v=e.titleSx,f=e.subtitleFirstLine,m=e.subtitleFirstLineSx,x=e.subtitleSecondLine,h=e.subtitleSecondLineSx,g=e.buttonText,b=e.onAction,y=(0,c.Z)("(max-width: 400px)");return(0,i.jsxs)(u.Z,{sx:(0,r.Z)((0,o.Z)({},n),{width:"100%",height:"100%"}),justifyContent:"center",alignItems:"center",spacing:2,color:"#757575",children:[(0,i.jsx)(p,{src:t,sx:(0,r.Z)((0,o.Z)({},a),{width:y?"250px":"300px"})}),(0,i.jsx)(s.Z,{typography:"h5",sx:(0,o.Z)({},v),children:l}),(0,i.jsxs)(u.Z,{alignItems:"center",sx:{padding:"0px 10px",textAlign:"center"},children:[(0,i.jsx)(s.Z,{sx:(0,o.Z)({},m),children:f}),(0,i.jsx)(s.Z,{sx:(0,o.Z)({},h),children:x})]}),g&&b&&(0,i.jsx)(d.Z,{variant:"contained",color:"secondary",onClick:b,children:g})]})};v.propTypes={imageSrc:a.string,title:a.string,subtitleFirstLine:a.string,subtitleSecondLine:a.string,onAction:a.func,sx:a.object,imageSx:a.object,titleSx:a.object,subtitleFirstLineSx:a.object,subtitleSecondLineSx:a.object},v.defaultProps={title:"",subtitleFirstLine:"",subtitleSecondLine:"",sx:{},imageSx:{},titleSx:{},subtitleFirstLineSx:{},subtitleSecondLineSx:{},onAction:null}},66321:function(e,t,n){"use strict";n.d(t,{E:function(){return x}});var o=n(26042),r=n(69396),i=n(85893),a=n(45697),l=n.n(a),s=n(94054),u=n(50480),d=n(56815),c=n(40476),p=n(79717),v=n(36872),f=n(51233),m=n(15861),x=function(e){var t=e.label,n=e.options,a=e.error,l=e.helperText,x=e.stackProps,g=e.formControlProps,b=e.labelLeft,y=function(e){var t=e.children;return(0,i.jsx)(i.Fragment,{children:t})};return(0,i.jsxs)(s.Z,(0,r.Z)((0,o.Z)({sx:{m:3},error:a,variant:"standard"},void 0===g?{}:g),{children:[(0,i.jsxs)(f.Z,(0,r.Z)((0,o.Z)({},b&&h),{children:[t&&(0,i.jsx)(c.Z,{id:"radio-group",color:"secondary",children:t}),(0,i.jsx)(p.Z,(0,r.Z)((0,o.Z)({},e),{"aria-labelledby":"radio-group",children:(0,i.jsx)(f.Z,(0,r.Z)((0,o.Z)({},void 0===x?{}:x),{children:n.map(function(e){var t=e.value,n=e.label,o=e.icon,r=e.ParentComponent;return(0,i.jsx)(void 0===r?y:r,{children:(0,i.jsx)(u.Z,{value:t,control:(0,i.jsx)(v.Z,{color:"secondary"}),label:(0,i.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:1,children:[o,(0,i.jsx)(m.Z,{children:n})]})})})})}))}))]})),(0,i.jsx)(d.Z,{children:l})]}))};x.defaultProps={options:[],error:!1,helperText:"",stackProps:{},formControlProps:{},labelLeft:!1},x.propTypes={label:l().string,options:l().arrayOf(l().shape({label:l().string.isRequired,value:l().any.isRequired,ParentComponent:l().elementType})).isRequired,error:l().bool,helperText:l().string,stackProps:l().object,formControlProps:l().object,labelLeft:l().bool};var h={direction:"row",alignItems:"center",flexWrap:"wrap",spacing:1}},92321:function(e,t,n){"use strict";n.d(t,{P:function(){return j}});var o=n(26042),r=n(69396),i=n(85893),a=n(67294),l=n(10166),s=n(45697),u=n.n(s),d=n(94054),c=n(47312),p=n(18972),v=n(18360),f=n(56815),m=n(51233),x=n(15861),h=n(5616),g=n(87918),b=n(69368),y={text:function(e){var t=e.option,n=e.multiple,o=e.index;return n&&o>0?", ".concat(t.label):t.label},textWithIcon:function(e){var t=e.option;return(0,i.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[t.icon,(0,i.jsxs)(x.Z,{children:[" ",t.label]})]})},chip:function(e){var t=e.chipProps,n=e.option;return(0,a.createElement)(g.Z,(0,r.Z)((0,o.Z)({},t),{key:n.value,label:n.label,icon:n.icon,sx:{color:n.color,bgcolor:n.bgcolor}}))}},Z={text:function(e){return e.option.label},textWithIcon:function(e){var t=e.option;return(0,i.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[t.icon,(0,i.jsxs)(x.Z,{children:[" ",t.label]})]})},chip:function(e){var t=e.chipProps,n=e.option;return(0,a.createElement)(g.Z,(0,r.Z)((0,o.Z)({},t),{key:n.value,label:n.label,icon:n.icon,sx:{color:n.color,bgcolor:n.bgcolor}}))},checkbox:function(e){var t=e.option,n=e.value;return(0,i.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(b.Z,{color:"secondary",sx:{height:"10px"},checked:n.indexOf(t.value)>-1}),(0,i.jsxs)(x.Z,{children:[" ",t.label]})]})}},j=function(e){var t=e.label,n=e.value,a=e.onChange,l=e.leftSideLabel,s=e.options,u=e.inputComponent,d=e.selectComponent,c=e.withoutSelectIcon,m=e.formControl,g=e.chipProps,b=e.selectProps,j=function(e){return s.find(function(t){return t.value===e})};return(0,i.jsxs)(C,(0,r.Z)((0,o.Z)({},m),{leftSideLabel:l,withoutSelectIcon:c,children:[t&&l&&(0,i.jsx)(x.Z,{children:t}),t&&!l&&(0,i.jsx)(T,{shrink:""!==n&&void 0!==n,children:t}),(0,i.jsx)(v.Z,(0,r.Z)((0,o.Z)({displayEmpty:!0},b),{value:n,onChange:a,inputProps:{shrink:!0},renderValue:function(){if(Array.isArray(n))return(0,i.jsx)(h.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.map(function(e,t){var n=j(e);return n?y[u]({chipProps:g,option:n,multiple:!0,index:t}):""})});var e=j(n);return e?(0,i.jsx)(h.Z,{children:y[u]({chipProps:g,option:e})}):""},children:s.map(function(e){return(0,i.jsx)(p.Z,{value:e.value,children:Z[d]({chipProps:g,option:e,value:n})},e.value)})})),(null==m?void 0:m.helperText)&&(0,i.jsx)(f.Z,{children:m.helperText})]}))};j.defaultProps={label:"",onChange:function(){},leftSideLabel:!1,options:[],inputComponent:"text",selectComponent:"text",withoutSelectIcon:!1,formControl:{error:!1,helperText:""},chipProps:{size:"small"},selectProps:{}},j.propTypes={label:u().string,value:u().oneOfType([u().string,u().array]),onChange:u().func,leftSideLabel:u().bool,options:u().arrayOf(u().shape({label:u().string.isRequired,value:u().string.isRequired,color:u().string,bgcolor:u().string,icon:u().node}).isRequired),inputComponent:u().oneOf(["text","textWithIcon","chip"]),selectComponent:u().oneOf(["text","textWithIcon","chip","checkbox"]),withoutSelectIcon:u().bool,formControl:u().object,chipProps:u().object,selectProps:u().object};var C=(0,l.Z)(d.Z)(function(e){e.theme;var t=e.leftSideLabel,n=e.withoutSelectIcon;return{"&.MuiFormControl-root":(0,o.Z)({display:"flex",flexDirection:"column",alignItems:"flex-start"},t&&{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"}),"& .MuiSelect-icon":(0,o.Z)({},n&&{display:"none"})}}),T=(0,l.Z)(c.Z)(function(e){return{"&.MuiFormLabel-root.MuiInputLabel-root.Mui-focused":{color:e.theme.palette.secondary.main}}})},89256:function(e,t,n){"use strict";n.d(t,{n:function(){return D}});var o=n(47568),r=n(26042),i=n(69396),a=n(828),l=n(29815),s=n(97582),u=n(85893),d=n(45697),c=n.n(d),p=n(96486),v=n(6388),f=n(50319),m=n(11961),x=n(93362),h=n(23776),g=n(5616),b=n(98456),y=n(93946),Z=n(78462),j=n(18972),C=n(14564),T=n(51233),w=n(50135),k=n(67294),S=n(10166),q=n(2845),I=n(28864),O=n(51738),P=n(11975),R=(0,x.D)(),D=function(e){var t=e.entityId,n=e.entity,d=e.values,c=void 0===d?[]:d,x=e.name,C=void 0===x?"tags":x,S=e.setValue,D=(0,q.x)().user,_=(0,k.useState)(null),Q=_[0],E=_[1],W=(0,k.useState)(""),A=W[0],F=W[1],M=(0,k.useState)(""),N=M[0],U=M[1],V=(0,k.useState)(""),z=V[0],H=V[1],$=(0,v.aM)(O.BU,{skip:!t,variables:{entityId:t,entity:n},onCompleted:function(e){S(C,e.tags)}}),G=$.data,B=(void 0===G?{tags:[]}:G).tags,J=$.loading,X=$.refetch,Y=(0,v.aM)(O.gI,{skip:!Q,variables:{entityId:t,entity:n,q:""!==z?"%".concat(z,"%"):null}}),K=Y.data,ee=(void 0===K?{tags:[]}:K).tags,et=Y.loading,en=(0,a.Z)((0,f.D)(O.Zm,{refetchQueries:["GetAllTags"]}),2),eo=en[0],er=en[1].loading,ei=(0,a.Z)((0,f.D)(O.LE,{onCompleted:function(){X()}}),2),ea=ei[0],el=ei[1].loading,es=(0,a.Z)((0,f.D)(O.cS,{onCompleted:function(){X()}}),2),eu=es[0],ed=es[1].loading,ec=(0,a.Z)((0,f.D)(O.g$,{refetchQueries:["GetAllTags"]}),2),ep=ec[0],ev=ec[1].loading;(0,k.useEffect)(function(){var e=setTimeout(function(){H(N)},500);return function(){return clearTimeout(e)}},[N]);var ef,em,ex,eh=function(e){e.stopPropagation(),E(e.currentTarget)},eg=function(){E(null)},eb=(ef=(0,o.Z)(function(e,o){var r,i,a;return(0,s.__generator)(this,function(e){switch(e.label){case 0:if("string"!=typeof o)return[3,1];return F({label:o}),[3,6];case 1:if(!(o&&o.inputValue&&t))return[3,2];return ea({variables:{objects:[{entity:n,entityId:t,Taxonomy:{data:{type:"tags",status:"active",name:o.inputValue,meta:{color:"#0679d8"},isGroup:!1,adminId:D.adminId}}}]}}),F(null),[3,6];case 2:if(!(o&&o.value&&t))return[3,3];return ea({variables:{objects:[{entity:n,entityId:t,taxonomyId:o.value}]}}),F(null),[3,6];case 3:if(!(o&&o.inputValue))return[3,5];return[4,eo({variables:{objects:[{type:"tags",status:"active",name:o.inputValue,meta:{color:"#0679d8"},isGroup:!1,adminId:D.adminId}]}})];case 4:return a=e.sent().data.insert_Taxonomy,S(C,(0,l.Z)(c).concat([{id:null,tag:{id:a.returning[0].id,name:a.returning[0].name,meta:a.returning[0].meta}}])),F(null),[3,6];case 5:o&&o.value&&(S(C,(0,l.Z)(c).concat([{id:null,tag:{id:o.value,name:o.label,meta:o.meta}}])),F(null)),e.label=6;case 6:return[2]}})}),function(e,t){return ef.apply(this,arguments)}),ey=(0,k.useCallback)(function(e,t){var n=R(e,t),o=t.inputValue,r=e.some(function(e){return o===e.label});return""===o||r||n.push({inputValue:o,label:'Add "'.concat(o,'"')}),n},[]),eZ=(0,k.useCallback)(function(e){return"string"==typeof e?e:e.inputValue?e.inputValue:e.label},[]),ej=function(e){t?eu({variables:{tagEntityId:e}}):S(C,c.filter(function(t,n){return n!==e}))},eC=(em=(0,o.Z)(function(e){var t,n,o,a,l,u;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,ep({variables:{tagId:t=e.tagId,object:{meta:{color:e.color}}}})];case 1:return l=n.sent().data.update_Taxonomy_by_pk,S(C,c.map(function(e){return e.tag.id===t?(0,i.Z)((0,r.Z)({},e),{tag:(0,r.Z)({},l)}):e})),[2]}})}),function(e){return em.apply(this,arguments)}),eT=(ex=(0,o.Z)(function(e){var t,n,o,a,l,u;return(0,s.__generator)(this,function(o){switch(o.label){case 0:return[4,ep({variables:{tagId:t=e.tagId,object:{name:n=e.name}}})];case 1:return l=o.sent().data.update_Taxonomy_by_pk,S(n,c.map(function(e){return e.tag.id===t?(0,i.Z)((0,r.Z)({},e),{tag:(0,r.Z)({},l)}):e})),[2]}})}),function(e){return ex.apply(this,arguments)}),ew=Boolean(Q),ek=(0,k.useMemo)(function(){return ee.map(function(e){return{label:e.name,value:e.id,meta:e.meta}})},[ee]),eS=(0,k.useMemo)(function(){return p.uniqBy((0,l.Z)(B).concat((0,l.Z)(c)),function(e){var t;return null===(t=e.tag)||void 0===t?void 0:t.id})},[B,c]);return(0,u.jsxs)(T.Z,{direction:"row",alignItems:"center",children:[(0,u.jsx)(P.P,{tags:eS,handleDeleteTagEntity:ej}),(0,u.jsx)(L,{id:ew?"tags-popover":void 0,open:ew,anchorEl:Q,onClose:eg,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,u.jsxs)(g.Z,{sx:{maxHeight:"80vh",width:"280px",p:"10px",pt:"5px"},children:[(0,u.jsx)(h.Z,{freeSolo:!0,selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:(0,l.Z)(ek),value:A,onChange:eb,onInputChange:function(e,t){U(t)},filterOptions:ey,getOptionLabel:eZ,renderOption:function(e,t){return(0,u.jsx)(j.Z,(0,i.Z)((0,r.Z)({},e),{children:t.label}))},renderInput:function(e){return(0,u.jsx)(w.Z,(0,i.Z)((0,r.Z)({},e),{variant:"standard",color:"secondary",label:"Search tag",InputProps:(0,i.Z)((0,r.Z)({},e.InputProps),{endAdornment:(0,u.jsxs)(u.Fragment,{children:[et||er||el?(0,u.jsx)(b.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))},sx:{pl:"16px",pr:"16px"}}),J||ed||ev?(0,u.jsx)(T.Z,{width:"100%",alignItems:"center",p:4,children:(0,u.jsx)(b.Z,{color:"secondary"})}):(0,u.jsx)(Z.Z,{children:null==eS?void 0:eS.map(function(e,t){var n;return(0,u.jsx)(I.T,{tagEntityId:e.id||t,tagId:e.tag.id,name:e.tag.name,color:null===(n=e.tag.meta)||void 0===n?void 0:n.color,onDelete:ej,onColorChange:eC,onNameChange:eT})})})]})}),(0,u.jsx)(y.Z,{color:"black",onClick:eh,children:(0,u.jsx)(m.Z,{sx:{height:"16px",width:"16px"}})})]})};D.defaultProps={entityId:null},D.propTypes={entityId:c().number};var L=(0,S.Z)(C.ZP)({"& .MuiPaper-root":{borderRadius:"12px"}})},66137:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Job",n="";return(null==e?void 0:e.length)&&(n="\n      Taxonomy: {\n      _and: [\n        { entity: { _eq: ".concat(t,' } }\n        {\n          Taxonomy: {\n            status: { _eq: "active" }\n            _and: [{ id: { _in: [').concat(e,'] } }, { type: { _eq: "tags" } }]\n          }\n        }\n      ]\n    }\n  ')),n}},62551:function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var o=n(85893),r=n(11994),i=n(67294);function a(){var e=(0,i.useState)(null),t=e[0],n=e[1],a=(0,i.useCallback)(function(){n(null)},[]),l=(0,i.useMemo)(function(){if(null===t)return null;var e=t.content,n=t.keepMounted;return(0,o.jsx)(r.Z,{open:!0,keepMounted:n,onClose:a,children:e})},[t,a]),s=(0,i.useCallback)(function(e){var t=e.content,o=e.keepMounted;n({keepMounted:void 0===o||o,content:t({onClose:a})})},[a]);return[l,s]}},22244:function(e,t,n){"use strict";n.d(t,{AK:function(){return s},DJ:function(){return c},E6:function(){return r},cj:function(){return l},hD:function(){return d},iz:function(){return i},l8:function(){return u},yW:function(){return a}});var o=n(40656),r=[{text:"Quotation Requested",value:"supplierQuoteRequested",context:"info"},{text:"Quotation Completed",value:"supplierQuoteComplete",context:"help"},{text:"Draft Quotation",value:"supplierQuoteDraft",context:"info"},{text:"Awaiting threshold approval",value:"waitingThresholdApproval",context:"info"},{text:"Quotation Refused",value:"supplierQuoteRefused",context:"danger"},{text:"Quotation Sent",value:"supplierQuoteSent",context:"success"},{text:"Quotation Accepted",value:"quotationAccepted",context:"success"},{text:"Quotation Rejected",value:"quotationRejected",context:"danger"},{text:"Quotation Updated",value:"supplierQuoteUpdated",context:"success"}],i=[{text:"New Quote",value:"quoteNew",customerText:"Quote issued",supplierText:null},{text:"Sent to Supplier(s)",value:"quoteOffered",customerText:"Quote issued",supplierText:"Quote offered"},{text:"Received from Supplier(s)",value:"quoteReceived",customerText:"Final review",supplierText:"Quote submitted"},{text:"Sent to Customer",value:"quoteSent",customerText:"Awaiting approval",supplierText:"Awaiting approval"},{text:"Quote Accepted",value:"quoteAccepted",customerText:"Quote accepted",supplierText:"Quote accepted"},{text:"Quote Rejected",value:"quoteRejected",customerText:"Quote rejected",supplierText:"Quote rejected"},{text:"Canceled",value:"quoteCancelled",customerText:"Cancelled",supplierText:null},{text:"Closed",value:"quoteClosed",customerText:"Closed",supplierText:"Closed"}],a=[{text:"Pending",value:"pending",colour:o.Q.COLOUR.info},{text:"Raised",value:"raised",colour:o.Q.COLOUR.info},{text:"Offered",value:"offered",colour:o.Q.COLOUR.warning},{text:"Accepted",value:"accepted",colour:o.Q.COLOUR.success},{text:"In Progress",value:"inProgress",colour:o.Q.COLOUR.primary},{text:"Completed",value:"completed",colour:o.Q.COLOUR.muiLightGray},{text:"Awaiting threshold approval",value:"waitingThresholdApproval",colour:o.Q.COLOUR.info},{text:"Report Sent",value:"reportSent",colour:o.Q.COLOUR.muiGray},{text:"Invoice Sent",value:"invoiceSent",colour:o.Q.COLOUR.secondary},{text:"Customer Paid",value:"customerPaid",colour:o.Q.COLOUR.help},{text:"Supplier Paid",value:"supplierPaid",colour:o.Q.COLOUR.help},{text:"Canceled",value:"canceled",colour:o.Q.COLOUR.black},{text:"Closed",value:"closed",colour:o.Q.COLOUR.black},{text:"On Hold",value:"onHold",colour:o.Q.COLOUR.black},{text:"Continued",value:"continued",colour:o.Q.COLOUR.primary},{text:"Paused",value:"paused",colour:o.Q.COLOUR.black}],l=[{label:"Pending",value:"pending"},{label:"Raised",value:"raised"},{label:"Offered",value:"offered"},{label:"Accepted",value:"accepted"},{label:"In Progress",value:"inProgress"},{label:"Completed",value:"completed"},{label:"Awaiting threshold approval",value:"waitingThresholdApproval"},{label:"Report Sent",value:"reportSent"},{label:"Invoice Sent",value:"invoiceSent"},{label:"Customer Paid",value:"customerPaid"},{label:"Supplier Paid",value:"supplierPaid"},{label:"Quote",value:"quote"},{label:"Site Visit",value:"siteVisit"},{label:"Canceled",value:"canceled"},{label:"Closed",value:"closed"},{label:"On Hold",value:"onHold"},{label:"Continued",value:"continued"},{label:"Paused",value:"paused"}],s=[{text:"Uplift Draft",value:"upliftDraft",context:"info"},{text:"Supplier Uplift Requested",value:"supplierUpliftRequested",context:"secondary"},{text:"Uplift Requested Send to Customer",value:"upliftRequestSendCustomer",context:"secondary"},{text:"Uplift Approved",value:"customerUpliftApproved",context:"success"},{text:"Uplift Rejected",value:"customerUpliftRejected",context:"danger"}],u=[{text:"Offered",value:"offered",context:"info"},{text:"Raised",value:"raised",context:"info"},{text:"Pending",value:"pending",context:"info"},{text:"Accepted",value:"accepted",context:"info"},{text:"Uplift Requested by Supplier",value:"supplierUpliftRequested",context:"info"},{text:"Uplift Draft",value:"upliftDraft",context:"info"},{text:"Uplift Requested Send Customer",value:"upliftRequestSendCustomer",context:"info"},{text:"Uplift Requested Approved",value:"customerUpliftApproved",context:"success"},{text:"In Dispute",value:"inDispute",context:"info"},{text:"Resumed",value:"resumed",context:"Danger"},{text:"Quote Sent",value:"quoteSent",context:"info"},{text:"Quote Offered",value:"quoteOffered",context:"info"},{text:"Report Sent Supplier",value:"reportSentSupplier",context:"info"},{text:"Dispute Resolved",value:"disputeResolved",context:"info"},{text:"Validated",value:"validated",context:"success"},{text:"Un Validated",value:"unvalidated",context:"success"},{text:"Paused",value:"paused",context:"info"},{text:"TimingChanged",value:"timingChanged",context:"info"},{text:"Customer Paid",value:"customerPaid",context:"info"},{text:"In Progress",value:"inProgress",context:"info"},{text:"PPM Invoice Created",value:"ppmInvoiceCreated",context:"success"},{text:"Late Arrival",value:"lateArrival",context:"info"},{text:"Pricing Changed",value:"pricingChanged",context:"info"},{text:"Report Sent",value:"reportSent",context:"info"},{text:"Invoice Sent Supplier",value:"invoiceSentSupplier",context:"info"},{text:"Invoice Sent",value:"invoiceSent",context:"info"},{text:"Invoice Sent Customer",value:"invoiceSentCustomer",context:"info"},{text:"Quote Accepted",value:"quoteAccepted",context:"info"},{text:"On Hold",value:"onHold",context:"info"},{text:"Continued",value:"continued",context:"info"},{text:"Quote Received",value:"quoteReceived",context:"info"},{text:"Quote New",value:"quoteNew",context:"info"},{text:"Closed",value:"closed",context:"danger"},{text:"Re posted",value:"reposted",context:"info"},{text:"Supplier Paid",value:"supplierPaid",context:"info"},{text:"Rejected",value:"rejected",context:"info"},{text:"Completed",value:"completed",context:"info"},{text:"Canceled",value:"canceled",context:"danger"}],d=[{value:"complete",text:"Complete"},{value:"returnVisitByAnother",text:"Return Visit By Another"},{value:"returnVisit",text:"Return Visit"},{value:"completeCertificate",text:"Complete Certificate"},{value:"couldNotDo",text:"Could Not Do"}],c=[{text:"Not yet offered",value:"pending",colour:o.Q.COLOUR.muiGray},{text:"Not yet offered",value:"raised",colour:o.Q.COLOUR.muiGray},{text:"Offered",value:"offered",colour:o.Q.COLOUR.warning},{text:"Not yet started",value:"accepted",colour:o.Q.COLOUR.white},{text:"In Progress",value:"inProgress",colour:o.Q.COLOUR.primary},{text:"Completed",value:"completed",colour:o.Q.COLOUR.secondary},{text:"Requires approval",value:"waitingThresholdApproval",colour:o.Q.COLOUR.info},{text:"Completed",value:"reportSent",colour:o.Q.COLOUR.secondary},{text:"Completed",value:"invoiceSent",colour:o.Q.COLOUR.secondary},{text:"Completed",value:"customerPaid",colour:o.Q.COLOUR.secondary},{text:"Completed",value:"supplierPaid",colour:o.Q.COLOUR.secondary},{text:"Quote",value:"quote",colour:o.Q.COLOUR.white},{text:"Not yet started",value:"siteVisit",colour:o.Q.COLOUR.white},{text:"Closed",value:"canceled",colour:o.Q.COLOUR.black},{text:"Closed",value:"closed",colour:o.Q.COLOUR.black},{text:"On Hold",value:"onHold",colour:o.Q.COLOUR.help},{text:"In Progress",value:"continued",colour:o.Q.COLOUR.primary},{text:"Closed",value:"paused",colour:o.Q.COLOUR.black},{text:"Not yet offered",value:"quoteNew",colour:o.Q.COLOUR.muiGray},{text:"Offered",value:"quoteOffered",colour:o.Q.COLOUR.warning},{text:"Completed",value:"quoteReceived",colour:o.Q.COLOUR.secondary},{text:"Requires approval",value:"quoteSent",colour:o.Q.COLOUR.info},{text:"Not yet started",value:"quoteAccepted",colour:o.Q.COLOUR.white},{text:"Closed",value:"quoteRejected",colour:o.Q.COLOUR.black},{text:"Closed",value:"quoteCancelled",colour:o.Q.COLOUR.black},{text:"Closed",value:"quoteClosed",colour:o.Q.COLOUR.black},{text:"Not yet started",value:"ppmNew",colour:o.Q.COLOUR.white}]},97092:function(e,t,n){"use strict";n.d(t,{FX:function(){return f},cj:function(){return c},jb:function(){return v}});var o=n(85893),r=n(40656),i=n(96540),a=n(90244),l=n(98441),s=n(422),u=n(38780),d=n(10105),c={DONE:"done",NEW:"new",IN_PROGRESS:"inprogress",TO_DO:"todo",BLOCKED:"blocked"},p={URGENT:"urgent",HIGH:"high",NORMAL:"normal",LOW:"low"},v=[{value:c.NEW,label:"New",icon:(0,o.jsx)(i.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:"#83BBDC"},{value:c.TO_DO,label:"To do",icon:(0,o.jsx)(a.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.secondary},{value:c.IN_PROGRESS,label:"In progress",icon:(0,o.jsx)(l.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.info},{value:c.DONE,label:"Done",icon:(0,o.jsx)(s.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.success},{value:c.BLOCKED,label:"Blocked",icon:(0,o.jsx)(u.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.danger}],f=[{value:p.URGENT,label:"Urgent",icon:(0,o.jsx)(d.Z,{color:"danger"})},{value:p.HIGH,label:"High",icon:(0,o.jsx)(d.Z,{color:"info"})},{value:p.NORMAL,label:"Normal",icon:(0,o.jsx)(d.Z,{color:"secondary"})},{value:p.LOW,label:"Low",icon:(0,o.jsx)(d.Z,{color:"muiGray"})}]},68676:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return tm}});var o=n(85893),r=n(26042),i=n(828),a=n(45697),l=n.n(a),s=n(20705),u=n(67294),d=n(15033),c=n(11057),p=n(90629),v=n(51233),f=n(15861),m=n(5336),x=n(6388),h=n(50319),g=n(93884),b=n(62551),y=n(81261),Z=n(48381),j=n(47568),C=n(69396),T=n(97582),w=n(67720),k=n(86886),S=n(50135),q=n(90948),I=n(69661),O=n(93946),P=n(84808),R=n(98456),D=n(5616),L=n(92321),_=n(42283),Q=n(40075),E=n(6103),W=n(30381),A=n.n(W),F=n(97092),M=n(69368),N=n(66321),U=n(33754),V=n(2845),z=n(52971),H=n(89256),$=n(22244),G=[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],B=[{label:"Job status changes",value:"jobStatusChanges"},{label:"Quote status changes",value:"quoteStatusChanges"},{label:"Date is",value:"dateIs"}],J={jobStatusChanges:$.yW,quoteStatusChanges:$.iz},X=[{label:"Reactive",value:"reactive"},{label:"PPM",value:"ppm"}],Y=[{label:"Account manager is",value:"accountManager"},{label:"Priority is",value:"priority"},{label:"Customer is",value:"customer"},{label:"Supplier is",value:"supplier"},{label:"Location is",value:"location"},{label:"Short job description is",value:"shortJobDescription"},{label:"Service is",value:"service"},{label:"Job date is",value:"jobDateIs"},{label:"Job type is",value:"jobTypeIs"},{label:"Job status is",value:"jobStatusIs"}],K=[{label:"Every",value:"every"},{label:"First",value:"first"},{label:"Second",value:"second"},{label:"Third",value:"third"},{label:"Fourth",value:"fourth"},{label:"Last",value:"last"}],ee=[{label:"Day",value:"day"},{label:"Monday",value:"monday"},{label:"Tuesday",value:"tuesday"},{label:"Wednesday",value:"wednesday"},{label:"Thursday",value:"thursday"},{label:"Friday",value:"friday"},{label:"Saturday",value:"saturday"},{label:"Sunday",value:"sunday"},{label:"Weekday",value:"weekday"},{label:"Weekend day",value:"weekend"}],et=[{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Year",value:"year"}],en=[{label:"today",value:"today"},{label:"tomorrow",value:"tomorrow"},{label:"yesterday",value:"yesterday"},{label:"last 7 days",value:"lastSevenDays"},{label:"last month",value:"lastMonth"},{label:"last 30 days",value:"lastThirtyDays"},{label:"last 90 days",value:"lastNinetyDays"},{label:"last year",value:"lastYear"},{label:"in next 7 days",value:"inNextSevenDays"},{label:"in this month",value:"inThisMonth"},{label:"in next month",value:"inNextMonth"},{label:"in next 30 days",value:"inNextThirtyDays"},{label:"in next 90 days",value:"inNextNinetyDays"},{label:"in next year",value:"inNextYear"}],eo=[{label:"Create a task",value:"createTask"},{label:"Send an email",value:"sendEmail"}],er=[{label:"Admin",value:"admin"},{label:"Customer",value:"customer"},{label:"Supplier",value:"supplier"},{label:"Tenant",value:"tenant"},{label:"Specific email address",value:"customEmail"}],ei=[{value:"jobNumber",label:"Job ID"},{value:"jobType",label:"Job type"},{value:"invoiceNumber",label:"Invoice number"},{value:"invoiceType",label:"Invoice type"},{value:"invoiceStatus",label:"Invoice status"},{value:"invoiceAmount",label:"Invoice amount"},{value:"outstandingDays",label:"Outstanding days"},{value:"customerName",label:"Customer"},{value:"customerManagerName",label:"Account Manager"},{value:"supplierName",label:"Supplier"},{value:"locationName",label:"Location"},{value:"addressMainName",label:"Address"},{value:"addressMainPostCode",label:"Post code"},{value:"addressInvoiceName",label:"Invoice address"},{value:"sublocationName",label:"Sublocation"},{value:"jobPriority",label:"Priority"},{value:"jobStatus",label:"Status"},{value:"jobTotal",label:"Job total"},{value:"dueFromCustomer",label:"Due from customer"},{value:"outstandingAmount",label:"Outstanding amount"},{value:"jobNetRevenue",label:"Net revenue"},{value:"supplierAmount",label:"Supplier total"},{value:"jobExpensesCustomer",label:"Expenses (Customer)"},{value:"jobExpensesSupplier",label:"Expenses (Supplier)"},{value:"jobServiceName",label:"Service line"},{value:"jobDate",label:"Job date"},{value:"jobReference",label:"Customer reference"},{value:"jobDescription",label:"Job description"},{value:"jobShortDescription",label:"Issue reported"},{value:"jobSource",label:"Source"},{value:"jobCostCategory",label:"Cost category"},{value:"adminUser",label:"Assigned to (Admin)"},{value:"customerUser",label:"Assigned to (Customer)"},{value:"supplierUser",label:"Assigned to (Supplier)"},{value:"jobCreatedAtDate",label:"Job created"},{value:"jobCreatedBy",label:"Created by"},{value:"jobPaidDate",label:"Paid date"},{value:"jobCompletedDate",label:"Completed date"},{value:"jobInvoicedDate",label:"Invoice date"},{value:"jobClosedDate",label:"Closed date"}],ea=[{value:"daysAfterTriggerDay",label:"Days after trigger day"},{value:"onTriggerDate",label:"On trigger date"},{value:"chooseDate",label:"Choose a date"}],el=[{value:"customer",label:"Customer"},{value:"supplier",label:"Supplier"},{value:"location",label:"Location"},{value:"job",label:"Quote or work order id"},{value:"externalURL",label:"External URL"}],es=n(48580),eu=n(4972),ed=n(28591),ec=function(e){var t,n,i,a=e.workflowId,l=e.register,s=e.watch,d=e.setValue,c=e.control,p=e.errors,m=e.isSubmit,h=e.createdWorkflowId,g=(0,u.useState)(""),b=g[0],y=g[1],Z=(0,V.x)().user,j=s("formSubmission"),T=s("taskTemplate.workflowTags"),w=s("taskTemplate.relatedLinks"),k=s("taskTemplate.dueDateType"),q=s("taskTemplate.relatedLinksType"),I=(0,x.aM)(eu.A5,{variables:{accountId:Z.adminId,q:""!==b?"%".concat(b,"%"):null}}),O=I.loading,P=I.data,R=(void 0===P?{items:[]}:P).items;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(v.Z,{direction:"column",spacing:3,pb:3,children:[(0,o.jsx)(_.Qr,{control:c,name:"taskTemplate.title",render:function(e){var t,n,r,i=e.value,a=e.onChange;return(0,o.jsx)(S.Z,{variant:"standard",color:"secondary",label:"Title",value:i,onChange:a,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.title,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(r=n.title)||void 0===r?void 0:r.message,sx:{mt:"0 !important"}})}}),(0,o.jsx)(_.Qr,{control:c,name:"taskTemplate.content",render:function(e){var t,n,r,i=e.value,a=e.onChange;return(0,o.jsx)(S.Z,{multiline:!0,minRows:8,variant:"filled",color:"secondary",label:"Content",value:i,onChange:a,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.content,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(r=n.content)||void 0===r?void 0:r.message})}}),(0,o.jsx)(_.Qr,{control:c,name:"taskTemplate.priority",render:function(e){var t,n,r,i=e.value,a=e.onChange;return(0,o.jsx)(N.E,{label:"Priority:",labelLeft:!0,stackProps:{direction:"row",flexWrap:"wrap"},options:F.FX,value:i,onChange:a,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.priority,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(r=n.priority)||void 0===r?void 0:r.message})}}),(0,o.jsx)(_.Qr,{control:c,name:"taskTemplate.dueDateType",defaultValue:null,render:function(e){var t,n,r,i=e.value,a=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=p.taskTemplate)||void 0===t?void 0:t.dueDateType,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(r=n.dueDateType)||void 0===r?void 0:r.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Due date",value:i,onChange:a,options:ea||[]})}}),"daysAfterTriggerDay"===k&&(0,o.jsx)(_.Qr,{control:c,name:"taskTemplate.dueDateDaysAfterTriggerDay",render:function(e){var t,n,r,i=e.value,a=e.onChange;return(0,o.jsx)(S.Z,{type:"number",placeholder:"Enter number of days",color:"secondary",variant:"standard",value:i,onChange:a,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.dueDateDaysAfterTriggerDay,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(r=n.dueDateDaysAfterTriggerDay)||void 0===r?void 0:r.message})}}),"chooseDate"===k&&(0,o.jsx)(_.Qr,{control:c,name:"taskTemplate.dueDateChooseDate",defaultValue:null,render:function(e){var t=e.value,n=e.onChange;return(0,o.jsx)(U.M,{label:"Due date",inputFormat:"Do MMM YYYY",minDate:A()(),value:t,onChange:n,renderInput:function(e){var t,n,i;return(0,o.jsx)(S.Z,(0,C.Z)((0,r.Z)({},e),{color:"secondary",variant:"standard",error:null===(t=p.taskTemplate)||void 0===t?void 0:t.dueDateChooseDate,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(i=n.dueDateChooseDate)||void 0===i?void 0:i.message}))}})}}),(0,o.jsx)(_.Qr,{name:"taskTemplate.assignedUser",control:c,render:function(e){var t,n,r,i=e.value,a=e.onChange;return(0,o.jsx)(es.q,{value:i,onChange:function(e,t){return a(t)},loading:O,options:R,setSearch:y,isOptionEqualToValue:function(e,t){return e.value===t.value},textFieldProps:{color:"secondary",variant:"standard",label:"Assigned to",error:null===(t=p.taskTemplate)||void 0===t?void 0:t.assignedUser,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(r=n.assignedUser)||void 0===r?void 0:r.message}})}}),(0,o.jsx)(v.Z,{direction:"row",width:"100%",alignItems:"center",children:(0,o.jsx)(H.n,{entityId:a,entity:"Workflow",name:"taskTemplate.workflowTags",values:T,setValue:d})}),(0,o.jsx)("input",(0,C.Z)((0,r.Z)({},l("taskTemplate.workflowTags")),{type:"hidden"})),(0,o.jsx)(_.Qr,{name:"taskTemplate.relatedLinksType",control:c,render:function(e){var t=e.value,n=e.onChange;return(0,o.jsx)(es.q,{multiple:!0,value:t||[],onChange:function(e,t){return n(t)},options:el,color:"secondary",textFieldProps:{color:"secondary",variant:"standard",label:"Select link type"},sx:{width:"100%"},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var i=n.selected;return(0,u.createElement)("li",(0,C.Z)((0,r.Z)({},e),{key:t.value,children:[(0,o.jsx)(M.Z,{color:"secondary",style:{height:10,marginRight:8},checked:i}),t.label]}))}})}}),(null==q?void 0:q.some(function(e){return"externalURL"===e.value}))&&(0,o.jsxs)(D.Z,{children:[(0,o.jsx)(z.V,{values:w,setValue:d,name:"taskTemplate.relatedLinks"}),(0,o.jsx)("input",(0,C.Z)((0,r.Z)({},l("taskTemplate.relatedLinks")),{type:"hidden"})),(null===(t=p.taskTemplate)||void 0===t?void 0:t.relatedLinks)&&(null==w?void 0:w.length)===0&&(0,o.jsx)(f.Z,{variant:"subtitle2",color:"warning.main",children:null===(n=p.taskTemplate)||void 0===n?void 0:null===(i=n.relatedLinks)||void 0===i?void 0:i.message})]}),(0,o.jsx)(ed.i,{values:j,control:c,errors:p,register:l,setValue:d,entity:"Workflow",entityId:(void 0===h?null:h)||a,hasPreview:!0,isSubmit:m})]})})};ec.defaultProps={register:function(){return{}},watch:function(){},setValue:function(){},control:{},errors:{}},ec.propTypes={register:l().func,watch:l().func,setValue:l().func,control:l().object,errors:l().object};var ep=n(79665),ev=n(74231),ef=ev.Ry({title:ev.Z_().required("Title is required field"),status:ev.Z_().oneOf(G.map(function(e){return e.value})).required("Status is required field"),action:ev.Z_().when("trigger.type",{is:"dateIs",then:ev.Z_().oneOf(["sendEmail"],"Invalid action").required("Action is required"),otherwise:ev.Z_().oneOf(eo.map(function(e){return e.value}),"Invalid action").required("Action is required")}),trigger:ev.Ry({type:ev.Z_().oneOf(B.map(function(e){return e.value})).required("Trigger is required field"),from:ev.Z_().when(["type"],function(e,t){var n;return"jobStatusChanges"===e||"quoteStatusChanges"===e?t.oneOf(null===(n=J[e])||void 0===n?void 0:n.map(function(e){return e.value})).required("From status is required field"):t}),to:ev.Z_().when(["type"],function(e,t){var n;return"jobStatusChanges"===e||"quoteStatusChanges"===e?t.oneOf(null===(n=J[e])||void 0===n?void 0:n.map(function(e){return e.value})).notOneOf([ev.iH("from")],'To status must be different from "From" status').required("To status is required field"):t}),frequency:ev.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(K.map(function(e){return e.value})).required("Frequency is required field"):t}),daysIn:ev.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(ee.map(function(e){return e.value})).required("Day is required field"):t}),inThePeriod:ev.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(et.map(function(e){return e.value})).required("Period is required field"):t}),jobType:ev.IX().when(["type"],function(e,t){return"jobStatusChanges"===e?t.of(ev.Z_().oneOf(X.map(function(e){return e.value})).required("Job type is required field")).required("Job type is required field"):t})}),condition:ev.IX().of(ev.Ry({type:ev.Ry({value:ev.Z_().required("Condition type is required field"),label:ev.Z_().required("Condition type is required field")}).required("Condition type is required field").typeError("Condition type is required field"),value:ev.Ry({value:ev.Z_().required("Condition value is required field"),label:ev.Z_().required("Condition value is required field")}).required("Condition value is required field").typeError("Condition value is required field")})),taskTemplate:ev.nK().when("action",{is:"createTask",then:ev.Ry({title:ev.Z_().required("Title is required"),content:ev.Z_().required("Content is required"),priority:ev.Z_().oneOf(F.FX.map(function(e){return e.value})).required("Priority is required"),dueDateType:ev.Z_().oneOf(ea.map(function(e){return e.value})).required("Due date type is required").typeError("Due date type is required"),dueDateDaysAfterTriggerDay:ev.nK().when("dueDateType",{is:"daysAfterTriggerDay",then:ev.Rx().integer("Days after trigger day must be an integer").min(0,"Days after trigger day must be greater than or equal to 0").required("Days after trigger day is required")}),dueDateChooseDate:ev.hT().when("dueDateType",{is:"chooseDate",then:ev.hT().required("Due date is required")}),assignedUser:ev.Ry().shape({value:ev.Z_().required(),label:ev.Z_().required()}).required("Assigned user is required").typeError("Assigned user is required"),workflowTags:ev.IX().of(ev.Ry().shape({id:ev.Rx().integer().nullable(),tag:ev.Ry().shape({id:ev.Rx().integer().required(),name:ev.Z_().required()}).required()})),relatedLinksType:ev.IX().of(ev.Ry().shape({value:ev.Z_().oneOf(el.map(function(e){return e.value})).required(),label:ev.Z_().required()})),relatedLinks:ev.nK().when("relatedLinksType",{is:function(e){return(null==e?void 0:e.length)>0&&e.some(function(e){return"externalURL"===e.value})},then:ev.IX().of(ev.Ry().shape({name:ev.Z_().required("Title is required"),url:ev.Z_().url("Invalid URL").required("URL is required")})).min(1,"Related links is required").required("Related links is required")})})}),emailTemplate:ev.nK().when("action",{is:"sendEmail",then:ev.Ry({sendToCategory:ev.Z_().oneOf(er.map(function(e){return e.value})).required("Send to category is required"),sendTo:ev.nK().when("sendToCategory",{is:"customEmail",then:ev.Z_().email("Invalid email address").required("Email is required"),otherwise:ev.IX().of(ev.Ry({value:ev.Rx().integer().required("Value is required field"),label:ev.Z_().required("Label is required field")})).required("Send to is required")}),subject:ev.Z_().required("Subject is required"),content:ev.Z_().required("Content is required"),buttonTitle:ev.Z_().required("Button title is required"),buttonLink:ev.Z_().url("Invalid URL").required("Button link is required"),columns:ev.IX().of(ev.Ry({value:ev.Z_().required("Value is required field"),label:ev.Z_().required("Label is required field")})),sendToTestEmail:ev.Z_().when("$sendTestEmailIsRequired",{is:!0,then:ev.Z_().email("Invalid email address").required("Email is required")})})})}),em=n(20320),ex=function(e){var t=e.control,n=e.errors,i=e.watch,a=e.setValue,l=e.reset,s=["jobStatusChanges","quoteStatusChanges"],d=i("action"),c=i("trigger.type"),p=i("trigger.from"),m=i("trigger.to"),x=(0,u.useMemo)(function(){return B.filter(function(e){var t=e.value;return"sendEmail"===d?"dateIs"===t:void 0===d||"dateIs"!==t})},[d]),h=(0,u.useMemo)(function(){var e,t;return null===(t=null===(e=J[c])||void 0===e?void 0:e.filter(function(e){return e.value!==m}))||void 0===t?void 0:t.map(function(e){var t;return{label:e.text,value:e.value}})},[c,m]),g=(0,u.useMemo)(function(){var e,t;return null===(t=null===(e=J[c])||void 0===e?void 0:e.filter(function(e){return e.value!==p}))||void 0===t?void 0:t.map(function(e){var t;return{label:e.text,value:e.value}})},[c,p]);return(0,o.jsx)(eh,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{direction:"row",alignItems:"center",width:"100%",children:[(0,o.jsxs)(v.Z,{spacing:1,width:"100%",children:[(0,o.jsx)(_.Qr,{name:"trigger.type",control:t,render:function(e){var t,r,i,l=e.value,s=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.type,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.type)||void 0===i?void 0:i.message},selectProps:{fullWidth:!0},label:"Select trigger",value:l,onChange:function(e){a("trigger.from",""),a("trigger.to",""),s(e)},options:x||[]})}}),!!s.includes(c)&&(0,o.jsxs)(v.Z,{direction:"row",alignItems:"flex-end",width:"100%",children:[(0,o.jsx)(f.Z,{sx:{fontWeight:700,mb:"5px",mr:"24px"},children:"From"}),(0,o.jsx)(_.Qr,{name:"trigger.from",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.from,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.from)||void 0===i?void 0:i.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select status",value:a,onChange:l,options:h||[]})}})]}),!!s.includes(c)&&(0,o.jsxs)(v.Z,{direction:"row",alignItems:"flex-end",width:"100%",children:[(0,o.jsx)(f.Z,{sx:{fontWeight:700,mb:"5px",mr:"40px"},children:"To"}),(0,o.jsx)(_.Qr,{name:"trigger.to",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.to,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.to)||void 0===i?void 0:i.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select status",value:a,onChange:l,options:g||[]})}})]}),"dateIs"===c&&(0,o.jsxs)(v.Z,{direction:"row",alignItems:"baseline",width:"100%",spacing:2,children:[(0,o.jsx)(_.Qr,{name:"trigger.frequency",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.frequency,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.frequency)||void 0===i?void 0:i.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Repeat",value:a,onChange:l,options:K||[]})}}),(0,o.jsx)(_.Qr,{name:"trigger.daysIn",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.daysIn,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.daysIn)||void 0===i?void 0:i.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Day",value:a,onChange:l,options:ee||[]})}}),(0,o.jsx)(f.Z,{sx:{textWrap:"nowrap"},children:"in the"}),(0,o.jsx)(_.Qr,{name:"trigger.inThePeriod",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.inThePeriod,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.inThePeriod)||void 0===i?void 0:i.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Period",value:a,onChange:l,options:et||[]})}})]}),"jobStatusChanges"===c&&(0,o.jsx)(_.Qr,{name:"trigger.jobType",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.jobType,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(i=r.jobType)||void 0===i?void 0:i.message,fullWidth:!0},selectComponent:"checkbox",selectProps:{fullWidth:!0,multiple:!0},label:"Select job type",value:a||[],onChange:function(e){var t=e.target.value;l("string"==typeof t?t.split(","):t)},options:X||[]})}})]}),(0,o.jsx)(v.Z,{children:(0,o.jsx)(O.Z,{sx:{mb:"-8px"},onClick:function(){l((0,C.Z)((0,r.Z)({},i()),{trigger:{type:"",from:"",to:"",frequency:"",daysIn:"",inThePeriod:"",jobType:[]},condition:[]}))},children:(0,o.jsx)(em.Z,{sx:{color:"danger.main"}})})})]})})};ex.propTypes={control:l().object.isRequired,errors:l().object.isRequired,watch:l().func.isRequired,setValue:l().func.isRequired,reset:l().func.isRequired},ex.defaultProps={errors:{}};var eh=(0,q.ZP)(p.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eg={"jobStatusChanges-reactive":"reactive",quoteStatusChanges:"quote"},eb={"jobStatusChanges-reactive":["jobTypeIs","jobStatusIs"],"jobStatusChanges-ppm":["priority","jobTypeIs","jobStatusIs"],quoteStatusChanges:["jobTypeIs","jobStatusIs"],dateIs:[]},ey=function(e){var t=e.index,n=e.field,r=e.control,i=e.errors,a=e.watch,l=e.remove,s=(0,V.x)().user,d=(0,u.useState)(""),c=d[0],p=d[1],f=a("trigger.type"),m=a("trigger.jobType"),h=a("condition[".concat(t,"].type")),g=(0,u.useMemo)(function(){return Y.filter(function(e){var t=e.value,n=eb["".concat(f).concat(m?"-"+m:"")];return!(null==n?void 0:n.includes(t))})},[f,m]),b=(0,u.useMemo)(function(){return eg["".concat(f).concat(m?"-"+m:"")]},[f,m]),y=(0,x.aM)(eu.yR,{skip:(null==h?void 0:h.value)!=="accountManager",variables:{accountId:s.adminId,limit:50,offset:0}}),Z=y.loading,j=y.data,C=(void 0===j?{items:[]}:j).items,T=(0,x.aM)(eu.SW,{skip:(null==h?void 0:h.value)!=="customer",variables:{q:""!==c?"%".concat(c,"%"):null,limit:50,offset:0}}),w=T.loading,k=T.data,S=(void 0===k?{items:[]}:k).items,q=(0,x.aM)(eu._d,{skip:(null==h?void 0:h.value)!=="location",variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},status:{_eq:"active"}},limit:50,offset:0}}),I=q.loading,P=q.data,R=(void 0===P?{items:[]}:P).items,D=(0,x.aM)(eu.by,{skip:(null==h?void 0:h.value)!=="supplier",variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},type:{_eq:"supplier"}},limit:50,offset:0}}),L=D.loading,Q=D.data,E=(void 0===Q?{items:[]}:Q).items,W=(0,x.aM)(eu.T_,{skip:(null==h?void 0:h.value)!=="priority"&&!b,variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},subtype:{_eq:b}},limit:50,offset:0}}),A=W.loading,F=W.data,M=(void 0===F?{items:[]}:F).items,N=(0,x.aM)(eu._f,{skip:(null==h?void 0:h.value)!=="shortJobDescription",variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},status:{_eq:"active"},type:{_eq:"jobTags"}},orderBy:{name:"asc"},limit:50,offset:0}}),U=N.loading,z=N.data,H=(void 0===z?{items:[]}:z).items,$=(0,x.aM)(eu.kx,{skip:(null==h?void 0:h.value)!=="service",variables:{q:""!==c?"%".concat(c,"%"):null,limit:50,offset:0}}),G=$.loading,B=$.data,K=(void 0===B?{items:[]}:B).items,ee=(0,u.useCallback)(function(){if(!(null==h?void 0:h.value))return[];switch(h.value){case"priority":return M;case"accountManager":return C;case"customer":return S;case"supplier":return E;case"location":return R;case"shortJobDescription":return H;case"service":return K;case"jobDateIs":return en;case"jobTypeIs":return X;case"jobStatusIs":return J.jobStatusChanges.map(function(e){var t;return{label:e.text,value:e.value}})}},[null==h?void 0:h.value,M,C,S,E,R,H,K]);return(0,o.jsx)(eZ,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{width:"100%",spacing:1,children:[(0,o.jsxs)(v.Z,{width:"100%",direction:"row",alignItems:"center",children:[(0,o.jsx)(_.Qr,{defaultValue:null==n?void 0:n.type,name:"condition[".concat(t,"].type"),control:r,render:function(e){var n,r,a,l,s,u,d,c,v,f=e.value,m=e.onChange;return(0,o.jsx)(es.q,{fullWidth:!0,color:"secondary",value:f,onChange:function(e,t){p(""),m(t)},isOptionEqualToValue:function(e,t){return e.value===t.value},options:g,textFieldProps:{label:"Condition",variant:"standard",color:"secondary",error:null===(n=i.condition)||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r.type,helperText:(null===(a=i.condition)||void 0===a?void 0:null===(l=a[t])||void 0===l?void 0:null===(s=l.type)||void 0===s?void 0:s.message)||(null===(u=i.condition)||void 0===u?void 0:null===(d=u[t])||void 0===d?void 0:null===(c=d.type)||void 0===c?void 0:null===(v=c.value)||void 0===v?void 0:v.message)}})}}),(0,o.jsx)(O.Z,{sx:{mb:"-8px"},onClick:function(){return l(t)},children:(0,o.jsx)(em.Z,{sx:{color:"danger.main"}})})]}),!!h&&(0,o.jsx)(_.Qr,{defaultValue:null==n?void 0:n.value,name:"condition[".concat(t,"].value"),control:r,render:function(e){var n,r,a,l,s,u,d,c,v,f=e.value,m=e.onChange;return(0,o.jsx)(es.q,{color:"secondary",filterSelectedOptions:!0,loading:Z||w||I||L||A||U||G,value:f,onChange:function(e,t){m(t)},isOptionEqualToValue:function(e,t){return e.value===t.value},options:ee(),setSearch:p,textFieldProps:{label:"Select ".concat(null==h?void 0:h.label),variant:"standard",color:"secondary",error:null===(n=i.condition)||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r.value,helperText:(null===(a=i.condition)||void 0===a?void 0:null===(l=a[t])||void 0===l?void 0:null===(s=l.value)||void 0===s?void 0:s.message)||(null===(u=i.condition)||void 0===u?void 0:null===(d=u[t])||void 0===d?void 0:null===(c=d.value)||void 0===c?void 0:null===(v=c.value)||void 0===v?void 0:v.message)}})}})]})})};ey.propTypes={index:l().number,field:l().object,control:l().object,errors:l().object,watch:l().func,remove:l().func};var eZ=(0,q.ZP)(p.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),ej=n(7297),eC=n(75063);function eT(){var e=(0,ej.Z)(["\n  mutation CreateTaskWorkflow($data: jsonb!) {\n    createTaskWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return eT=function(){return e},e}function ew(){var e=(0,ej.Z)(["\n  mutation CreateEmailWorkflow($data: jsonb!) {\n    createEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return ew=function(){return e},e}function ek(){var e=(0,ej.Z)(["\n  mutation UpdateTaskWorkflow($data: jsonb!) {\n    updateTaskWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return ek=function(){return e},e}function eS(){var e=(0,ej.Z)(["\n  mutation UpdateEmailWorkflow($data: jsonb!) {\n    updateEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return eS=function(){return e},e}function eq(){var e=(0,ej.Z)(["\n  mutation SnedTestEmailWorkflow($data: jsonb!) {\n    sendTestEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return eq=function(){return e},e}var eI=(0,eC.Ps)(eT()),eO=(0,eC.Ps)(ew()),eP=(0,eC.Ps)(ek()),eR=(0,eC.Ps)(eS()),eD=(0,eC.Ps)(eq()),eL=n(39641);function e_(){var e=(0,ej.Z)(["\n  fragment WorkflowFields on Workflow {\n    id\n    status\n    title\n    action\n    fired\n    taskTemplate\n    emailTemplate\n    meta\n    createdAt\n    updatedAt\n    userId\n    adminId\n  }\n"]);return e_=function(){return e},e}function eQ(){var e=(0,ej.Z)(["\n  fragment WorkflowConditionFields on WorkflowCondition {\n    id\n    isTrigger\n    trigger\n    condition\n    meta\n    createdAt\n    updatedAt\n    workflowId\n  }\n"]);return eQ=function(){return e},e}function eE(){var e=(0,ej.Z)(['\n  query GetWorkflow($id: Int!) {\n    workflow: Workflow_by_pk(id: $id) {\n      ...WorkflowFields\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Workflow" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n        }\n      }\n      user: User {\n        id\n        fullName\n      }\n    }\n  }\n  ',"\n  ","\n"]);return eE=function(){return e},e}function eW(){var e=(0,ej.Z)(["\n  query GetWorkflows(\n    $q: String\n    $status: workflow_status\n    $tags: [Int]\n    $limit: Int = 50\n    $offset: Int = 0\n    $orderBy: [Workflow_order_by!]\n  ) {\n    workflows: Workflow(\n      where: { title: { _ilike: $q }, status: { _eq: $status }, ",' }\n      limit: $limit\n      offset: $offset\n      order_by: $orderBy\n    ) {\n      ...WorkflowFields\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Workflow" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "tags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n        }\n      }\n      user: User {\n        fullName\n      }\n    }\n    meta: Workflow_aggregate(\n      where: { title: { _ilike: $q }, status: { _eq: $status },  '," })\n      {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return eW=function(){return e},e}function eA(){var e=(0,ej.Z)(["\n  mutation DeleteWorkflow($workflowId: Int!) {\n    delete_Workflow_by_pk(id: $workflowId) {\n      id\n    }\n  }\n"]);return eA=function(){return e},e}var eF=(0,eC.Ps)(e_()),eM=(0,eC.Ps)(eQ()),eN=(0,eC.Ps)(eE(),eF,eM),eU=function(e){var t=e.tagsWhere;return(0,eC.Ps)(eW(),t,t,eF,eM)},eV=(0,eC.Ps)(eA()),ez=function(e){var t=e.control,n=e.errors,r=(0,e.watch)("trigger.type"),i=(0,u.useMemo)(function(){return eo.filter(function(e){var t=e.value;return"dateIs"===r?"sendEmail"===t:"jobStatusChanges"!==r&&"quoteStatusChanges"!==r||"createTask"===t})},[r]);return(0,o.jsx)(eH,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsx)(v.Z,{width:"100%",spacing:1,children:(0,o.jsx)(v.Z,{width:"100%",direction:"row",alignItems:"flex-end",children:(0,o.jsx)(_.Qr,{name:"action",control:t,render:function(e){var t,r=e.value,a=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:n.action,helperText:null===(t=n.action)||void 0===t?void 0:t.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select action",value:r,onChange:a,options:i})}})})})})};ez.propTypes={control:l().object.isRequired,errors:l().object.isRequired,watch:l().func.isRequired};var eH=(0,q.ZP)(p.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),e$=n(21023),eG=(0,q.ZP)(w.Z)(function(){return{width:"50%",height:"40px",borderRightWidth:"2px",borderStyle:"dashed"}}),eB=n(74721),eJ=function(e){e.register;var t=e.control,n=e.errors,i=e.watch,a=e.setValue,l=e.sendTestEmail,s=(0,V.x)().user,d=(0,u.useState)(""),p=d[0],m=d[1],h=(0,u.useState)(""),g=h[0],b=h[1],y=i("emailTemplate.sendToCategory"),Z=(0,x.aM)(eu.qd,{skip:!y||"customEmail"===y||"admin"===y,variables:{q:""!==p?"%".concat(p,"%"):null,type:y,limit:50,offset:0}}),j=Z.loading,T=Z.data,k=(void 0===T?{items:[]}:T).items,q=(0,x.aM)(eu.yR,{skip:"admin"!==y,variables:{q:""!==g?"%".concat(g,"%"):null,accountId:s.adminId,limit:50,offset:0}}),I=q.loading,P=q.data,R=(void 0===P?{items:[]}:P).items;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{spacing:1,children:[(0,o.jsxs)(v.Z,{direction:"row",width:"100%",alignItems:"baseline",children:[(0,o.jsx)(f.Z,{sx:{fontWeight:700,mb:"5px",mr:"24px",textWrap:"nowrap"},children:"Send to"}),(0,o.jsx)(_.Qr,{name:"emailTemplate.sendToCategory",control:t,render:function(e){var t,r,i,l=e.value,s=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendToCategory,helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.sendToCategory)||void 0===i?void 0:i.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select category",value:l,onChange:function(e){a("emailTemplate.sendTo",null),s(e.target.value)},options:er||[]})}})]}),["customer","supplier","tenant"].includes(y)&&(0,o.jsx)(_.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,i,a,l=e.value,s=e.onChange;return(0,o.jsx)(es.q,{multiple:!0,disableCloseOnSelect:!0,color:"secondary",filterSelectedOptions:!0,loading:j,value:Array.isArray(l)?l:[],onChange:function(e,t){s(t)},options:k,setSearch:m,textFieldProps:{label:"Select ".concat(y),variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo,helperText:null===(i=n.emailTemplate)||void 0===i?void 0:null===(a=i.sendTo)||void 0===a?void 0:a.message},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var i=n.selected;return(0,u.createElement)("li",(0,C.Z)((0,r.Z)({},e),{key:t.value,children:[(0,o.jsx)(M.Z,{color:"secondary",style:{height:10,marginRight:8},checked:i}),t.label]}))}})}}),"admin"===y&&(0,o.jsx)(_.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,i,a,l=e.value,s=e.onChange;return(0,o.jsx)(es.q,{multiple:!0,disableCloseOnSelect:!0,color:"secondary",loading:I,value:Array.isArray(l)?l:[],onChange:function(e,t){s(t)},options:R,setSearch:b,textFieldProps:{label:"Select ".concat(y),variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo,helperText:null===(i=n.emailTemplate)||void 0===i?void 0:null===(a=i.sendTo)||void 0===a?void 0:a.message},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var i=n.selected;return(0,u.createElement)("li",(0,C.Z)((0,r.Z)({},e),{key:t.value,children:[(0,o.jsx)(M.Z,{color:"secondary",style:{height:10,marginRight:8},checked:i}),t.label]}))}})}}),"customEmail"===y&&(0,o.jsx)(_.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(S.Z,{color:"secondary",variant:"standard",label:"Specific email address",value:a,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.sendTo)||void 0===i?void 0:i.message})}})]})}),(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{spacing:4,children:[(0,o.jsx)(_.Qr,{name:"emailTemplate.subject",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Subject",value:a,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.subject),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.subject)||void 0===i?void 0:i.message})}}),(0,o.jsx)(_.Qr,{name:"emailTemplate.content",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,multiline:!0,minRows:6,color:"secondary",variant:"filled",label:"Content",value:a,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.content),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.content)||void 0===i?void 0:i.message})}}),(0,o.jsxs)(v.Z,{spacing:1,children:[(0,o.jsxs)(v.Z,{direction:"row",alignItems:"flex-end",spacing:1,children:[(0,o.jsx)(_.Qr,{name:"emailTemplate.buttonTitle",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Button title",value:a,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.buttonTitle),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.buttonTitle)||void 0===i?void 0:i.message})}}),(0,o.jsx)(e$.Z,(0,C.Z)((0,r.Z)({title:"This is the text that will show on the button in the email.",placement:"left-end",leaveDelay:1500,arrow:!0},eY),{children:(0,o.jsx)(O.Z,{size:"small",children:(0,o.jsx)(eB.Z,{color:"secondary"})})}))]}),(0,o.jsxs)(v.Z,{direction:"row",alignItems:"flex-end",spacing:1,children:[(0,o.jsx)(_.Qr,{name:"emailTemplate.buttonLink",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Button link",value:a,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.buttonLink),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.buttonLink)||void 0===i?void 0:i.message})}}),(0,o.jsx)(e$.Z,(0,C.Z)((0,r.Z)({title:"This is where the user will be directed upon clicking the button.",placement:"left-end",leaveDelay:1500,arrow:!0},eY),{children:(0,o.jsx)(O.Z,{size:"small",children:(0,o.jsx)(eB.Z,{color:"secondary"})})}))]})]})]})}),(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{spacing:1,children:[(0,o.jsx)(f.Z,{variant:"h6",children:"Column selector"}),(0,o.jsx)(f.Z,{children:"Select the columns you would like to see in the report"}),(0,o.jsx)(w.Z,{}),(0,o.jsx)(_.Qr,{name:"emailTemplate.columns",control:t,render:function(e){var t=e.value,n=e.onChange;return(0,o.jsx)(es.q,{multiple:!0,disableCloseOnSelect:!0,value:t||[],onChange:function(e,t){return n(t)},options:ei,color:"secondary",textFieldProps:{color:"secondary",variant:"standard",label:"Columns"},sx:{width:"100%"},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var i=n.selected;return(0,u.createElement)("li",(0,C.Z)((0,r.Z)({},e),{key:t.value,children:[(0,o.jsx)(M.Z,{color:"secondary",style:{height:10,marginRight:8},checked:i}),t.label]}))}})}})]})}),(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{direction:"row",alignItems:"flex-end",spacing:2,children:[(0,o.jsx)(_.Qr,{name:"emailTemplate.sendToTestEmail",control:t,render:function(e){var t,r,i,a=e.value,l=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Send test email",error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.sendToTestEmail),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(i=r.sendToTestEmail)||void 0===i?void 0:i.message,value:a,onChange:l})}}),(0,o.jsx)(c.Z,{color:"secondary",variant:"contained",sx:{width:120},type:"submit",onClick:l,children:"Send test"})]})})]})};eJ.defaultProps={sendTestEmail:function(){}},eJ.propTypes={register:l().func.isRequired,control:l().object.isRequired,errors:l().object.isRequired,watch:l().func.isRequired,setValue:l().func.isRequired};var eX=(0,q.ZP)(p.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eY={slotProps:{tooltip:{sx:{backgroundColor:"secondary.main"}},arrow:{sx:{color:"secondary.main"}}}},eK=function(e){var t,n,o;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,from:e.trigger.from,to:e.trigger.to,jobType:e.trigger.jobType},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),taskTemplate:{status:"new",title:e.taskTemplate.title,content:e.taskTemplate.content,priority:e.taskTemplate.priority,dueDateType:e.taskTemplate.dueDateType,dueDateDaysAfterTriggerDay:e.taskTemplate.dueDateDaysAfterTriggerDay,dueDateChooseDate:e.taskTemplate.dueDateChooseDate,assignedUser:{value:e.taskTemplate.assignedUser.value,label:e.taskTemplate.assignedUser.label}},formSubmission:{formId:null===(n=e.formSubmission)||void 0===n?void 0:n.value},tags:null===(o=e.taskTemplate.workflowTags)||void 0===o?void 0:o.map(function(e){return{entity:"Workflow",taxonomyId:e.tag.id}})}},e0=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e1=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,from:e.trigger.from,to:e.trigger.to,jobType:e.trigger.jobType},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),taskTemplate:{status:"new",title:e.taskTemplate.title,content:e.taskTemplate.content,priority:e.taskTemplate.priority,dueDateType:e.taskTemplate.dueDateType,dueDateDaysAfterTriggerDay:e.taskTemplate.dueDateDaysAfterTriggerDay,dueDateChooseDate:e.taskTemplate.dueDateChooseDate,assignedUser:{value:e.taskTemplate.assignedUser.value,label:e.taskTemplate.assignedUser.label},relatedLinksType:e.taskTemplate.relatedLinksType,relatedLinks:e.taskTemplate.relatedLinks,formSubmission:e.formSubmission?{formId:e.formSubmission.value}:null}}},e2=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e4=function(e){var t;return{sendToTestEmail:e.emailTemplate.sendToTestEmail,title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e5=function(e){var t=e.workflowId,n=e.close,a=(0,eL.D)(),l=(0,u.useState)(!1),s=l[0],d=l[1],p=(0,u.useState)(null),m=p[0],g=p[1],b=(0,u.useState)(!1),y=b[0],Z=b[1],w=(0,_.cI)({defaultValues:{status:"active",taskTemplate:{status:"new",priority:"urgent",workflowTags:[],relatedLinks:[]}},context:{sendTestEmailIsRequired:y},resolver:(0,ep.S)(ef)}),q=w.handleSubmit,O=w.register,W=w.watch,A=w.setValue,F=w.reset,M=w.control,N=w.errors,U=(0,_.Dq)({control:M,name:"condition"}),V=U.fields,z=U.append,H=U.remove,$=(0,x.aM)(eN,{skip:!t,variables:{id:t},onCompleted:function(){var e,t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{workflow:{}}).workflow,o=(null===(e=n.conditions)||void 0===e?void 0:e.find(function(e){return e.isTrigger}))||{},i=(null===(t=n.conditions)||void 0===t?void 0:t.filter(function(e){return!e.isTrigger}))||[];F({title:n.title,status:n.status,action:n.action,trigger:o.trigger,condition:i.map(function(e){return{type:e.condition.type,value:e.condition.value}}),taskTemplate:(0,C.Z)((0,r.Z)({},n.taskTemplate||{}),{workflowTags:n.tags,formSubmission:n.formSubmission||null}),emailTemplate:(0,r.Z)({},n.emailTemplate||{})})}}).loading,B=(0,i.Z)((0,h.D)(eI,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(e){var t,n,o,r,i;a.show({content:"Workflow was created"}),g(null===(i=null===(t=e.createTaskWorkflow)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:null===(r=o.insert_Workflow)||void 0===r?void 0:r.returning[0])||void 0===i?void 0:i.id)}}),2),J=B[0],X=B[1].loading;(0,u.useEffect)(function(){m&&d(!0)},[m]),(0,u.useEffect)(function(){s&&n()},[s,n]);var Y,K,ee=(0,i.Z)((0,h.D)(eO,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was created"}),n()}}),2),et=ee[0],en=ee[1].loading,eo=(0,i.Z)((0,h.D)(eP,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was updated"}),n()}}),2),er=eo[0],ei=eo[1].loading,ea=(0,i.Z)((0,h.D)(eR,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was updated"}),n()}}),2),el=ea[0],es=ea[1].loading,eu=(0,i.Z)((0,h.D)(eD,{onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Email was sent"})}}),2),ed=eu[0],ev=eu[1].loading,em=(Y=(0,j.Z)(function(e){var n,o,i,a,l;return(0,T.__generator)(this,function(s){switch(s.label){case 0:if(t)return[3,6];switch(n=e.action){case"createTask":return[3,1];case"sendEmail":return[3,3]}return[3,4];case 1:return o=eK(e),[4,J({variables:{data:o}})];case 2:return s.sent(),[3,5];case 3:return i=e0(e),et({variables:{data:i}}),[3,5];case 4:return[3,5];case 5:return[3,7];case 6:switch(e.action){case"createTask":a=e1(e),er({variables:{data:(0,C.Z)((0,r.Z)({},a),{workflowId:t})}}),d(!0);break;case"sendEmail":l=e2(e),el({variables:{data:(0,C.Z)((0,r.Z)({},l),{workflowId:t})}})}s.label=7;case 7:return[2]}})}),function(e){return Y.apply(this,arguments)}),eh=(K=(0,j.Z)(function(e){var t;return(0,T.__generator)(this,function(n){return t=e4(e),ed({variables:{data:t}}),[2]})}),function(e){return K.apply(this,arguments)}),eg=W("trigger.type"),eb=W("action");return(0,o.jsxs)(o.Fragment,{children:[($||X||en||ei||es||ev)&&(0,o.jsx)(P.Z,{sx:{zIndex:1e5},open:!0,children:(0,o.jsx)(R.Z,{color:"secondary"})}),(0,o.jsx)("form",{onSubmit:q(y?eh:em),children:(0,o.jsx)(e6,{children:(0,o.jsxs)(v.Z,{height:"100%",width:"100%",spacing:2,children:[(0,o.jsx)(D.Z,{sx:{pl:1,pr:1},children:(0,o.jsxs)(k.ZP,{container:!0,columnSpacing:2,children:[(0,o.jsx)(k.ZP,{item:!0,xs:9,children:(0,o.jsx)(_.Qr,{name:"title",control:M,render:function(e){var t,n=e.value,r=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Title",value:n,onChange:r,error:N.title,helperText:null===(t=N.title)||void 0===t?void 0:t.message,InputLabelProps:{shrink:""!==n&&void 0!==n}})}})}),(0,o.jsx)(k.ZP,{item:!0,xs:3,children:(0,o.jsx)(_.Qr,{name:"status",control:M,render:function(e){var t,n=e.value,r=e.onChange;return(0,o.jsx)(L.P,{formControl:{variant:"standard",color:"secondary",error:N.status,helperText:null===(t=N.status)||void 0===t?void 0:t.message},selectProps:{fullWidth:!0},label:"Status",value:n,onChange:r,options:G})}})})]})}),(0,o.jsxs)(k.ZP,{container:!0,sx:{height:"100%",overflow:"auto",p:1},children:[(0,o.jsxs)(k.ZP,{item:!0,xs:5.5,children:[(0,o.jsx)(e7,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,o.jsx)(I.Z,{src:"/static/logo/icon-white.png"}),(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(f.Z,{variant:"h6",sx:{lineHeight:1},children:"When"}),(0,o.jsx)(f.Z,{sx:{color:"#757575"},children:"This happens"})]})]})}),(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(ex,{control:M,errors:N,watch:W,setValue:A,reset:F,remove:H}),V.map(function(e,t){return(0,o.jsxs)("div",{children:[(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(ey,{index:t,field:e,control:M,errors:N,watch:W,remove:H})]},e.id)}),(0,o.jsxs)(v.Z,{width:"100%",heigth:"100%",children:[(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(e3,{disabled:!eg,onClick:function(){return z({type:null,value:null})},children:(0,o.jsx)(E.Z,{sx:{alignSelf:"center"}})})]})]}),(0,o.jsx)(k.ZP,{item:!0,xs:1,children:(0,o.jsx)(e9,{orientation:"vertical",children:(0,o.jsx)(e8,{children:(0,o.jsx)(Q.Z,{})})})}),(0,o.jsxs)(k.ZP,{item:!0,xs:5.5,children:[(0,o.jsx)(e7,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,o.jsxs)(v.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,o.jsx)(I.Z,{src:"/static/logo/icon-white.png"}),(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(f.Z,{variant:"h6",sx:{lineHeight:1},children:"Then"}),(0,o.jsx)(f.Z,{sx:{color:"#757575"},children:"Do the following"})]})]})}),(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(ez,{control:M,errors:N,watch:W}),"createTask"===eb&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eG,{orientation:"vertical",variant:"middle"}),(0,o.jsx)(e7,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,o.jsx)(ec,{workflowId:t,register:O,watch:W,setValue:A,control:M,errors:N,isSubmit:s,createdWorkflowId:m})})]}),"sendEmail"===eb&&(0,o.jsx)(eJ,{workflowId:t,register:O,watch:W,setValue:A,control:M,errors:N,sendTestEmail:function(){Z(!0)}})]})]}),(0,o.jsxs)(v.Z,{width:"100%",direction:"row",justifyContent:"center",spacing:2,children:[(0,o.jsx)(c.Z,{variant:"outlined",color:"black",size:"medium",onClick:n,children:"Cancel"}),(0,o.jsx)(c.Z,{variant:"contained",color:"secondary",size:"medium",type:"submit",onClick:function(){Z(!1)},children:t?"Update":"Create"})]})]})})})]})};e5.defaultProps={close:function(){}},e5.propTypes={workflowId:l().number,close:l().func};var e6=(0,q.ZP)(p.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"90vw",height:"90vh",padding:"35px 27px 16px 27px",borderRadius:"8px"}}),e9=(0,q.ZP)(w.Z)(function(){return{display:"flex",alignItems:"center"}}),e8=(0,q.ZP)("div")(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"50px",height:"50px",borderRadius:"50%",border:"1px solid #949494","& .MuiSvgIcon-root":{width:"70%",height:"70%",fill:"#949494"}}}),e3=(0,q.ZP)(O.Z)(function(){return{alignSelf:"center",display:"flex",alignItems:"center",justifyContent:"center",width:"25px",height:"25px",borderRadius:"4px",padding:0,boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)","&.Mui-disabled":{cursor:"not-allowed",pointerEvents:"unset"},"& .MuiSvgIcon-root":{width:"100%",height:"100%",fill:"#949494"}}}),e7=(0,q.ZP)(p.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),te=n(11994),tt=n(59938),tn=n(57179),to=function(e){var t=e.open,n=e.close,a=e.initialFilters,l=e.setFilters,s=(0,i.Z)((0,tt.X)("form_data_".concat(a.filterType),a),2),u=s[0],d=s[1],p=(0,_.cI)({defaultValues:u}),f=p.control,m=p.handleSubmit,x=p.reset,h=p.getValues,g=function(e){try{var t,o,i={q:e.search?"%".concat(e.search,"%"):null,status:e.status,tags:(null===(t=e.tags)||void 0===t?void 0:t.length)>0?null===(o=e.tags)||void 0===o?void 0:o.map(function(e){return e.value}):null},a=h();l(function(e){return(0,r.Z)({},e,i)}),d(function(e){return(0,r.Z)({},e,a)})}finally{n()}},b=function(){l(a),x(a),d(a),n()};return(0,o.jsx)(te.Z,{open:t,onClose:n,keepMounted:!0,children:(0,o.jsx)("form",{onSubmit:m(g),children:(0,o.jsx)(ti,{children:(0,o.jsxs)(k.ZP,{container:!0,rowGap:4,columnSpacing:4,children:[(0,o.jsx)(k.ZP,{item:!0,xs:12,children:(0,o.jsx)(_.Qr,{control:f,name:"search",render:function(e){var t=e.value,n=e.onChange;return(0,o.jsx)(S.Z,{fullWidth:!0,label:"Title",variant:"standard",color:"secondary",value:t,onChange:n})}})}),(0,o.jsx)(k.ZP,{item:!0,xs:12,xs2:6,children:(0,o.jsx)(_.Qr,{control:f,name:"status",render:function(e){var t=e.value,n=e.onChange;return(0,o.jsx)(L.P,{label:"Status",value:t,onChange:n,options:tr,formControl:{fullWidth:!0,variant:"standard",color:"secondary"},selectProps:{fullWidth:!0}})}})}),(0,o.jsx)(k.ZP,{item:!0,xs:12,xs2:6,children:(0,o.jsx)(tn.r,{control:f})}),(0,o.jsx)(k.ZP,{container:!0,item:!0,xs:12,children:(0,o.jsxs)(v.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,children:[(0,o.jsx)(c.Z,{variant:"contained",color:"danger",onClick:b,children:"Cancel"}),(0,o.jsx)(c.Z,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})})]})})})})};to.propTypes={open:l().bool,close:l().func,initialFilters:l().object,setFilters:l().func};var tr=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],ti=(0,q.ZP)(p.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"100vw",maxWidth:"600px",maxHeight:"100vh",padding:"16px",borderRadius:"8px",overflow:"auto"}}),ta=n(87918),tl=function(e){var t=e.conditions,n=(0,u.useMemo)(function(){return t.find(function(e){return e.isTrigger})},[t]),r=(0,u.useMemo)(function(){return t.filter(function(e){return!e.isTrigger})},[t]),i=(0,u.useCallback)(function(e){var t=e.trigger,n=(B.find(function(e){return e.value===t.type})||{label:""}).label;switch(t.type){case"jobStatusChanges":case"quoteStatusChanges":var o=J[t.type].find(function(e){return e.value===t.from}),r=J[t.type].find(function(e){return e.value===t.to});return"When ".concat(n.toLowerCase()," from ").concat(o.text," to ").concat(r.text);case"dateIs":var i=K.find(function(e){return e.value===t.frequency}),a=ee.find(function(e){return e.value===t.daysIn}),l=et.find(function(e){return e.value===t.inThePeriod});return"When ".concat(n.toLowerCase(),"\n        ").concat(i.label.toLowerCase(),"\n        ").concat(a.label.toLowerCase()," in\n        ").concat(l.label.toLowerCase())}},[]),a=(0,u.useCallback)(function(e){var t=e.type;return(Y.find(function(e){return e.value===t.value})||{label:""}).label},[]);return(0,o.jsxs)(o.Fragment,{children:[!!n&&(0,o.jsx)(ta.Z,{label:"".concat(i(n)),sx:{mr:1}}),r.map(function(e){return(0,o.jsx)(ta.Z,{label:"".concat(a(e.condition)," ").concat(e.condition.value.label),sx:{mr:1}})})]})};tl.defaultProps={conditions:[]},tl.propTypes={conditions:l().array};var ts=n(66137),tu=function(e){var t=e.initialFilters,n=e.containerHeight,a=e.tableHeight,l=(0,i.Z)((0,b.d)(),2),j=l[0],C=l[1],T=(0,eL.D)(),w=(0,u.useState)(!1),k=w[0],S=w[1],q=(0,u.useState)((0,r.Z)({},t)),I=q[0],O=q[1],P=(0,s.x)({filters:I}),R=P.initialData,D=P.ref,L=(0,ts.Y)(R.tags,"Workflow"),_=(0,x.aM)(eU({tagsWhere:L}),{variables:R}),Q=_.data,E=void 0===Q?{workflows:[],meta:{aggregate:{totalCount:0}}}:Q,W=E.workflows,F=E.meta,M=_.loading,N=_.refetch,U=(0,i.Z)((0,h.D)(eV,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){T.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){T.show({content:"Workflow was deleted"}),close()}}),1)[0],V=(0,u.useCallback)(function(e){var t=e.workflowId;C({content:function(e){var n=e.onClose;return(0,o.jsx)(e5,{workflowId:t,close:n})}})},[C]),z=(0,u.useCallback)(function(e){return[{icon:"edit",onClick:function(t){t.stopPropagation(),V({workflowId:e.id})},tooltip:"Edit"},{icon:"delete",onClick:function(t){t.stopPropagation(),U({variables:{workflowId:e.id}})},tooltip:"Delete"}]},[U,V]),H=(0,u.useMemo)(function(){return[{flex:1,field:"title",headerName:"Title"},{sortable:!1,flex:1,field:"conditions",headerName:"Trigger",renderCell:function(e){var t=e.row;return(0,o.jsx)(tl,{conditions:t.conditions})}},{sortable:!1,flex:1,field:"tags",headerName:"Tags",renderCell:function(e){var t=e.row;return"sendEmail"!==t.action?(0,o.jsx)(Z.K,{row:t,entity:"Workflow",refetchQueries:["GetWorkflows"]}):null}},{flex:1,field:"fired",headerName:"Fired"},{flex:1,field:"createdBy",headerName:"Created by",sortName:'{"User": {"fullName": "ORDER"}}'},{flex:1,field:"createdAt",headerName:"Created at"},{flex:1,field:"status",headerName:"Status"},{width:50,field:"actions",headerName:"Actions",sortable:!1,renderCell:function(e){var t=e.row;return(0,o.jsx)(m.C,{row:t,actionsData:z})}}]},[z]),$=(0,u.useMemo)(function(){return W.map(function(e){return{id:e.id,title:e.title,conditions:e.conditions,tags:e.tags,fired:e.fired,createdBy:e.user.fullName,createdAt:A()(e.createdAt).format("YYYY-MM-DD"),status:e.status,action:e.action}})},[W]),G=function(e){e.stopPropagation(),C({content:function(e){var t=e.onClose;return(0,o.jsx)(e5,{close:t})}})};return(0,o.jsxs)(o.Fragment,{children:[j,(0,o.jsx)(to,{open:k,close:function(){return S(!1)},initialFilters:t,filters:I,setFilters:O}),(0,o.jsxs)(v.Z,{width:"100%",spacing:2,children:[(0,o.jsxs)(v.Z,{direction:"row",justifyContent:"space-between",children:[(0,o.jsx)(c.Z,{variant:"contained",startIcon:(0,o.jsx)(y.Z,{}),onClick:function(){return S(!0)},children:"Filters"}),(0,o.jsx)(c.Z,{variant:"contained",color:"secondary",onClick:G,children:"Add Automation"})]}),(0,o.jsxs)(p.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:n},children:[!!(null==$?void 0:$.length)&&(0,o.jsx)(v.Z,{direction:"row",justifyContent:"space-between",children:(0,o.jsx)(f.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:"Automation"})}),(null==$?void 0:$.length)?(0,o.jsx)(d.i,{autoHeight:!1,loading:M,ref:D,columns:H,rows:$,meta:F,refetch:N,onRowClick:function(e){return V({workflowId:e.row.id})},containerHeight:a}):!M&&(0,o.jsx)(g.C,{imageSrc:"/static/icons/no_automations_found.svg",title:"Create your first automation",subtitleFirstLine:"Task automations help you stay on top of work;\n              streamline your workflow",subtitleSecondLine:"processes and integrate with other apps\n              for increased productivity.",buttonText:"Add Automation",onAction:G})]})]})]})};tu.defaultProps={initialFilters:{},containerHeight:"calc(100vh - 86px)",tableHeight:"calc(100% - 32px)"},tu.propTypes={initialFilters:l().object,containerHeight:l().string,tableHeight:l().string};var td=n(58849),tc=n(18586),tp=n(11163),tv=n.n(tp),tf=function(){var e,t,n=(0,tc.q)();return(null==n?void 0:null===(e=n.admin)||void 0===e?void 0:null===(t=e.modules)||void 0===t?void 0:t.workflows)?(0,o.jsx)(tu,{initialFilters:{filterType:"workflow_table"}}):(tv().push("/404"),null)};tf.getLayout=function(e){return(0,o.jsx)(td.Z,{children:e})};var tm=tf},82670:function(e,t,n){"use strict";function o(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}n.d(t,{Z:function(){return o}})}},function(e){e.O(0,[3662,630,2283,212,8890,619,2583,4135,8579,6043,1838,4244,3911,1417,3776,2329,8500,778,4046,1023,7454,1870,2797,1047,8062,6313,597,3754,1050,4030,8849,6733,7554,6096,9774,2888,179],function(){return e(e.s=29325)}),_N_E=e.O()}]);