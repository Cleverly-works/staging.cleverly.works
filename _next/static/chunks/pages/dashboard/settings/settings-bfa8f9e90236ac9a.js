(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8734],{8119:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/settings/settings",function(){return t(10997)}])},16879:function(e,n,t){"use strict";t.d(n,{r:function(){return r}});var o=t(22091).ZP.getAllTimezones(),i=Object.keys(o).map(function(e){return o[e]}),r=function(){return i.map(function(e){return{label:"".concat(e.name," ").concat(e.utcOffsetStr),value:e.name}})}},8052:function(e,n,t){"use strict";t.d(n,{y:function(){return R}});var o=t(26042),i=t(85893),r=t(45697),c=t(68956),a=t(26186),u=t(16551),s=t(77439),d=t(11585),l=t(8500),m=t(47568),f=t(69396),v=t(828),h=t(97582),p=t(50319),x=t(7297),Z=t(75063);function g(){var e=(0,x.Z)(["\n  mutation AddBankAccount($objects: [BankAccount_insert_input!]!) {\n    insert_BankAccount(objects: $objects) {\n      returning {\n        id\n        stripeId\n        accountNumber\n        routingNumber\n        bic\n        iban\n        status\n        createdAt\n      }\n    }\n  }\n"]);return g=function(){return e},e}function j(){var e=(0,x.Z)(["\n  mutation UpdateBankAccount($id: Int!, $changes: BankAccount_set_input) {\n    update_BankAccount_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return j=function(){return e},e}var b=(0,Z.Ps)(g()),I=(0,Z.Ps)(j()),y=t(42283),S=t(79665),_=t(76600),w=t(49501),k=t(55563),C=t(58594),q=t(74231),T=(0,q.Ry)().shape({bank:(0,q.Z_)().required(),accountNumber:(0,q.Z_)().required(),bic:(0,q.Z_)().required(),iban:(0,q.Z_)().required(),routingNumber:(0,q.Z_)().required()}),A=function(e){var n,t=e.accountId,r=e.data,c=e.refetch,a=e.toggleShow,u=(0,y.cI)({defaultValues:r,resolver:(0,S.S)(T)}),s=u.errors,d=u.handleSubmit,l=u.register,x=(0,v.Z)((0,p.D)(b,{onCompleted:function(){c()}}),1)[0],Z=(0,v.Z)((0,p.D)(I,{onCompleted:function(){c()}}),1)[0],g=(n=(0,m.Z)(function(e){var n;return(0,h.__generator)(this,function(i){switch(i.label){case 0:if((n=(0,o.Z)({},e)).stripeId="ba_42g2s45sh46jl46h",n.accountId=t,n.status="active",n.countryId=1,n.currencyId=1,n.meta={showInInvoice:Boolean(n.showInInvoice)},delete n.showInInvoice,!(null==r?void 0:r.id))return[3,1];return Z({variables:{id:r.id,changes:n}}),[3,3];case 1:return[4,x({variables:{objects:[n]}})];case 2:i.sent(),i.label=3;case 3:return a(),[2]}})}),function(e){return n.apply(this,arguments)}),j={errors:s,register:l};return(0,i.jsxs)(_.Z,{id:"offCanvasForm",handleSubmit:d(g),children:[(0,i.jsx)(w.Z,{label:"Bank name",children:(0,i.jsx)(k.Z,(0,f.Z)((0,o.Z)({},j),{name:"bank"}))}),(0,i.jsx)(w.Z,{label:"Account number",children:(0,i.jsx)(k.Z,(0,f.Z)((0,o.Z)({},j),{name:"accountNumber"}))}),(0,i.jsx)(w.Z,{label:"Routing number",children:(0,i.jsx)(k.Z,(0,f.Z)((0,o.Z)({},j),{name:"routingNumber"}))}),(0,i.jsx)(w.Z,{label:"BIC",children:(0,i.jsx)(k.Z,(0,f.Z)((0,o.Z)({},j),{name:"bic"}))}),(0,i.jsx)(w.Z,{label:"IBAN",children:(0,i.jsx)(k.Z,(0,f.Z)((0,o.Z)({},j),{name:"iban"}))}),(0,i.jsx)(C.Z,(0,f.Z)((0,o.Z)({},j),{data:[{id:"1",label:"Show in invoice",value:"true"}],name:"showInInvoice"}))]})};A.propTypes={accountId:r.number,toggleShow:r.func,updateRows:r.func};var P=t(64872),R=function(e){var n=e.accountId,t=e.data,r=e.edit,m=e.refetch,f=(0,P.a)(),v=[{hidden:!0},{text:"Bank"},{text:"Account number"},{text:"Routing"},{text:"BIC"},{text:"IBAN"},{text:"Stripe ID",hidden:!0},{text:"Date Added"},{formatter:function(e){return!0===e.row.showInInvoice?"True":"False"},text:"Show In Invoice"},{formatter:c.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(e,n){return x(e,n)},tooltip:"Edit"}],text:"Actions"}],h=function(e){var n,t;return{id:e.id,bank:null==e?void 0:e.bank,accountNumber:null==e?void 0:e.accountNumber,routingNumber:null==e?void 0:e.routingNumber,bic:null==e?void 0:e.bic,iban:null==e?void 0:e.iban,stripeId:e.stripeId,date:(0,a.Z)(e.createdAt),showInInvoice:null!==(n=e.meta)&&void 0!==n&&!!n.showInInvoice&&(null===(t=e.meta)||void 0===t?void 0:t.showInInvoice),actions:""}},p=function(e){e.stopPropagation(),f.show({content:(0,i.jsx)(A,{accountId:n,refetch:m,toggleShow:f.close}),title:"Add Bank Account"})},x=function(e,t){e.stopPropagation(),f.show({content:(0,i.jsx)(A,{accountId:n,data:(0,o.Z)({},t)||{},refetch:m,toggleShow:f.close}),title:"Add Bank Account"})},Z=function(){return(0,i.jsx)(u.Z,{children:(0,i.jsx)(s.Z,{context:"secondary",content:"Add",onClick:p,size:"sm"})})};return(0,i.jsx)(d.Z,{open:!0,title:"Bank Accounts",toolbar:r&&(0,i.jsx)(Z,{}),children:(0,i.jsx)(l.Z,{columns:v,rows:t.map(function(e){return h(e)})})})};R.propTypes={data:r.array},R.defaultProps={data:[],edit:!0}},2056:function(e,n,t){"use strict";t.d(n,{i:function(){return p}});var o=t(47568),i=t(828),r=t(97582),c=t(85893),a=t(45697),u=t(93645),s=t(50319),d=t(75327),l=t(77439),m=t(26042),f=t(69396),v=t(29815),h=function(e,n){var t=Object.values(e.integration.google).filter(function(e){return e.profile.email!==n});return Object.assign({},e,{integration:(0,f.Z)((0,m.Z)({},e.integration),{google:(0,v.Z)(t)})})},p=function(e){var n,t,a=e.credentials,m=a.id,f=a.type,v=e.isLoggedIn,p=e.refetch,x=e.meta,Z=e.email,g=(0,i.Z)((0,s.D)(d.a8,{onCompleted:p}),1)[0],j=(0,i.Z)((0,s.D)(d.$E,{onCompleted:p}),1)[0],b=(0,i.Z)((0,s.D)(d.uz,{onCompleted:p}),1)[0],I=(n=(0,o.Z)(function(e){return(0,r.__generator)(this,function(n){switch(n.label){case 0:if(!e.code)return[3,4];if("admin"!==f)return[3,2];return[4,g({variables:{code:e.code,id:m,type:f}})];case 1:return n.sent(),[3,4];case 2:return[4,g({variables:{code:e.code,id:m,type:f}})];case 3:n.sent(),n.label=4;case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),y=(t=(0,o.Z)(function(){var e;return(0,r.__generator)(this,function(n){switch(n.label){case 0:switch(e=h(x,Z),f){case"admin":return[3,1];case"user":return[3,3]}return[3,5];case 1:return[4,j({variables:{accountId:m,set:{meta:e}}})];case 2:case 4:return n.sent(),[3,6];case 3:return[4,b({variables:{userId:m,meta:e}})];case 5:return[3,6];case 6:return[2]}})}),function(){return t.apply(this,arguments)}),S=function(e){};return v?(0,c.jsx)(u.GoogleLogout,{clientId:"69900974658-9rikek80a7b20gcigfeo3fv0r3qilqtp.apps.googleusercontent.com",onLogoutSuccess:y,onFailure:S,render:function(e){return(0,c.jsx)(l.Z,{context:"secondary",content:"Sign Out",onClick:e.onClick,size:"sm"})}}):(0,c.jsx)(u.GoogleLogin,{accessType:"offline",prompt:"select_account",clientId:"69900974658-9rikek80a7b20gcigfeo3fv0r3qilqtp.apps.googleusercontent.com",isSignedIn:!0,onSuccess:I,onFailure:I,render:function(e){return(0,c.jsx)(l.Z,{context:"secondary",content:"Sign In",onClick:e.onClick,size:"sm"})},responseType:"code",scope:"https://mail.google.com"})};p.propTypes={credentials:a.object.isRequired,isLoggedIn:a.bool,refetch:a.func.isRequired}},27474:function(e,n,t){"use strict";t.d(n,{e:function(){return f}});var o=t(47568),i=t(828),r=t(97582),c=t(85893),a=t(45697),u=t(50319),s=t(75327),d=t(77439),l=function(e){var n=e.signOutHandler;return(0,c.jsx)(d.Z,{context:"secondary",content:"Sign Out",onClick:n,size:"sm"})},m=function(e){var n=e.handleLogin;return(0,c.jsx)(d.Z,{context:"secondary",content:"Sign In",onClick:n,size:"sm"})},f=function(e){var n,t,a=e.credentials,d=a.id,f=a.type,v=e.isLoggedIn,h=e.refetch,p=e.email,x=(0,i.Z)((0,u.D)(s.r1),1)[0],Z=(0,i.Z)((0,u.D)(s.MT,{onCompleted:h}),1)[0],g=(n=(0,o.Z)(function(){var e,n,t,o;return(0,r.__generator)(this,function(i){switch(i.label){case 0:return e=function(e){var n=e.url,t=e.title,o=e.w,i=e.h,r=void 0!==window.screenLeft?window.screenLeft:window.screenX,c=void 0!==window.screenTop?window.screenTop:window.screenY,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,u=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=a/window.screen.availWidth,d=window.open(n,t,"\n\n        width=".concat(o/s,",\n        height=").concat(i/s,",\n        top=").concat((u-i)/2/s+c,",\n        left=").concat((a-o)/2/s+r,"\n        "));window.focus&&d.focus()},[4,x({variables:{id:d,type:f}})];case 1:if((n=i.sent()).error)return[2,console.error("Error:",n.error)];return(o=(null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.genenrateMSURL).url)&&e({url:o,title:"microsoft",h:690,w:650}),[2]}})}),function(){return n.apply(this,arguments)}),j=(t=(0,o.Z)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:return[4,Z({variables:{id:d,type:f,email:p}})];case 1:return e.sent(),[2]}})}),function(){return t.apply(this,arguments)});return v?(0,c.jsx)(l,{signOutHandler:j}):(0,c.jsx)(m,{handleLogin:g})};f.propTypes={credentials:a.object.isRequired,isLoggedIn:a.bool,refetch:a.func.isRequired}},10997:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return nZ}});var o=t(85893),i=t(6388),r=t(7297),c=t(75063);function a(){var e=(0,r.Z)(["\n  mutation UpdateAccount($accountId: Int!, $account: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $account) {\n      id\n    }\n  }\n"]);return a=function(){return e},e}function u(){var e=(0,r.Z)(['\n  query GetFinanceSetting($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      addresses: Addresses(where: { entity: { _eq: "Account" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        createdAt\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n          }\n        }\n      }\n      id\n      media: Media(\n        where: { entity: { _eq: "Account" }, Medium: { category: { _eq: "emailLogo" } } }\n        limit: 1\n        order_by: { createdAt: desc }\n      ) {\n        id\n        item: Medium {\n          id\n          filename\n        }\n      }\n      bankAccounts: BankAccounts {\n        id\n        bank\n        stripeId\n        accountNumber\n        routingNumber\n        bic\n        iban\n        status\n        default\n        createdAt\n        meta\n      }\n      meta\n      customerPpmInvoicing\n    }\n  }\n']);return u=function(){return e},e}var s=(0,c.Ps)(a()),d=(0,c.Ps)(u()),l=t(16551),m=t(77439),f=t(9270),v=t(62140),h=t(11585),p=t(1306),x=t(36641),Z=t(8052),g=t(85113),j=t(45697),b=t(10367),I=t(34953),y=t(51466),S=t(65414),_=t(27474),w=t(2056),k=t(11163),C=t(5616),q=t(41255),T=function(e){var n=e.credentials.id,t=e.isLoggedIn,i=e.refetch,r=(0,k.useRouter)().query,c=(0,q.BR)({adminId:n,xeroClientId:r.clientId||null,onSaveXeroTokenCallback:function(e){return i()}}),a=c.tokenStatus,u=c.onCallRefreshToken,s=c.onCallAuthorize,d=function(){(0,q.bE)(n,{auth_status:"disconnected",token:null},!0),i()};if(!t)return(0,o.jsx)(m.Z,{context:"secondary",content:"Sign In",onClick:function(){return s()},size:"sm"});var l="expired"===a?u:s;return(0,o.jsxs)(C.Z,{sx:{display:"flex",flexDirection:"row"},children:[(0,o.jsx)(m.Z,{context:"secondary",content:"authorized"!==a?"Token Expired. Click to refresh":"Connected",disabled:"authorized"===a,onClick:function(){return l()},size:"sm",style:{marginRight:"10px"}}),(0,o.jsx)(m.Z,{context:"secondary",content:"Sign Out",onClick:d,size:"sm"})]})};T.propTypes={credentials:j.object,isLoggedIn:j.bool,refetch:j.func.isRequired};var A=t(67294),P=t(78289),R=t(26042),N=t(69396),E=t(828),z=t(76600),D=t(49501),$=t(55563),L=t(50319);function M(){var e=(0,r.Z)(["\n  mutation SetSageUrl($accountId: Int!, $meta: jsonb!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: { meta: $meta }) {\n      id\n    }\n  }\n"]);return M=function(){return e},e}var B=(0,c.Ps)(M()),F=t(42283),H=t(79665),O=t(74231),V=function(e){var n,t=e.account,i=e.onSuccess,r=(0,A.useState)(""),c=r[0],a=r[1],u=(0,F.cI)({defaultValues:{url:null===(n=t.meta)||void 0===n?void 0:n.sageUrl},resolver:(0,H.S)((0,O.Ry)().shape({url:(0,O.Z_)().url().required()}))}),s=u.control,d=u.errors,l=u.handleSubmit,m=u.register,f=(0,E.Z)((0,L.D)(B,{onCompleted:i,onError:function(e){a(e.message)}}),1)[0],v=function(e){var n=e.url,o=(0,R.Z)({},t.meta)||{};o.sageUrl=n||"",f({variables:{accountId:t.id,meta:o}})};return(0,o.jsxs)(z.Z,{handleSubmit:l(v),children:[(0,o.jsx)(D.Z,{label:"Sage Url",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},{control:s,errors:d,register:m}),{name:"url"}))}),(0,o.jsx)(y.Z,{context:"danger",children:c})]})};V.propTypes={values:j.object,onSuccess:j.func.isRequired};var U=function(e){var n=e.account,t=e.refetch,i=function(){r.close(),t()},r=(0,A.useContext)(P.Z),c=function(e){r.show({content:(0,o.jsx)(V,{account:n,onSuccess:i}),submit:!0,title:"Sage Middleware URL"})};return(0,o.jsx)(m.Z,{context:"secondary",content:"Settings",onClick:c,size:"sm"})};U.propTypes={account:j.object.isRequired,refetch:j.func.isRequired};var G=t(75327);function Q(e){var n,t,o,r,c,a,u,s,d,l=(0,i.aM)(G.nE,{variables:{id:e}}),m=l.loading,f=l.data,v=l.refetch,h=null==f?void 0:null===(n=f.account)||void 0===n?void 0:n.meta,p={google:[],microsoft:[],sage:!1,xero:{clientId:null,auth_status:"unauthenticated",companyId:null,token:null}};return m||(p={google:(null==h?void 0:null===(t=h.integration)||void 0===t?void 0:null===(o=t.google)||void 0===o?void 0:o.length)>0&&Object.values(null==h?void 0:null===(r=h.integration)||void 0===r?void 0:r.google)||[],microsoft:(null==h?void 0:null===(c=h.integration)||void 0===c?void 0:null===(a=c.microsoft)||void 0===a?void 0:a.length)>0&&Object.values(null==h?void 0:null===(u=h.integration)||void 0===u?void 0:u.microsoft)||[],xero:(null==h?void 0:null===(s=h.integration)||void 0===s?void 0:s.xero)||{authorization_code:null,auth_status:"unauthenticated",companyId:null,token:null},sage:!!((null==h?void 0:null===(d=h.modules)||void 0===d?void 0:d.sageIntegration)&&h.modules.sageIntegration.length>0)}),{loading:m,integration:p,refetch:v}}Q.propTypes={accountId:j.number.isRequired};var X=t(63139);function W(){var e=(0,r.Z)(["\n  margin-bottom: 7px;\n"]);return W=function(){return e},e}var J=function(e){var n,t=e.account,i=e.user,r=Q(t.id),c=r.integration,a=r.refetch,u=(0,X.s)();return(0,o.jsxs)(h.Z,{fitParentHeight:!0,open:!0,title:"Integrations",children:[(0,o.jsxs)(f.Z,{align:"center",children:[(0,o.jsx)(v.Z,{md:2,children:(0,o.jsx)(I.Z,{alt:"Microsoft Outlook",src:"/static/logo/Microsoft_Outlook-Logo.svg"})}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(y.Z,{content:"Microsoft Outlook"}),(0,o.jsx)(y.Z,{content:"Add new account integrate with your corporate Outlook mail",size:"sm"})]}),(0,o.jsx)(v.Z,{md:4,children:(0,o.jsx)(_.e,{credentials:{id:t.id,type:"admin"},isLoggedIn:!1,refetch:a})})]}),(0,o.jsxs)(f.Z,{align:"center",children:[(0,o.jsx)(v.Z,{md:2,children:(0,o.jsx)(I.Z,{alt:"Gmail",src:"/static/logo/Gmail-logo.svg"})}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(y.Z,{content:"Gmail"}),(0,o.jsx)(y.Z,{content:"Add new account integrate with your corporate Gmail ",size:"sm"})]}),(0,o.jsx)(v.Z,{md:4,children:(0,o.jsx)(w.i,{credentials:{id:t.id,type:"admin"},isLoggedIn:!1,refetch:a,meta:t.meta})})]}),!u&&(0,o.jsxs)(f.Z,{align:"center",children:[(0,o.jsx)(v.Z,{md:2,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,o.jsx)(I.Z,{style:{width:"50%",height:"50%"},alt:"Xero",src:"/static/logo/xero-logo.png"})}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(y.Z,{content:"Xero"}),(0,o.jsx)(y.Z,{content:"Add new account integrate with your corporate Xero ",size:"sm"})]}),(0,o.jsx)(v.Z,{md:4,children:(0,o.jsx)(T,{credentials:{id:i.id,type:"admin"},isLoggedIn:!!(null===(n=(0,q.RM)(i.id))||void 0===n?void 0:n.companyId),refetch:a})})]}),c.microsoft.map(function(e){var n=e.profile,i=n.name,r=n.email,c=n.picture;return(0,o.jsxs)(Y,{align:"center",children:[(0,o.jsx)(v.Z,{md:2,style:{display:"flex",justifyContent:"center"},children:c?(0,o.jsx)(S.Z,{context:"primary",size:"sm",src:c}):(0,o.jsx)(S.Z,{context:"primary",size:"sm",content:i})}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(y.Z,{content:r}),(0,o.jsx)(y.Z,{content:i,size:"sm"})]}),(0,o.jsx)(v.Z,{md:4,children:(0,o.jsx)(_.e,{credentials:{id:t.id,type:"admin"},isLoggedIn:!0,refetch:a,email:r})})]})}),c.google.map(function(e){var n=e.profile,i=n.name,r=n.email,c=n.picture;return(0,o.jsxs)(Y,{children:[(0,o.jsx)(v.Z,{md:2,style:{display:"flex",justifyContent:"center"},children:c?(0,o.jsx)(S.Z,{context:"primary",size:"sm",src:c}):(0,o.jsx)(S.Z,{context:"primary",size:"sm",content:i})}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(y.Z,{content:r}),(0,o.jsx)(y.Z,{content:i,size:"sm"})]}),(0,o.jsx)(v.Z,{md:4,children:(0,o.jsx)(w.i,{credentials:{id:t.id,type:"admin"},isLoggedIn:!0,refetch:a,meta:t.meta,email:r})})]})}),c.sage&&(0,o.jsxs)(f.Z,{align:"center",children:[(0,o.jsx)(v.Z,{md:2,children:(0,o.jsx)(I.Z,{alt:"Sage",src:"/static/logo/Sage-Logo.svg"})}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(y.Z,{content:"Sage"}),(0,o.jsx)(y.Z,{content:"Set your sage-middle ware URL",size:"sm"})]}),(0,o.jsx)(v.Z,{md:4,children:(0,o.jsx)(U,{account:t,refetch:a})})]})]})},Y=(0,b.ZP)(f.Z).withConfig({displayName:"admin__StyledRowList",componentId:"sc-6de10354-0"})(W());function K(){var e=(0,r.Z)(["\n  mutation UpdateAccount($accountId: Int!, $account: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $account) {\n      id\n    }\n  }\n"]);return K=function(){return e},e}J.propTypes={account:j.object.isRequired,user:j.object.isRequired};var ee=(0,c.Ps)(K()),en=t(68956),et=t(74297),eo=t(8500),ei=t(47568),er=t(97582),ec=(0,O.Ry)().shape({from:(0,O.Z_)().required().matches("^([0-1][0-9]|[2][0-3]):([0-5][0-9])$"),to:(0,O.Z_)().required().matches("^([0-1][0-9]|[2][0-3]):([0-5][0-9])$")}),ea=function(e){e.accountId;var n=e.defaultValues,t=e.onSubmit;e.refetch;var i,r=(0,F.cI)({defaultValues:(0,R.Z)({},n),resolver:(0,H.S)(ec)}),c=r.control,a=r.errors,u=r.handleSubmit,s=r.register,d=(i=(0,ei.Z)(function(e){var o,i;return(0,er.__generator)(this,function(i){return o=n.id,t((0,R.Z)({id:o},e)||{}),[2]})}),function(e){return i.apply(this,arguments)}),l={control:c,errors:a,register:s};return(0,o.jsxs)(z.Z,{id:"offCanvasForm",handleSubmit:u(d),children:[(0,o.jsx)(D.Z,{label:"Name",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},l),{name:"name",readOnly:!0}))}),(0,o.jsx)(D.Z,{label:"From",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},l),{name:"from"}))}),(0,o.jsx)(D.Z,{label:"To",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},l),{name:"to"}))})]})};ea.propTypes={accountId:j.number,defaultValues:j.object,onSubmit:j.func,refetch:j.func};var eu=t(64872),es=function(e){var n,t=e.accountId,i=e.meta,r=e.refetch,c=(0,eu.a)(),a=(null==i?void 0:i.timeSegment)||[{id:1,name:"Normal",from:"08:00",to:"18:00"},{id:2,name:"OOH",from:"18:00",to:"22:00"},{id:3,name:"Premium",from:"22:00",to:"08:00"}],u=(0,E.Z)((0,L.D)(ee,{onCompleted:function(){r&&r(),c.close()}}),1)[0],s=function(e){var n=(0,R.Z)({},e)||{};c.show({content:(0,o.jsx)(ea,{accountId:t,defaultValues:n,onSubmit:d,refetch:r}),title:"Edit Time Segment"})},d=function(e){var n={};n.meta=(0,R.Z)({},i)||{};var o=a.map(function(n){return n.id===e.id?e:(0,R.Z)({},n)});n.meta.timeSegment=o,u({variables:{accountId:t,account:n}})},l=[{hidden:!0},{text:"Name"},{text:"From"},{text:"To"},{formatter:en.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:(n={editClick:function(e,n){return s(n)}}).editClick,tooltip:"Edit"}],text:"Actions"}];return(0,o.jsx)(h.Z,{open:!0,title:"Time Segments",children:(0,o.jsx)(eo.Z,{columns:l,rows:a.map(function(e){return{id:e.id,name:(0,et.Z)(e.name),from:e.from,to:e.to,actions:""}})})})};es.propTypes={accountId:j.number,meta:j.object,refetch:j.func};var ed=t(86036),el=t(15214);function em(){var e=(0,r.Z)(["\n  mutation UpdateAccount($accountId: Int!, $account: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $account) {\n      id\n    }\n  }\n"]);return em=function(){return e},e}var ef=(0,c.Ps)(em()),ev=t(84043),eh=t(16879),ep=(0,O.Ry)().shape({timeZone:(0,O.Ry)().shape({label:(0,O.Z_)().required(),value:(0,O.Z_)().required()})}),ex=function(e){var n,t=e.account,i=e.onSubmit,r=null==t?void 0:null===(n=t.meta)||void 0===n?void 0:n.timeZone,c={};c.timeZone=r||{value:"Europe/London",label:"Europe/London +00:00"};var a,u=(0,F.cI)({defaultValues:c,resolver:(0,H.S)(ep)}),s=u.control,d=u.errors,l=u.handleSubmit,m=u.register,f=(0,E.Z)((0,L.D)(ef,{onCompleted:function(e){i()}}),1)[0],v=(a=(0,ei.Z)(function(e){var n;return(0,er.__generator)(this,function(o){return(n=(0,R.Z)({},t.meta)||{}).timeZone=(0,R.Z)({},e.timeZone),f({variables:{accountId:t.id,account:{meta:n}}}),[2]})}),function(e){return a.apply(this,arguments)});return(0,o.jsx)(z.Z,{id:"offCanvasForm",handleSubmit:l(v),children:(0,o.jsx)(ev.Z,(0,N.Z)((0,R.Z)({options:(0,eh.r)()},{control:s,errors:d,register:m}),{name:"timeZone"}))})};ex.propTypes={account:j.object,onSubmit:j.func};var eZ=function(e){var n,t,i=e.account,r=e.refetch,c=(0,eu.a)(),a=null==i?void 0:null===(n=i.meta)||void 0===n?void 0:null===(t=n.timeZone)||void 0===t?void 0:t.label,u=function(e){c.close(),r()},s=function(e){e.stopPropagation(),c.show({content:(0,o.jsx)(ex,{account:i,onSubmit:u}),title:"Set Time Zone"})},d=function(){return(0,o.jsx)(l.Z,{children:(0,o.jsx)(m.Z,{context:"secondary",content:a?"Edit":"Add",onClick:s,size:"sm"})})};return(0,o.jsxs)(h.Z,{open:!0,toolbar:(0,o.jsx)(d,{}),title:"Set Time Zone",children:[a&&(0,o.jsx)(ed.Z,{content:"Time Zone:",text:a}),!a&&(0,o.jsx)(el.Z,{content:"You should set your time zone"})]})};function eg(){var e=(0,r.Z)(['\n  query GetInvoiceStart($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      id\n      meta\n      invoiceStart\n      media: Media(\n        where: { entity: { _eq: "Account" }, Medium: { category: { _eq: "invoiceLogo" } } }\n        limit: 1\n        order_by: { createdAt: desc }\n      ) {\n        id\n        item: Medium {\n          id\n          filename\n        }\n      }\n    }\n  }\n']);return eg=function(){return e},e}function ej(){var e=(0,r.Z)(["\n  mutation UpdateAccount($accountId: Int!, $account: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $account) {\n      id\n    }\n  }\n"]);return ej=function(){return e},e}eZ.propTypes={account:j.object,refetch:j.func};var eb=(0,c.Ps)(eg()),eI=(0,c.Ps)(ej()),ey=t(55377),eS=t(55843),e_=t(76256),ew=(0,O.Ry)().shape({invoiceStart:(0,O.Rx)().when("$hasInvoiceStart",{is:!0,then:(0,O.Rx)().positive("Must be more than 0").integer("Must be more than 0")}),contactPhoneNumber:(0,O.Z_)().required(),invoiceDueDate:(0,O.Rx)().required()}),ek=function(e){var n,t=e.account,i=e.accountId,r=e.refetch,c=(0,eu.a)(),a=!!t.invoiceStart,u=(0,F.cI)({defaultValues:(0,N.Z)((0,R.Z)({},t.meta.finance),{invoiceStart:t.invoiceStart||1}),context:{hasInvoiceStart:a},resolver:(0,H.S)(ew)}),s=u.errors,d=u.handleSubmit,l=u.register,m=(0,E.Z)((0,L.D)(eI,{onCompleted:function(e){r(),c.close()}}),1)[0],f={errors:s,register:l},v=function(e){var n=(0,R.Z)({},t.meta)||{};n.finance=(0,N.Z)((0,R.Z)({},n.finance),{contactPhoneNumber:e.contactPhoneNumber,invoiceDueDate:e.invoiceDueDate}),m({variables:{accountId:i,account:{meta:n,invoiceStart:e.invoiceStart}}})};return(0,o.jsxs)(z.Z,{id:"offCanvasForm",handleSubmit:d(v),children:[(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"checkInvoiceStart",value:!0,type:"hidden"})),!a&&(0,o.jsxs)(D.Z,{label:"Invoice Start #",children:[(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"invoiceStart"})),(null===(n=s.invoiceStart)||void 0===n?void 0:n.message)||""]}),(0,o.jsx)(D.Z,{label:"Contact Phone Number",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"contactPhoneNumber"}))}),(0,o.jsx)(D.Z,{label:"Invoice Due Date",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"invoiceDueDate"}))})]})};ek.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var eC=t(2845),eq=function(){var e,n,t,r,c=(0,eu.a)(),a=(0,eC.x)().user,u=(0,i.aM)(eb,{skip:!a.accountId,variables:{id:a.accountId}}),s=u.data,d=(void 0===s?{account:[]}:s).account,l=u.loading,f=u.refetch,v=d.invoiceStart,p=null===(e=d.meta)||void 0===e?void 0:null===(n=e.finance)||void 0===n?void 0:n.contactPhoneNumber,x=null===(t=d.meta)||void 0===t?void 0:null===(r=t.finance)||void 0===r?void 0:r.invoiceDueDate,Z=function(e){e.stopPropagation(),c.show({content:(0,o.jsx)(ek,{accountId:a.accountId,account:d,refetch:f}),title:"Invoice Settings"})},g=function(e){f(),c.close()},j=function(){c.show({content:(0,o.jsx)(e_.z,{accept:"image/*",category:"invoiceLogo",entity:"Account",entityId:a.accountId,expiryShow:!1,onSuccess:g,type:"image"}),title:"Invoice logo"})},b=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:Z,size:"sm"})};return!l&&(0,o.jsxs)(h.Z,{fitParentHeight:!0,open:!0,title:"Invoice Settings",toolbar:(0,o.jsx)(b,{}),children:[!!v&&(0,o.jsx)(el.Z,{context:"success",content:"An invoice start has already been locked in so cannot be edited"}),(0,o.jsx)(ed.Z,{content:"Invoice start #",text:v||1}),(0,o.jsx)(ed.Z,{content:"Contact Phone Number",text:p||"-"}),(0,o.jsx)(ed.Z,{content:"Invoice Due Date",text:x||"-"}),(0,o.jsx)(ey.Z,{}),(0,o.jsx)(y.Z,{children:"Invoice logo"}),d.media&&d.media[0]&&(0,o.jsx)(I.Z,{alt:"Invoice logo",src:"".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(d.media[0].item.filename),width:200}),(0,o.jsx)(eS.Z,{marginTop:"sm"}),(0,o.jsx)(m.Z,{context:"secondary",content:"Manage logo",onClick:j,size:"sm"})]})},eT=(0,O.Ry)().shape({contactEmail:(0,O.Z_)().email().required(),replyToEmail:(0,O.Z_)().email().required(),replyToName:(0,O.Z_)().required(),contactAddress:(0,O.Z_)().required()}),eA=function(e){var n,t,i=e.account,r=e.accountId,c=e.handleSuccess,a=null==i?void 0:null===(n=i.meta)||void 0===n?void 0:n.emailSettings,u=(0,F.cI)({defaultValues:(0,R.Z)({},a),resolver:(0,H.S)(eT)}),d=u.control,l=u.errors,m=u.handleSubmit,f={control:d,errors:l,register:u.register},v=(0,E.Z)((0,L.D)(s,{onCompleted:function(){c()}}),1)[0],h=(t=(0,ei.Z)(function(e){var n;return(0,er.__generator)(this,function(t){return(n=(0,R.Z)({},i.meta)||{}).emailSettings=(0,R.Z)({},e),v({variables:{accountId:r,account:{meta:n}}}),[2]})}),function(e){return t.apply(this,arguments)});return(0,o.jsxs)(z.Z,{id:"offCanvasForm",handleSubmit:m(h),children:[(0,o.jsx)(D.Z,{label:"Contact Email",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"contactEmail"}))}),(0,o.jsx)(D.Z,{label:"Reply To Email",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"replyToEmail"}))}),(0,o.jsx)(D.Z,{label:"Reply To Name",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"replyToName"}))}),(0,o.jsx)(D.Z,{label:"Contact Address",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"contactAddress"}))})]})};eA.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,handleSuccess:j.func.isRequired};var eP=function(e){var n,t,i,r,c,a,u,s=e.account,d=e.accountId,l=e.refetch,f=null==s?void 0:null===(n=s.meta)||void 0===n?void 0:n.emailSettings,v=(0,eu.a)(),p=function(e){e.stopPropagation(),v.show({content:(0,o.jsx)(eA,{account:s,accountId:d,handleSuccess:x}),title:"Email Settings"})},x=function(e){l(),v.close()},Z=function(){v.show({content:(0,o.jsx)(e_.z,{accept:"image/*",category:"emailLogo",entity:"Account",entityId:d,expiryShow:!1,onSuccess:x,type:"image"}),title:"Invoice logo"})},g=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:p,size:"sm"})};return(0,o.jsxs)(h.Z,{fitParentHeight:!0,open:!0,title:"Email Settings",toolbar:(0,o.jsx)(g,{}),children:[(0,o.jsx)(ed.Z,{content:"Contact Email",text:null!==(r=null==f?void 0:f.contactEmail)&&void 0!==r?r:"-"}),(0,o.jsx)(ed.Z,{content:"Reply To Email",text:null!==(c=null==f?void 0:f.replyToEmail)&&void 0!==c?c:"-"}),(0,o.jsx)(ed.Z,{content:"Reply To Name",text:null!==(a=null==f?void 0:f.replyToName)&&void 0!==a?a:"-"}),(0,o.jsx)(ed.Z,{content:"Contact Address",text:null!==(u=null==f?void 0:f.contactAddress)&&void 0!==u?u:"-"}),(0,o.jsx)(ey.Z,{}),(0,o.jsx)(y.Z,{children:"Email Logo"}),(0,o.jsx)(ed.Z,{content:"Important!",text:"To use the uploaded email logo, please open the relevant emails on the Events page and click the Submit button."}),(0,o.jsx)(I.Z,{alt:"Email Logo",src:"".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(null===(t=s.media[0])||void 0===t?void 0:null===(i=t.item)||void 0===i?void 0:i.filename),onError:function(e){return e.target.src="https://i.ibb.co/JdhCmnT/Cleverly-logo-black.png"},width:200}),(0,o.jsx)(eS.Z,{marginTop:"sm"}),(0,o.jsx)(m.Z,{context:"secondary",content:"Manage logo",onClick:Z,size:"sm"})]})};function eR(){var e=(0,r.Z)(['\n  query GetInvoiceStart($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      id\n      meta\n      media: Media(\n        where: {\n          entity: { _eq: "Account" }\n          Medium: { category: { _in: ["themeLogo", "themeFavicon"] } }\n        }\n        order_by: { createdAt: desc }\n      ) {\n        id\n        item: Medium {\n          id\n          filename\n          category\n        }\n      }\n    }\n  }\n']);return eR=function(){return e},e}function eN(){var e=(0,r.Z)(["\n  mutation UpdateAccount($accountId: Int!, $account: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $account) {\n      id\n      meta\n    }\n  }\n"]);return eN=function(){return e},e}eP.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var eE=(0,c.Ps)(eR()),ez=(0,c.Ps)(eN()),eD=t(18586),e$=t(6167);function eL(){var e=(0,r.Z)(["\n  align-items: center;\n  display: flex;\n  margin-top: 3px;\n  margin-bottom: 5px;\n"]);return eL=function(){return e},e}function eM(){var e=(0,r.Z)(["\n  background-color: ",";\n  border: 1px solid #ddd;\n  height: 1rem;\n  margin-right: 0.25rem;\n  width: 1rem;\n"]);return eM=function(){return e},e}var eB=[{title:"Navbar",value:"NAVBAR",items:[{title:"Background",value:"background"},{title:"Top border",value:"borderTopColor"},{title:"Active colour",value:"colourActive"},{title:"Caret hover colour",value:"caretColourHover"},{title:"Dropdown active",value:"dropdownActive"},{title:"Dropdown background",value:"dropdownBackground"},{title:"Dropdown hover background",value:"dropdownBackgroundHover"},{title:"Dropdown colour",value:"dropdownColour"},{title:"Dropdown hover colour",value:"dropdownColourHover"},{title:"Overlay background",value:"backgroundOverlay"},{title:"Toggler",value:"colourToggler"},{title:"Link color",value:"colourDefault"},{title:"Desktop link color",value:"colourDefaultDesktop"},{title:"List item background",value:"backgroundHoverListItem"}]}],eF=b.ZP.div.withConfig({displayName:"helpers__StyledField",componentId:"sc-77566459-0"})(eL()),eH=b.ZP.div.withConfig({displayName:"helpers__StyledColour",componentId:"sc-77566459-1"})(eM(),function(e){return e.color}),eO=t(29815),eV=t(82492),eU=t.n(eV),eG=t(55651),eQ=t(16765),eX=t(62675),eW=t(33006),eJ=function(e){var n,t,i,r=e.account,c=e.handleSuccess,a=(0,e$.Z)(),u=a.theme,s=a.setTheme,d=(0,eX.Z)(),l=d.config,m=d.setConfig,p=(0,E.Z)((0,L.D)(ez,{onCompleted:function(){},update:function(e,n){var t=n.data,o=(0,N.Z)((0,R.Z)({},t.update_Account_by_pk),{media:(0,eO.Z)(r.media)}),i={id:r.id};e.writeQuery({query:eE,variables:i,data:{account:o}})}}),1)[0],x={pageTitle:null==r?void 0:null===(n=r.meta)||void 0===n?void 0:null===(t=n.config)||void 0===t?void 0:null===(i=t.Brand)||void 0===i?void 0:i.name};eB.forEach(function(e){x[e.value]={},e.items.forEach(function(n){x[e.value][n.value]=(0,eQ.Vi)(u[e.value][n.value]).toHex()})});var Z,g=(0,F.cI)({defaultValues:(0,R.Z)({},x)}),j=g.control,b=g.errors,I=g.setValue,y=g.handleSubmit,S=g.register,_=g.watch,w=(Z=(0,ei.Z)(function(e){var n,t;return(0,er.__generator)(this,function(o){switch(o.label){case 0:return(n=(0,R.Z)({},null==r?void 0:r.meta)||{}).themeSettings=(0,R.Z)({},e),(t=(0,R.Z)({},null==n?void 0:n.config)).Brand=(0,R.Z)({},null==t?void 0:t.Brand),t.Brand.name=e.pageTitle,n.config=t,s((0,R.Z)({},e)),[4,p({variables:{accountId:r.id,account:{meta:n}}})];case 1:return o.sent(),m((0,R.Z)({},eU()(l,t))),c(),[2]}})}),function(e){return Z.apply(this,arguments)}),k={control:j,errors:b,register:S};return(0,o.jsxs)(z.Z,{id:"offCanvasForm",handleSubmit:y(w),children:[(0,o.jsx)(D.Z,{label:"Page Title",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},k),{name:"pageTitle",placeholder:"Page Title"}))}),eB.map(function(e){return(0,o.jsxs)("div",{children:[(0,o.jsx)(eW.Z,{tag:"h3",content:e.title}),(0,o.jsx)("div",{children:e.items.map(function(n){var t=e.value+"."+n.value,i=(0,eQ.Vi)(_(t)).toHex(),r=(0,o.jsxs)(eF,{children:[(0,o.jsx)(eH,{color:i})," ",n.title]});return(0,o.jsxs)(h.Z,{context:"white",title:r,children:[(0,o.jsx)(f.Z,{children:(0,o.jsx)(v.Z,{md:3,children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},k),{name:t}))})}),(0,o.jsx)(eS.Z,{}),(0,o.jsx)(eG.gW,{color:i,onChange:function(e){return I(t,e)}})]})})}),(0,o.jsx)(eS.Z,{})]})})]})};function eY(){var e=(0,r.Z)(["\n  background-color: rgb(0, 55, 83);\n"]);return eY=function(){return e},e}function eK(){var e=(0,r.Z)(["\n  position: relative;\n  .favicon {\n    position: absolute;\n    top: 20%;\n    left: 23%;\n  }\n"]);return eK=function(){return e},e}var e0=function(){var e=(0,eC.x)().user,n=(0,e$.Z)().theme,t=(0,eu.a)(),r=(0,eD.q)().refetchSettings,c=(0,i.aM)(eE,{variables:{id:e.accountId}}),a=c.data,u=(void 0===a?{account:[]}:a).account,s=c.loading,d=c.refetch,l=function(){r(),d(),t.close()},f=function(){t.show({content:(0,o.jsx)(e_.z,{accept:"image/*",category:"themeLogo",entity:"Account",entityId:e.accountId,expiryShow:!1,onSuccess:l,type:"image"}),title:"Theme logo"})},v=function(){t.show({content:(0,o.jsx)(e_.z,{accept:"image/*",category:"themeFavicon",entity:"Account",entityId:e.accountId,expiryShow:!1,onSuccess:l,type:"image"}),title:"Theme favicon"})},p=function(e){e.stopPropagation(),t.show({content:(0,o.jsx)(eJ,{account:u,handleSuccess:t.close}),title:"Theme"})},x=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:p,size:"sm"})},Z=function(){var e,n,t,i=null==u?void 0:null===(e=u.meta)||void 0===e?void 0:null===(n=e.config)||void 0===n?void 0:null===(t=n.Brand)||void 0===t?void 0:t.name,r="black";return i&&""!==i||(i="No Title",r="initial"),(0,o.jsx)(y.Z,{content:i,context:r,tag:"h6"})},g="",j="";if((null==u?void 0:null===(b=u.media)||void 0===b?void 0:b.length)>0){var b,S,_,w,k,C=(null===(w=null==u?void 0:u.media[0])||void 0===w?void 0:null===(k=w.item)||void 0===k?void 0:k.category)==="themeFavicon";g=!!C&&(null==u?void 0:u.media[0]),j=!C&&(null==u?void 0:u.media[0]),g?j=null==u?void 0:u.media.find(function(e){return"themeLogo"===e.item.category}):g=null==u?void 0:u.media.find(function(e){return"themeFavicon"===e.item.category})}return!s&&(0,o.jsxs)(h.Z,{fitParentHeight:!0,open:!0,title:"Theme Settings",toolbar:(0,o.jsx)(x,{}),children:[(0,o.jsx)(D.Z,{label:"Page Title",children:(0,o.jsx)(Z,{})}),eB.map(function(e){return(0,o.jsxs)("div",{children:[(0,o.jsxs)(y.Z,{children:[e.title," "]}),(0,o.jsx)("div",{children:e.items.map(function(t){return(0,o.jsxs)(eF,{children:[(0,o.jsx)(eH,{color:n[e.value][t.value]})," ",t.title]},t.value)})}),(0,o.jsx)(eS.Z,{})]},e.value)}),(0,o.jsx)(y.Z,{children:"Theme logo"}),u.media[0]&&(0,o.jsx)(e1,{children:(0,o.jsx)(I.Z,{alt:"Theme logo",src:"".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(null==j?void 0:null===(S=j.item)||void 0===S?void 0:S.filename),onError:function(e){return e.target.src="/static/logo/icon-white.png"},width:200})}),(0,o.jsx)(eS.Z,{marginTop:"sm"}),(0,o.jsx)(m.Z,{context:"secondary",content:"Manage logo",onClick:f,size:"sm"}),(0,o.jsx)(eS.Z,{marginTop:"sm"}),(0,o.jsx)(y.Z,{children:"Theme favicon"}),u.media[0]&&(0,o.jsxs)(e2,{children:[(0,o.jsx)(I.Z,{alt:"Theme logo",src:"/static/favicon/tab.svg",width:"100%"}),(0,o.jsx)(I.Z,{className:"favicon",alt:"Theme favicon",src:"".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(null==g?void 0:null===(_=g.item)||void 0===_?void 0:_.filename),onError:function(e){return e.target.src="/static/favicon/CleverlyLogoBlack.png"},width:30})]}),(0,o.jsx)(eS.Z,{marginTop:"sm"}),(0,o.jsx)(m.Z,{context:"secondary",content:"Manage favicon",onClick:v,size:"sm"}),(0,o.jsx)(eS.Z,{marginTop:"sm"})]})},e1=b.ZP.div.withConfig({displayName:"module__StyledContainer",componentId:"sc-34838f1c-0"})(eY()),e2=b.ZP.div.withConfig({displayName:"module__StyledFavContainer",componentId:"sc-34838f1c-1"})(eK());function e5(){var e=(0,r.Z)(["\n  query GetJobSetting($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      id\n      meta\n      jobNumberStart\n      jobNumberPointer\n    }\n  }\n"]);return e5=function(){return e},e}function e6(){var e=(0,r.Z)(["\n  mutation UpdateAccount($accountId: Int!, $account: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $account) {\n      id\n    }\n  }\n"]);return e6=function(){return e},e}var e3=(0,c.Ps)(e5()),e4=(0,c.Ps)(e6()),e8=(0,O.Ry)().shape({jobNumberStart:(0,O.Rx)().when("$checkJobNumberStart",{is:!0,then:(0,O.Rx)().positive("Must be more than 0").integer("Must be more than 0")}),jobNumberPrefix:(0,O.Z_)(),jobNumberSuffix:(0,O.Z_)()}),e7=function(e){var n,t,i,r,c,a=e.account,u=e.accountId,s=e.refetch,d=!!a.jobNumberStart||!!a.jobNumberPointer,l=(0,A.useContext)(P.Z),m=(0,F.cI)({defaultValues:{jobNumberStart:a.jobNumberStart||1,jobNumberPrefix:null===(n=a.meta)||void 0===n?void 0:null===(t=n.job)||void 0===t?void 0:t.jobNumberPrefix,jobNumberSuffix:null===(i=a.meta)||void 0===i?void 0:null===(r=i.job)||void 0===r?void 0:r.jobNumberSuffix},context:{checkJobNumberStart:!d},resolver:(0,H.S)(e8)}),f=m.errors,v=m.handleSubmit,h=m.register,p=(0,E.Z)((0,L.D)(e4,{onCompleted:function(e){s(),l.close()}}),1)[0],x={errors:f,register:h},Z=function(e){return e.replace(/\s+|\u02DC|\u00A0 /g,"")},g=function(e){var n=(0,R.Z)({},a.meta)||{},t=e.jobNumberSuffix,o=e.jobNumberPrefix;t&&(e.jobNumberSuffix=Z(t)),o&&(e.jobNumberPrefix=Z(o)),n.job=(0,N.Z)((0,R.Z)({},n.job),{jobNumberSuffix:e.jobNumberSuffix,jobNumberPrefix:e.jobNumberPrefix}),p({variables:{accountId:u,account:{meta:n,jobNumberStart:e.jobNumberStart}}})};return(0,o.jsxs)(z.Z,{id:"offCanvasForm",handleSubmit:v(g),children:[!d&&(0,o.jsxs)(D.Z,{label:"Start works orders and quotes from number",children:[(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},x),{name:"jobNumberStart"})),(null===(c=f.jobNumberStart)||void 0===c?void 0:c.message)||""]}),(0,o.jsx)(D.Z,{label:"Prefix",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},x),{name:"jobNumberPrefix"}))}),(0,o.jsx)(D.Z,{label:"Suffix",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},x),{name:"jobNumberSuffix"}))})]})};e7.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var e9=function(){var e,n,t,r,c=(0,eu.a)(),a=(0,eC.x)().user,u=(0,i.aM)(e3,{variables:{id:a.accountId}}),s=u.data,d=(void 0===s?{account:[]}:s).account,l=u.loading,f=u.refetch,v=d.jobNumberStart,p=null===(e=d.meta)||void 0===e?void 0:null===(n=e.job)||void 0===n?void 0:n.jobNumberPrefix,x=null===(t=d.meta)||void 0===t?void 0:null===(r=t.job)||void 0===r?void 0:r.jobNumberSuffix,Z=function(e){e.stopPropagation(),c.show({content:(0,o.jsx)(e7,{accountId:a.accountId,account:d,refetch:f}),title:"Job and Quote settings"})},g=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:Z,size:"sm"})};return!l&&(0,o.jsxs)(h.Z,{fitParentHeight:!0,open:!0,title:"Job and Quote settings",toolbar:(0,o.jsx)(g,{}),children:[!!v&&(0,o.jsx)(el.Z,{context:"success",content:"The primary work order and quote numbering has been set and cannot be changed."}),(0,o.jsx)(ed.Z,{content:"Start works orders and quotes from number:",text:v||1}),(0,o.jsx)(ed.Z,{content:"Prefix:",text:p||"-"}),(0,o.jsx)(ed.Z,{content:"Suffix:",text:x||"-"})]})},ne=t(6710),nn=(0,O.Ry)().shape({terms:(0,O.Z_)().required()}),nt=function(e){var n,t,i=e.account,r=e.accountId,c=e.handleSuccess,a=null==i?void 0:null===(n=i.meta)||void 0===n?void 0:n.quote,u=(0,F.cI)({defaultValues:(0,R.Z)({},a),resolver:(0,H.S)(nn)}),d=u.control,l=u.errors,m=u.handleSubmit,f=u.register,v=(0,E.Z)((0,L.D)(s,{onCompleted:function(){c()}}),1)[0],h=(t=(0,ei.Z)(function(e){var n;return(0,er.__generator)(this,function(t){return(n=(0,R.Z)({},i.meta)||{}).quote=(0,R.Z)({},e),v({variables:{accountId:r,account:{meta:n}}}),[2]})}),function(e){return t.apply(this,arguments)});return(0,o.jsx)(z.Z,{id:"offCanvasForm",handleSubmit:m(h),children:(0,o.jsx)(D.Z,{label:"Quote Terms",children:(0,o.jsx)(ne.Z,(0,N.Z)((0,R.Z)({},{control:d,errors:l,register:f}),{name:"terms",rows:3}))})})};nt.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,handleSuccess:j.func.isRequired};var no=function(e){var n,t,i=e.account,r=e.accountId,c=e.refetch,a=null==i?void 0:null===(n=i.meta)||void 0===n?void 0:null===(t=n.quote)||void 0===t?void 0:t.terms,u=(0,eu.a)(),s=function(e){e.stopPropagation(),u.show({content:(0,o.jsx)(nt,{account:i,accountId:r,handleSuccess:d}),title:"Quote Terms"})},d=function(e){c(),u.close()},l=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:s,size:"sm"})};return(0,o.jsx)(h.Z,{fitParentHeight:!0,open:!0,title:"Quote Terms",toolbar:(0,o.jsx)(l,{}),children:(0,o.jsx)(ed.Z,{content:"Terms",text:null!=a?a:"-"})})};no.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var ni=(0,O.Ry)().shape({quote:(0,O.Rx)().required(),invoice:(0,O.Rx)().required()}),nr=function(e){var n,t,i=e.account,r=e.accountId,c=e.handleSuccess,a=null==i?void 0:null===(n=i.meta)||void 0===n?void 0:n.threshold,u=(0,F.cI)({defaultValues:(0,R.Z)({},a),resolver:(0,H.S)(ni)}),d=u.control,l=u.errors,m=u.handleSubmit,f={control:d,errors:l,register:u.register},v=(0,E.Z)((0,L.D)(s,{onCompleted:function(){c()}}),1)[0],h=(t=(0,ei.Z)(function(e){var n;return(0,er.__generator)(this,function(t){return(n=(0,R.Z)({},i.meta)||{}).threshold=(0,R.Z)({},e),v({variables:{accountId:r,account:{meta:n}}}),[2]})}),function(e){return t.apply(this,arguments)});return(0,o.jsxs)(z.Z,{id:"offCanvasForm",handleSubmit:m(h),children:[(0,o.jsx)(D.Z,{label:"Invoice",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"invoice"}))}),(0,o.jsx)(D.Z,{label:"Quote",children:(0,o.jsx)($.Z,(0,N.Z)((0,R.Z)({},f),{name:"quote"}))})]})};nr.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,handleSuccess:j.func.isRequired};var nc=function(e){var n,t,i,r=e.account,c=e.accountId,a=e.refetch,u=null==r?void 0:null===(n=r.meta)||void 0===n?void 0:n.threshold,s=(0,eu.a)(),d=function(e){e.stopPropagation(),s.show({content:(0,o.jsx)(nr,{account:r,accountId:c,handleSuccess:l}),title:"Threshold Limit"})},l=function(e){a(),s.close()},f=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:d,size:"sm"})};return(0,o.jsxs)(h.Z,{fitParentHeight:!0,open:!0,title:"Threshold Limit",toolbar:(0,o.jsx)(f,{}),children:[(0,o.jsx)(ed.Z,{content:"Invoice",text:null!==(t=null==u?void 0:u.invoice)&&void 0!==t?t:"-"}),(0,o.jsx)(ed.Z,{content:"Quote",text:null!==(i=null==u?void 0:u.quote)&&void 0!==i?i:"-"})]})};nc.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var na=function(e){var n,t=e.account,i=e.accountId,r=e.handleSuccess,c=e.supplierInstructions,a=(0,F.cI)({defaultValues:{terms:c}}),u=a.control,d=a.errors,l=a.handleSubmit,m=a.register,f=(0,E.Z)((0,L.D)(s,{onCompleted:function(){r()}}),1)[0],v=(n=(0,ei.Z)(function(e){var n;return(0,er.__generator)(this,function(o){return(n=(0,R.Z)({},t.meta)||{}).supplierInstructions=(0,R.Z)({},e),f({variables:{accountId:i,account:{meta:n}}}),[2]})}),function(e){return n.apply(this,arguments)});return(0,o.jsx)(z.Z,{id:"offCanvasForm",handleSubmit:l(v),children:(0,o.jsx)(D.Z,{label:"Supplier instructions",children:(0,o.jsx)(ne.Z,(0,N.Z)((0,R.Z)({},{control:u,errors:d,register:m}),{name:"terms",rows:3}))})})};na.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,handleSuccess:j.func.isRequired};var nu=function(e){var n,t,i=e.account,r=e.accountId,c=e.refetch,a=null==i?void 0:null===(n=i.meta)||void 0===n?void 0:null===(t=n.supplierInstructions)||void 0===t?void 0:t.terms,u=(0,eu.a)(),s=function(e){e.stopPropagation(),u.show({content:(0,o.jsx)(na,{supplierInstructions:a,account:i,accountId:r,handleSuccess:d}),title:"Supplier instructions"})},d=function(e){c(),u.close()},l=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:s,size:"sm"})};return(0,o.jsx)(h.Z,{fitParentHeight:!0,open:!0,title:"Supplier instructions",toolbar:(0,o.jsx)(l,{}),children:(0,o.jsx)(ed.Z,{content:"Supplier instructions",text:null!=a?a:"-"})})};nu.propTypes={account:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var ns=(0,O.Ry)().shape({customer:(0,O.Xg)().required()}),nd=t(69368),nl=t(50480),nm=t(51233),nf=function(e){var n,t=e.customerPpmInvoicing,i=e.accountId,r=e.handleSuccess,c=(0,F.cI)({defaultValues:{customer:t},resolver:(0,H.S)(ns)}),a=c.control,u=c.handleSubmit,d=(0,E.Z)((0,L.D)(s,{onCompleted:function(){r()}}),1)[0],l=(n=(0,ei.Z)(function(e){return(0,er.__generator)(this,function(n){return d({variables:{accountId:i,account:{customerPpmInvoicing:e.customer}}}),[2]})}),function(e){return n.apply(this,arguments)});return(0,o.jsx)("form",{id:"offCanvasForm",onSubmit:u(l),children:(0,o.jsx)(nm.Z,{children:(0,o.jsx)(F.Qr,{control:a,name:"customer",render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nl.Z,{control:(0,o.jsx)(nd.Z,{color:"secondary",checked:n,onChange:function(e,n){return t(n)}}),label:"Customer PPM Invoicing"})}})})})};nf.propTypes={customerPpmInvoicing:j.object.isRequired,accountId:j.number.isRequired,handleSuccess:j.func.isRequired};var nv=function(e){var n=e.customerPpmInvoicing,t=e.accountId,i=e.refetch,r=(0,eu.a)(),c=function(e){e.stopPropagation(),r.show({content:(0,o.jsx)(nf,{customerPpmInvoicing:n,accountId:t,handleSuccess:a}),title:"PPM Invoicing"})},a=function(e){i(),r.close()},u=function(){return(0,o.jsx)(m.Z,{content:"Edit",context:"secondary",onClick:c,size:"sm"})};return(0,o.jsx)(h.Z,{fitParentHeight:!0,open:!0,title:"PPM Invoicing",toolbar:(0,o.jsx)(u,{}),children:(0,o.jsx)(ed.Z,{content:"Customer PPM Invoicing ",text:n?"enabled":"disabled"})})};nv.propTypes={customerPpmInvoicing:j.object.isRequired,accountId:j.number.isRequired,refetch:j.func.isRequired};var nh=function(){var e=(0,eC.x)().user,n=(0,eu.a)(),t=(0,i.aM)(d,{variables:{id:e.accountId}}),r=t.data,c=(void 0===r?{account:{}}:r).account,a=t.loading,u=t.refetch,s=(0,g.WE)(c,"registered"),j=c.bankAccounts,b=function(e){e&&u(),n.close()},I=function(t){t.stopPropagation(),n.show({content:(0,o.jsx)(x.H,{addressId:null==s?void 0:s.address.id,entity:"Account",entityId:null==e?void 0:e.accountId,id:(null==s?void 0:s.id)||null,onSubmit:b,type:"registered"}),submit:!1,title:"Manage addresses"})},y=function(){return(0,o.jsx)(l.Z,{children:(0,o.jsx)(m.Z,{context:"secondary",content:"Add address",onClick:I,size:"sm"})})};return!a&&(0,o.jsxs)(f.Z,{children:[(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(eq,{}),(0,o.jsx)(e9,{}),(0,o.jsx)(e0,{}),!s&&(0,o.jsx)(h.Z,{toolbar:(0,o.jsx)(y,{}),button:"Add address",handleClick:I,open:!0,title:"Address"}),s&&(0,o.jsx)(p.f,{address:s.address,entity:"Account",entityId:c.id,id:s.id,refetch:u,title:"Registered Address",type:"registered",edit:!0}),(0,o.jsx)(J,{user:e,account:c})]}),(0,o.jsxs)(v.Z,{md:6,children:[(0,o.jsx)(Z.y,{edit:!0,accountId:c.id,data:j,refetch:u}),(0,o.jsx)(es,{edit:!0,accountId:c.id,meta:c.meta,refetch:u}),(0,o.jsx)(eZ,{account:c,refetch:u}),(0,o.jsx)(eP,{account:c,accountId:c.id,refetch:u}),(0,o.jsx)(no,{account:c,accountId:c.id,refetch:u}),(0,o.jsx)(nu,{account:c,accountId:c.id,refetch:u}),(0,o.jsx)(nc,{account:c,accountId:c.id,refetch:u}),(0,o.jsx)(nv,{customerPpmInvoicing:c.customerPpmInvoicing,accountId:c.id,refetch:u})]})]})},np=t(58849),nx=function(){return(0,o.jsx)(nh,{})};nx.getLayout=function(e){return(0,o.jsx)(np.Z,{children:e})};var nZ=nx}},function(e){e.O(0,[3662,367,2283,212,8890,619,2583,4135,8579,6043,1838,4244,3911,1417,3776,1564,3054,2329,8500,4046,7454,2797,1047,4043,3058,1144,7875,8849,8344,6733,7305,9774,2888,179],function(){return e(e.s=8119)}),_N_E=e.O()}]);