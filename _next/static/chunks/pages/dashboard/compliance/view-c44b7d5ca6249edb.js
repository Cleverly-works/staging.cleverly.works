(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4873],{78216:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/compliance/view",function(){return t(88728)}])},71225:function(n,e,t){"use strict";t.d(e,{Q:function(){return i}});var i=function(n){var e,t,i=n&&n.length>0&&n.find(function(n){var e;return(null===(e=n.medium)||void 0===e?void 0:e.category)==="avatar"});if(!i)return null;var o="".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(i.medium.filename),r=null==i?void 0:null===(e=i.medium)||void 0===e?void 0:null===(t=e.meta)||void 0===t?void 0:t.thumbnails;if(null==r?void 0:r.length){var a=r.find(function(n){return"small"===n.name});(null==a?void 0:a.relativePath)&&(o="".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(a.relativePath))}return o}},52475:function(n,e,t){"use strict";t.d(e,{z:function(){return I}});var i=t(47568),o=t(26042),r=t(69396),a=t(828),s=t(97582),c=t(85893),u=t(45697),d=t(50319),l=t(79434),m=t(42283),p=t(79665),f=t(76600),y=t(49501),x=t(55563),g=t(6710),v=t(58594),h=t(95103),b=t(2845),Z=t(21789),j=t(32749),_=t(74231),w=(0,_.Ry)().shape({name:(0,_.Z_)().required(),status:(0,_.Z_)().oneOf(["active","inactive"]).required(),complianceCategorySelected:(0,_.Ry)().required(),url:(0,_.Z_)().url()}),C=function(n){var e=n.form,t=n.id,i=n.user;return(e.categoryId=e.complianceCategorySelected.value,delete e.complianceCategorySelected,t)?{id:t,changes:e}:(e.adminId=i.accountId,{objects:[e]})},I=function(n){var e,t=n.defaultValues,u=n.onSuccess,_=(0,b.x)().user,I=(0,m.cI)({defaultValues:t,resolver:(0,p.S)(w)}),$=I.control,S=I.errors,q=I.handleSubmit,P=I.register,A=(0,a.Z)((0,d.D)(l.gO,{onCompleted:function(n){var e=n.insert_Compliance.returning[0].id;u&&u(e)}}),1)[0],T=(0,a.Z)((0,d.D)(l.Vd,{onCompleted:function(n){var e=n.update_Compliance_by_pk.id;u&&u(e)}}),1)[0],N=(e=(0,i.Z)(function(n){var e;return(0,s.__generator)(this,function(i){switch(i.label){case 0:if(e=C({form:n,id:t.id,user:_}),!t.id)return[3,2];return[4,T({variables:e})];case 1:return i.sent(),[3,4];case 2:return[4,A({variables:e})];case 3:i.sent(),i.label=4;case 4:return[2]}})}),function(n){return e.apply(this,arguments)}),k={control:$,errors:S,register:P};return(0,c.jsxs)(f.Z,{id:"offCanvasForm",handleSubmit:q(N),children:[(0,c.jsx)(y.Z,{label:"Name",children:(0,c.jsx)(x.Z,(0,r.Z)((0,o.Z)({},k),{name:"name"}))}),(0,c.jsx)(j.l,(0,r.Z)((0,o.Z)({},k),{label:"Category",name:"complianceCategorySelected",type:"complianceCategory"})),(0,c.jsx)(y.Z,{label:"Description",children:(0,c.jsx)(g.Z,(0,r.Z)((0,o.Z)({},k),{name:"description",rows:2}))}),(0,c.jsx)(y.Z,{label:"Governing Body",children:(0,c.jsx)(x.Z,(0,r.Z)((0,o.Z)({},k),{name:"governingBody"}))}),(0,c.jsx)(y.Z,{label:"Registration number example",children:(0,c.jsx)(x.Z,(0,r.Z)((0,o.Z)({},k),{name:"regNumExample"}))}),(0,c.jsx)(y.Z,{label:"URL",children:(0,c.jsx)(x.Z,(0,r.Z)((0,o.Z)({},k),{name:"url"}))}),(0,c.jsx)(v.Z,(0,r.Z)((0,o.Z)({},k),{data:[{id:"hasInsuranceAmount",label:"Has Insurance Amount Attached"}],name:"hasInsuranceAmount"})),(0,c.jsx)(v.Z,(0,r.Z)((0,o.Z)({},k),{data:[{id:"expectCertificate",label:"Expect Certificate"}],name:"expectCertificate"})),(0,c.jsx)(y.Z,{label:"Status",children:(0,c.jsx)(h.Z,(0,r.Z)((0,o.Z)({},k),{name:"status",options:Z.bg}))})]})};I.propTypes={defaultValues:u.object,onSuccess:u.func.isRequired}},79434:function(n,e,t){"use strict";t.d(e,{$i:function(){return u},G1:function(){return d},Vd:function(){return m},gO:function(){return l}});var i=t(7297),o=t(75063);function r(){var n=(0,i.Z)(["\n  query GetCompliace($id: Int!) {\n    compliance: Compliance_by_pk(id: $id) {\n      id\n      name\n      url\n      regNumExample\n      status\n      type\n      governingBody\n      hasInsuranceAmount\n      description\n      createdAt\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      Compliance_Entities {\n        Location {\n          id\n          name\n          status\n        }\n        Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]);return r=function(){return n},n}function a(){var n=(0,i.Z)(['\n  query GetCompliances(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Compliance_order_by!\n    $status: String\n    $type: String\n  ) {\n    compliance: Compliance(\n      limit: $limit\n      offset: $offset\n      where: { name: { _ilike: $q }, status: { _eq: $status }, type: { _eq: $type } }\n      order_by: [$orderBy]\n    ) {\n      id\n      name\n      description\n      status\n      regNumExample\n      hasInsuranceAmount\n      expectCertificate\n      url\n      governingBody\n      createdAt\n      category: Category {\n        id\n        name\n      }\n      questions: Taxonomies {\n        id\n      }\n      media: Media(where: { entity: { _eq: "Compliance" } }) {\n        mediaId\n      }\n    }\n    meta: Compliance_aggregate(\n      where: { name: { _ilike: $q }, status: { _eq: $status }, type: { _eq: $type } }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return a=function(){return n},n}function s(){var n=(0,i.Z)(["\n  mutation AddCompliance($objects: [Compliance_insert_input!]!) {\n    insert_Compliance(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return s=function(){return n},n}function c(){var n=(0,i.Z)(["\n  mutation UpdateCompliance($id: Int!, $changes: Compliance_set_input) {\n    update_Compliance_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return c=function(){return n},n}var u=(0,o.Ps)(r()),d=(0,o.Ps)(a()),l=(0,o.Ps)(s()),m=(0,o.Ps)(c())},35418:function(n,e,t){"use strict";t.d(e,{G:function(){return N}});var i=t(26042),o=t(69396),r=t(7297),a=t(85893),s=t(67294),c=t(45697),u=t(6388),d=t(52824),l=t(10367),m=t(78289),p=t(41564),f=t(34953),y=t(62466),x=t(68956),g=t(73373),v=t(11585),h=t(28733),b=t(55377),Z=t(16551),j=t(77439),_=t(74297),w=t(23892),C=t(39087),I=t(76256),$=t(75795),S=t(91272),q=t(20705),P=t(2845);function A(){var n=(0,r.Z)(["\n  width: 24px;\n"]);return A=function(){return n},n}function T(){var n=(0,r.Z)(["\n  border: 1px solid #eee;\n"]);return T=function(){return n},n}var N=function(n){var e=n.carousel,t=n.category,r=n.children,c=n.data,l=(n.details,n.entity),A=n.entityId,T=n.filters,N=(n.limit,n.listView),z=n.mediaMeta,R=n.onMediaAdd,M=n.onMediaRemove,G=(n.pagination,n.showActionButtons),D=n.showEntityColumn,B=n.showItemActions,H=n.summary,L=n.type,O=(0,q.x)({filters:T}),U=O.initialData,F=O.ref,V=(0,P.x)(),Q=V.hasRole,Y=V.user,W=(0,s.useContext)(m.Z),X=(0,u.aM)(d.t,{variables:(0,o.Z)((0,i.Z)({},U),{entity:l,entityId:A,category:t,adminId:Y.adminId,meta:z})}),J=X.data,K=void 0===J?{items:[],meta:{aggregate:{totalCount:0}}}:J,nn=K.items,ne=K.meta,nt=X.loading,ni=X.refetch,no=function(n){W.close(),c.length||ni(),R&&R(n)},nr=function(n){W.close(),c.length||ni(),M&&M(n)},na=function(n){n.stopPropagation(),W.show({content:(0,a.jsx)(I.z,{accept:"image/*",adminId:Y.adminId,category:t,entity:l,entityId:A,expiryShow:!1,mediaMeta:z,multiple:!0,onSuccess:no,type:"image"}),title:"Upload Photos"})},ns=function(n){n.stopPropagation(),W.show({content:(0,a.jsx)(I.z,{accept:".pdf, .doc, .docx, .xlsx",adminId:Y.adminId,category:t,entity:l,entityId:A,expiryShow:!1,mediaMeta:z,onSuccess:no,type:"document"}),title:"Upload Documents"})},nc=function(n){W.show({content:(0,a.jsx)(w.d,{mediaId:n.data.id,onSuccess:nr}),submit:!1,title:"Delete Media"})},nu=function(n){W.show({content:(0,a.jsx)(C.z,{media:n.data,toggleShow:W.close}),submit:!1,title:"Media Details",width:"50%"})},nd=[{context:"primary",icon:["fas","info-circle"],onClick:function(n,e){return nu(e)},tooltip:"Details"}];Q("admin")&&nd.push({context:"danger",icon:["fas","trash"],onClick:function(n,e){return nc(e)},tooltip:"Delete"});var nl=[{hidden:!0},{hidden:!0},{hidden:!0,text:"Caption"},{hidden:!1,text:"File"},{hidden:!D,text:"Entity"},{formatter:function(n){var e,t=n.row;return(0,a.jsx)(k,{children:(null==t?void 0:null===(e=t.authority)||void 0===e?void 0:e.adminOnly)&&(0,a.jsx)(p.Z,{content:"Admin user only",children:(0,a.jsx)(f.Z,{alt:"Admin Only",src:"/messaging/admin-only.svg"})})})},text:"",tooltip:"Only Admin can see"},{formatter:(0,y.Z)("/dashboard/users/view","userId","uploaded"),text:"Uploaded by"},{hidden:!N,text:"Thumbnails"},{hidden:!B,formatter:x.Z,formatterData:nd,text:"Actions"}],nm=function(n,e){n.preventDefault(),window.open("".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(e))},np=[],nf=nn.map(function(n){var e=n.entity,t=n.entityId,i=n.id,o=n.item,r=o.caption,s=o.filename,c=o.meta,u=o.name,d=o.type,l=o.user;return{data:o,id:i,userId:null==l?void 0:l.id,file:function(){return(0,a.jsx)(g.Z,{onClick:function(n){return nm(n,s)},children:r||u||s})},entity:e&&"".concat(e,"#").concat(t),authority:c,uploaded:"".concat(null==l?void 0:l.nameFirst," ").concat(null==l?void 0:l.nameLast),thumbnails:(0,$.S)(d,c),actions:""}}),ny=(nn.forEach(function(n){var e=n.item,t=e.caption,i=e.filename;"image"===e.type&&np.push({caption:t,filename:i})}),np),nx=ny.length;return(0,a.jsxs)(v.Z,{fitParentHeight:!0,open:!0,title:H,children:[r,e&&nx>0&&(0,a.jsx)(E,{children:(0,a.jsx)(h.Z,{fullWidth:!0,height:"200px",numberOfItems:1,showNavs:!1,showPagination:!0,slides:ny.map(function(n){var e=n.caption,t=n.filename;return{node:(0,a.jsx)(f.Z,{alt:e,src:"".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(t)}),text:" "}})})}),(0,a.jsx)(S.t,{columns:nl,loading:nt,fullHeight:!0,paginationSize:!1,meta:ne,ref:F,refetch:ni,rows:nf}),G&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{size:"sm"}),(0,a.jsxs)(Z.Z,{align:"flex-end",children:[(!L||"document"===L)&&!Q("supplier")&&(0,a.jsx)(j.Z,{content:"Add Document",context:"secondary",onClick:ns,size:"sm"}),(!L||"image"===L||"avatar"===L)&&!Q("supplier")&&(0,a.jsx)(j.Z,{content:"Add ".concat((0,_.Z)(L||"Image")),context:"secondary",onClick:na,size:"sm"})]})]})]})},k=l.ZP.div.withConfig({displayName:"table__StyledIcon",componentId:"sc-9d92024f-0"})(A()),E=l.ZP.div.withConfig({displayName:"table__StyledCarousel",componentId:"sc-9d92024f-1"})(T());N.propTypes={carousel:c.bool,category:c.string,children:c.node,data:c.array,details:c.bool,entity:c.string,entityId:c.number,filters:c.object,limit:c.number,listView:c.bool,mediaMeta:c.object,onMediaAdd:c.func,onMediaRemove:c.func,pagination:c.object,showActionButtons:c.bool,showEntityColumn:c.bool,showItemActions:c.bool,summary:c.string,type:c.string},N.defaultProps={carousel:!0,category:null,data:[],details:!1,filters:{},limit:20,listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,summary:"Media",type:null}},4380:function(n,e,t){"use strict";t.d(e,{g:function(){return O}});var i=t(7297),o=t(85893),r=t(67294),a=t(45697),s=t(10367),c=t(78289),u=t(74147),d=t(9270),l=t(62140),m=t(65414),p=t(55843),f=t(45481),y=t(97303),x=t(33006),g=t(40826),v=t(55171),h=t.n(v),b=t(6388),Z=t(75063);function j(){var n=(0,i.Z)(["\n  query GetLog($entityId: bigint!, $entityName: String!) {\n    activity: audit_Activity(\n      where: { _and: [{ entityid: { _eq: $entityId } }, { entity: { _eq: $entityName } }] }\n    ) {\n      eventId\n      userId\n      user: User {\n        fullName\n      }\n      sessionUserName\n      transactionStart\n      statementStart\n      applicationName\n      clientAddr\n      clientPort\n      action\n      changedFields\n    }\n  }\n"]);return j=function(){return n},n}var _=(0,Z.Ps)(j()),w=t(11585),C=t(26186),I=t(86036),$=t(49501),S={U:"Update",I:"Insert",D:"Delete"},q=function(n){var e=n.entityId,t=n.entityName,i=(0,b.aM)(_,{variables:{entityId:e,entityName:t}}),r=i.loading,a=i.data,s=(void 0===a?{activity:[]}:a).activity;return!r&&(0,o.jsx)(d.Z,{children:(0,o.jsx)(l.Z,{md:12,children:s.map(function(n){var e,t;return(0,o.jsxs)(w.Z,{title:"".concat((null===(e=n.user)||void 0===e?void 0:e.fullName)||"Backend"," - ").concat((0,C.Z)(n.transactionStart,!0)),children:[(0,o.jsx)(I.Z,{content:"Action:",text:S[t=n.action]||"-"}),(0,o.jsx)(p.Z,{}),(0,o.jsx)($.Z,{label:"Changed:",children:(0,o.jsx)(h(),{collapsed:!0,displayDataTypes:!1,src:n.changedFields||"-"})}),(0,o.jsx)(I.Z,{content:"Application:",text:n.applicationName||"-"})]},n.userId)})})})};q.propTypes={entityId:a.number.isRequired,entityName:a.string.isRequired};var P=t(35418),A=t(97768),T=t(45416),N=t(96216),k=t(2845),E=function(n){var e,t,i,r,a=n.job,s=n.numberPrefix,c=n.numberSuffix,u=(0,k.x)().hasRole;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I.Z,{content:"Type",text:(null===(e=A.x.find(function(n){return n.value===a.type}))||void 0===e?void 0:e.text)||"-"}),(0,o.jsx)(I.Z,{content:"Order",text:(0,o.jsx)(T.D,{id:a.id,number:a.number,invoiceNumber:null==a?void 0:null===(t=a.invoices)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.invoiceNumber,type:a.type,numberPrefix:s,numberSuffix:c,isQuote:a.quoted})}),u("admin")&&a.source&&(0,o.jsx)(I.Z,{content:"Source",text:null===(r=N.Y.find(function(n){return n.value===a.source}))||void 0===r?void 0:r.text})]})};function z(){var n=(0,i.Z)(["\n  background-color: #fff;\n  border: 1px solid #eee;\n  box-shadow: rgba(45, 62, 80, 0.12) 0 1px 5px 0;\n  margin-bottom: 0.5rem;\n  padding: 1rem 0;\n"]);return z=function(){return n},n}function R(){var n=(0,i.Z)(["\n  font-size: 1rem;\n  margin-top: 0.5rem;\n"]);return R=function(){return n},n}function M(){var n=(0,i.Z)(["\n  font-size: 0.9rem;\n  margin-top: 0.5rem;\n"]);return M=function(){return n},n}function G(){var n=(0,i.Z)(["\n  margin-bottom: 1rem;\n"]);return G=function(){return n},n}function D(){var n=(0,i.Z)(["\n  margin-right: 0.5rem;\n"]);return D=function(){return n},n}function B(){var n=(0,i.Z)(["\n  display: inline;\n"]);return B=function(){return n},n}function H(){var n=(0,i.Z)(["\n  display: flex;\n  justify-content: center;\n"]);return H=function(){return n},n}function L(){var n=(0,i.Z)(["\n  cursor: pointer;\n"]);return L=function(){return n},n}E.propTypes={job:a.object,numberPrefix:a.string,numberSuffix:a.string},E.defaultProps={numberPrefix:"",numberSuffix:""};var O=function(n){var e=n.avatar,t=n.editable,i=n.entity,a=n.entityName,s=n.icons,x=n.job,g=n.linkTitleTo,v=n.log,h=n.numberPrefix,b=n.numberSuffix,Z=n.prefix,j=(0,r.useContext)(c.Z),_=(0,r.useState)(e),w=_[0],C=_[1],I=function(n){j.close(),(null==n?void 0:n.filename)?C("".concat("https://cleverly-staging-media.s3.eu-west-2.amazonaws.com","/").concat(null==n?void 0:n.filename)):C(null)},$=function(){j.show({content:(0,o.jsx)(P.G,{category:"avatar",entity:a,entityId:null==i?void 0:i.id,filters:{category:"avatar"},limit:1,onMediaAdd:I,onMediaRemove:I,type:"image"}),title:"Avatar"})},S=function(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Y,{context:"primary",icon:"building"}),g?(0,o.jsx)(W,{border:!1,passHref:!0,to:g,children:null==i?void 0:i.name}):null==i?void 0:i.name]})},A=function(){j.show({content:(0,o.jsx)(q,{entityId:Number(null==v?void 0:v.entityId),entityName:null==v?void 0:v.entityName}),submit:!1,title:"Log Details",width:"50%"})};return(0,o.jsxs)(U,{children:[(0,o.jsx)(u.Z,{children:(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(l.Z,{md:3,children:(0,o.jsx)(m.Z,{action:t?"Edit":null,actionClick:$,content:(null==i?void 0:i.name)||"test",context:"primary",gmail:null==i?void 0:i.email,src:w})}),(0,o.jsxs)(l.Z,{md:9,children:[(0,o.jsx)(F,{content:(0,o.jsx)(S,{}),noMargin:!0}),(null==i?void 0:i.description)&&(0,o.jsx)(V,{content:null==i?void 0:i.description,noMargin:!0}),(null==i?void 0:i.website)&&(0,o.jsxs)(Q,{href:null==i?void 0:i.website,rel:"nofollow noopener noreferrer",target:"_blank",children:[(0,o.jsx)(Y,{context:"primary",icon:"window-maximize"}),"Visit website"]})]}),x&&(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(E,{job:x,numberPrefix:h,numberSuffix:b})})]})}),(0,o.jsx)(p.Z,{marginTop:"sm"}),s&&(0,o.jsxs)(X,{children:[s.map(function(n){var e=n.icon,t=n.onClick,i=n.to;return(0,o.jsxs)("div",{children:[t&&(0,o.jsx)(J,{onClick:t,children:(0,o.jsx)(f.Z,{icon:e,prefix:Z})}),i&&(0,o.jsx)(y.Z,{border:!1,passHref:!0,to:i,children:(0,o.jsx)(f.Z,{icon:e,prefix:Z})})]},e)}),v&&(0,o.jsx)(J,{onClick:A,children:(0,o.jsx)(f.Z,{icon:"history",size:"lg"})})]})]})},U=s.ZP.div.withConfig({displayName:"profileHeader__StyledHeader",componentId:"sc-35c52c2f-0"})(z()),F=(0,s.ZP)(x.Z).withConfig({displayName:"profileHeader__StyledHeading",componentId:"sc-35c52c2f-1"})(R()),V=(0,s.ZP)(x.Z).withConfig({displayName:"profileHeader__StyledDescription",componentId:"sc-35c52c2f-2"})(M()),Q=s.ZP.a.withConfig({displayName:"profileHeader__StyledLink",componentId:"sc-35c52c2f-3"})(G()),Y=(0,s.ZP)(g.Z).withConfig({displayName:"profileHeader__StyledIcon",componentId:"sc-35c52c2f-4"})(D()),W=(0,s.ZP)(y.Z).withConfig({displayName:"profileHeader__StyledTitle",componentId:"sc-35c52c2f-5"})(B()),X=s.ZP.div.withConfig({displayName:"profileHeader__StyledIconContainer",componentId:"sc-35c52c2f-6"})(H()),J=s.ZP.div.withConfig({displayName:"profileHeader__Click",componentId:"sc-35c52c2f-7"})(L());O.propTypes={avatar:a.string,editable:a.bool,entity:a.object.isRequired,entityName:a.string.isRequired,icons:a.array,job:a.object,linkTitleTo:a.string,log:a.object,prefix:a.string,numberPrefix:a.string,numberSuffix:a.string},O.defaultProps={avatar:"",editable:!0,numberPrefix:"",numberSuffix:""}},91272:function(n,e,t){"use strict";t.d(e,{t:function(){return u}});var i=t(85893),o=t(67294),r=t(45697),a=t(11163),s=t(46003),c=t(8500),u=(0,o.forwardRef)(function(n,e){var t=n.columns,r=n.history,u=n.initialSort,d=n.loading,l=n.meta,m=n.paginationSize,p=n.refetch,f=n.submissionsRefetch,y=n.rowClick,x=n.rows,g=n.xeroPageSize,v=(0,a.useRouter)(),h=v.query,b=void 0===h?{}:h,Z=(0,o.useState)(parseInt(null==b?void 0:b.page,10)||1),j=Z[0],_=Z[1],w=(0,o.useState)(g||s.C1.paginationSize),C=w[0],I=w[1];u||(u={item:"createdAt",order:"desc"});var $=(0,o.useState)({item:u.item,order:u.order}),S=$[0],q=$[1],P=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=v.query,t=void 0===e?{}:e;if(n>1?t.page=n:delete t.page,!(Object.keys(t).length>0))return{};var i=Object.keys(t).map(function(e){return"page"===e?"".concat(e,"=").concat(n):"".concat(e,"=").concat(t[e])}).join("&");return"?".concat(i)},A=function(){q({item:u.item,order:u.order}),_(1);var n=P();v.push(n),I(g||s.C1.paginationSize)};(0,o.useImperativeHandle)(e,function(){return{currentPage:j,pageSize:C,sort:S,resetPagination:function(){A()}}});var T=function(n){var e=P(n);r&&v.push(e),_(n),!r&&p&&p()&&f&&f()},N=function(n){n!==s.C1.paginationSize&&(I(n),p&&p()&&f&&f())},k=function(n){var e;q({item:n.item,order:n.order}),p&&p()&&f&&f()};return(0,i.jsx)(c.Z,{columns:t,loading:d,paginationSize:m,pagination:l&&!0,paginationProps:l&&{currentPage:j,onPageChange:T,onPageSizeChange:N,pageCount:Math.ceil(l.aggregate.totalCount/C),perPage:C},rowClick:y,rows:x,sort:S,setSort:k})});u.propTypes={columns:r.array.isRequired,history:r.bool,initialSort:r.object,loading:r.bool,meta:r.object,refetch:r.func,submissionsRefetch:r.func,rowClick:r.func,rows:r.array.isRequired},u.defaultProps={history:!0,loading:!0,paginationSize:!1}},42575:function(n,e,t){"use strict";t.d(e,{Im:function(){return m},RQ:function(){return y},X4:function(){return g},fC:function(){return x},mW:function(){return p},ze:function(){return f}});var i=t(7297),o=t(75063);function r(){var n=(0,i.Z)(['\n  query GetTaxonomys(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Taxonomy_order_by!\n    $status: String = "active"\n    $type: String\n    $typeGroup: String\n    $parentId: Int\n    $fetchGroup: Boolean! = true\n    $id: Int\n    $isGroup: Boolean = false\n  ) {\n    taxonomy: Taxonomy(\n      limit: $limit\n      offset: $offset\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n      order_by: [$orderBy]\n    ) {\n      options: Taxonomies(\n        where: {\n          type: { _eq: $type }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n\n        childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n          taxonomyId: id\n          name\n          type\n          meta\n          status\n        }\n      }\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n      parent: Parent {\n        id\n        name\n        type\n      }\n      childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n        taxonomyId: id\n        name\n        type\n        meta\n        status\n      }\n      jobs: Taxonomy_Entities_aggregate(\n        where: { Taxonomy: { type: { _eq: "jobTags" } }, entity: { _eq: "Job" } }\n      ) {\n        aggregate {\n          count\n        }\n      }\n    }\n    meta: Taxonomy_aggregate(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n    taxonomyGroup: Taxonomy(where: { isGroup: { _eq: true }, type: { _eq: $typeGroup } })\n      @include(if: $fetchGroup) {\n      value: id\n      text: name\n    }\n  }\n']);return r=function(){return n},n}function a(){var n=(0,i.Z)(["\n  query GetTaxonomy($id: Int!) {\n    taxonomy: Taxonomy_by_pk(id: $id) {\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n    }\n  }\n"]);return a=function(){return n},n}function s(){var n=(0,i.Z)(["\n  mutation AddTaxonomy($objects: [Taxonomy_insert_input!]!) {\n    insert_Taxonomy(objects: $objects) {\n      returning {\n        id\n        type\n      }\n    }\n  }\n"]);return s=function(){return n},n}function c(){var n=(0,i.Z)(["\n  mutation UpdateTaxonomy($id: Int!, $changes: Taxonomy_set_input) {\n    update_Taxonomy_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n      type\n    }\n  }\n"]);return c=function(){return n},n}function u(){var n=(0,i.Z)(["\n  query GeTaxonomyWithEntities($type: String!, $entity: String!, $entityId: Int!) {\n    questions: Taxonomy(where: { type: { _eq: $type } }) {\n      id\n      meta\n      name\n      status\n      taxonomy_entity: Taxonomy_Entities(\n        where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }\n      ) {\n        comments\n      }\n    }\n  }\n"]);return u=function(){return n},n}function d(){var n=(0,i.Z)(["\n  mutation InsertTaxonomyEntity(\n    $entity: String!\n    $entityId: Int!\n    $questions: [Taxonomy_Entity_insert_input!]!\n    $objectStatusLog: [StatusLog_insert_input!]!\n    $hasStatusLog: Boolean!\n  ) {\n    delete_Taxonomy_Entity(where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }) {\n      returning {\n        id\n      }\n    }\n    insert_Taxonomy_Entity(objects: $questions) {\n      returning {\n        id\n      }\n    }\n\n    insert_StatusLog(objects: $objectStatusLog) @include(if: $hasStatusLog) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return d=function(){return n},n}function l(){var n=(0,i.Z)(["\n  query GetSlasForTemplate($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    slas: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      id\n      label: name\n      subtype\n      notes\n      onSite\n      onSiteUnit\n      quoteReturned\n      quoteReturnedUnit\n    }\n  }\n"]);return l=function(){return n},n}var m=(0,o.Ps)(r());(0,o.Ps)(a());var p=(0,o.Ps)(s()),f=(0,o.Ps)(c()),y=(0,o.Ps)(u()),x=(0,o.Ps)(d()),g=(0,o.Ps)(l())},32749:function(n,e,t){"use strict";t.d(e,{l:function(){return f}});var i=t(26042),o=t(69396),r=t(99534),a=t(85893),s=t(67294),c=t(45697),u=t(6388),d=t(42575),l=t(49501),m=t(84043),p=function(n,e){var t,i,o,r=!0;return(null===(t=n.errors[n.name])||void 0===t?void 0:t.message)!==(null===(i=e.errors[e.name])||void 0===i?void 0:i.message)&&(r=!1),["name","type"].forEach(function(t){n[t]!==e[t]&&(r=!1)}),r},f=(0,s.memo)(function(n){var e,t,s,c=n.control,p=n.errors,f=n.label,y=n.name,x=n.register,g=n.type,v=n.filters,h=(0,r.Z)(n,["control","errors","label","name","register","type","filters"]),b=(s=(void 0===(t=(0,u.aM)(d.Im,{variables:(0,o.Z)((0,i.Z)({isGroup:"assetCategory"===g},v),{orderBy:{name:"asc"},type:g})}).data)?{taxonomy:[]}:t).taxonomy,"assetCategory"===g?s.map(function(n){return{label:n.name,options:n.options,childs:n.childs,meta:n.meta}}):s.map(function(n){return{label:n.name,value:n.id,childs:n.childs,meta:n.meta}}));return(0,a.jsx)(l.Z,{id:y,label:f,children:(0,a.jsx)(m.Z,(0,i.Z)((0,o.Z)((0,i.Z)({},{control:c,errors:p,register:x}),{cacheOptions:!0,isClearable:!0,options:b,name:y}),h))})},p);f.propTypes={control:c.object.isRequired,errors:c.object.isRequired,label:c.string.isRequired,filters:c.object,type:(0,c.oneOf)(["assetCategory","expenseCategory","jobTags","costCategory","clientType","tags"])},f.defaultProps={filters:{}}},97768:function(n,e,t){"use strict";t.d(e,{x:function(){return i}});var i=[{text:"Reactive",value:"reactive",context:"#2EE6CA"},{text:"Planned Maintenance",value:"ppm",context:"#D67EFF"},{text:"Quote",value:"quote",context:"#7D7"},{text:"Compliance",value:"cppm",context:"#CC7429"}]},96216:function(n,e,t){"use strict";t.d(e,{Y:function(){return i}});var i=[{text:"Select...",value:""},{text:"Call",value:"call"},{text:"Email",value:"email"},{text:"Portal",value:"portal"},{text:"Other",value:"other"}]},21789:function(n,e,t){"use strict";t.d(e,{bg:function(){return i}});var i=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]},88728:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return C}});var i=t(85893),o=t(19076),r=t(11163),a=t(6388),s=t(79434),c=t(62466),u=t(9270),d=t(62140),l=t(11585),m=t(8500),p=function(n){var e=n.summary,t=n.columns,o=n.rows;return(0,i.jsx)(l.Z,{open:!0,title:e,children:(0,i.jsx)(m.Z,{columns:t,rows:o})})},f=t(67294),y=t(78289),x=t(16551),g=t(77439),v=t(86036),h=t(26186),b=t(52475),Z=function(n){var e=n.refetch,t=n.compliance,o=(0,f.useContext)(y.Z),r=function(){e(),o.close()},a=function(n){o.show({content:(0,i.jsx)(b.z,{defaultValues:t,onSuccess:r}),title:t.id?"Edit":"Add Compliance"}),n.stopPropagation()},s=function(){return(0,i.jsx)(x.Z,{children:(0,i.jsx)(g.Z,{context:"secondary",content:"Edit",onClick:a,size:"sm"})})};return(0,i.jsxs)(l.Z,{toolbar:(0,i.jsx)(s,{}),open:!0,title:"Details",children:[(0,i.jsx)(v.Z,{content:"Name",text:t.name}),(0,i.jsx)(v.Z,{content:"Example Reg Number",text:t.regNumExample?t.regNumExample:"-"}),(0,i.jsx)(v.Z,{content:"Governing Body",text:t.governingBody?t.governingBody:"-"}),(0,i.jsx)(v.Z,{content:"Expect Certificate",text:t.expectCertificate?"Yes":"No"}),(0,i.jsx)(v.Z,{content:"Has Insurance Amount",text:t.hasInsuranceAmount?"Yes":"No"}),(0,i.jsx)(v.Z,{content:"Status",text:t.status?t.status:"-"}),(0,i.jsx)(v.Z,{content:"Type",text:t.type?t.type:"-"}),(0,i.jsx)(v.Z,{content:"Date Added",text:(0,h.Z)(t.createdAt)?(0,h.Z)(t.createdAt):"-"})]})},j=t(71225),_=t(4380),w=function(){var n,e,t=(0,r.useRouter)().query,o=(0,a.aM)(s.$i,{variables:{id:t.id}}),l=o.loading,m=o.data,f=(void 0===m?{compliance:[]}:m).compliance,y=o.refetch,x=f.Compliance_Entities,g=f.id,v=f.name,h=f.url,b=[{hidden:!0},{formatter:(0,c.Z)("/dashboard","id","name",!0),text:"Account"},{text:"Type"}],w=[{hidden:!0},{formatter:(0,c.Z)("/dashboard","id","name",!0),text:"Account"},{text:"Status"}];return l?null:(0,i.jsxs)(u.Z,{children:[(0,i.jsxs)(d.Z,{md:3,children:[(0,i.jsx)(_.g,{avatar:(0,j.Q)(f.media),entity:{id:g,name:v,website:h},entityName:"Compliance",prefix:"/dashboard/compliance/"}),(0,i.jsx)(Z,{refetch:y,compliance:f})]}),(0,i.jsx)(d.Z,{md:3,children:(0,i.jsx)(p,{summary:"Accounts",columns:b,rows:(n=[],Object.keys(x).map(function(e,t){var i,o,r;return n.push({id:null===(i=x[e].Account)||void 0===i?void 0:i.id,name:null===(o=x[e].Account)||void 0===o?void 0:o.name,type:null===(r=x[e].Account)||void 0===r?void 0:r.type})}),n)})}),(0,i.jsx)(d.Z,{md:3,children:(0,i.jsx)(p,{summary:"Properties",columns:w,rows:(e=[],Object.keys(x).map(function(n,t){var i,o,r;return e.push({id:null===(i=x[n].Location)||void 0===i?void 0:i.id,name:null===(o=x[n].Location)||void 0===o?void 0:o.name,status:null===(r=x[n].Location)||void 0===r?void 0:r.status})}),e)})})]})},C=function(){return(0,i.jsx)(o.Z,{View:(0,i.jsx)(w,{})})}}},function(n){n.O(0,[3662,367,2283,212,8890,619,2583,4135,8579,6043,1838,4244,3911,1417,3776,1564,3054,8500,4046,2797,1047,4043,3058,3284,8344,6733,9774,2888,179],function(){return n(n.s=78216)}),_N_E=n.O()}]);